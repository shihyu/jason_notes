<!DOCTYPE HTML>
<html lang="zh" class="sidebar-visible no-js rust">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Qemu Gdb Lab - Jason Notes</title>


        <!-- Custom HTML head -->

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/custom/custom.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html">Jason Notes</a></li><li class="chapter-item expanded "><a href="ubuntu/ubuntu_setup.html">Ubuntu</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="ubuntu/command.html">Command</a></li><li class="chapter-item "><a href="ubuntu/gcp.html">GCP ssh</a></li><li class="chapter-item "><a href="ubuntu/wine.html">Wine</a></li></ol></li><li class="chapter-item expanded "><a href="android/android.html">Android</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="android/install_sdk.html">SDK install</a></li><li class="chapter-item "><a href="android/flutter.html">Flutter</a></li></ol></li><li class="chapter-item expanded "><a href="tools/tools.html">Tools</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="tools/asciinema.html">asciinema æŠŠçµ‚ç«¯æ“ä½œéŒ„è£½æˆ gif å‹•ç•«</a></li><li class="chapter-item "><a href="tools/finmind.html">Finmind</a></li><li class="chapter-item "><a href="tools/add-enter-and-exit-trace-for-your-function.html">addr2line</a></li><li class="chapter-item "><a href="tools/cmake.html">cmake</a></li><li class="chapter-item "><a href="tools/network.html">Network</a></li><li class="chapter-item "><a href="tools/python-pycryptodome-aes-symmetric-encryption-tutorial-examples.html">å¯¦ä½œ AES å°ç¨±å¼åŠ å¯†</a></li></ol></li><li class="chapter-item expanded "><a href="html/html.html">HTML</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="html/vue.html">Vue</a></li></ol></li><li class="chapter-item expanded "><a href="vim/vim.html">Vim</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="vim/copilot.html">copilot</a></li><li class="chapter-item "><a href="vim/tabnine.html">tabnine</a></li></ol></li><li class="chapter-item expanded "><a href="gdb/gdb.html">Gdb</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="gdb/å¸¸ç”¨æŒ‡ä»¤.html">å¸¸ç”¨æŒ‡ä»¤</a></li><li class="chapter-item "><a href="gdb/jemalloc.html">jemalloc</a></li><li class="chapter-item "><a href="gdb/graphs.html">graphs</a></li><li class="chapter-item "><a href="gdb/rust-gdb.html">rust gdb</a></li><li class="chapter-item "><a href="gdb/qemu-gdb-risc-v64.html">qemu-gdb-risc-v64-kernel</a></li><li class="chapter-item "><a href="gdb/go-rust-gdb-debug.html">ä½¿ç”¨gdb è¿½è¹¤go/rustç¨‹å¼ç¢¼</a></li><li class="chapter-item "><a href="gdb/gdb-function-trace-to-flowchart-guide.html">GDBå‡½æ•¸èª¿ç”¨è»Œè·¡åˆ†æèˆ‡æµç¨‹åœ–ç”Ÿæˆå®Œæ•´æŒ‡å—</a></li></ol></li><li class="chapter-item expanded "><a href="c++/cpp.html">C++</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="c++/benchmark.html">benchmark</a></li><li class="chapter-item "><a href="c++/ä¹˜ä»¥0.01å’Œé™¤ä»¥100å“ªå€‹å¿«.html">ä¹˜ä»¥ 0.01 å’Œé™¤ä»¥ 100 å“ªå€‹å¿«</a></li><li class="chapter-item "><a href="c++/smart_pointer.html">Smart pointer</a></li><li class="chapter-item "><a href="c++/l&rvalue.html">L&amp;R value</a></li><li class="chapter-item "><a href="c++/move.html">Move</a></li><li class="chapter-item "><a href="c++/CAS.html">CAS</a></li><li class="chapter-item "><a href="c++/HFT.html">HFT</a></li><li class="chapter-item "><a href="c++/cpp_note.html">Note</a></li><li class="chapter-item "><a href="c++/é«˜æ€§èƒ½ç¨‹å¼è¨­è¨ˆå¯¦æˆ°.html">é«˜æ€§èƒ½ç¨‹å¼è¨­è¨ˆå¯¦æˆ°</a></li><li class="chapter-item "><a href="c++/å¦‚ä½•é«˜æ•ˆåœ°å„²å­˜ä¸¦æ“ä½œè¶…å¤§è¦æ¨¡.html">å¦‚ä½•é«˜æ•ˆåœ°å„²å­˜ä¸¦æ“ä½œè¶…å¤§è¦æ¨¡</a></li><li class="chapter-item "><a href="c++/UC_CAPITAL.html">UC_CAPITAL</a></li><li class="chapter-item "><a href="c++/cpp-smart-pointers-guide.html">unique_ptr vs shared_ptr</a></li><li class="chapter-item "><a href="c++/cpp-move-semantics-guide.html">C++ Move èªæ„å®Œæ•´æŒ‡å—</a></li><li class="chapter-item "><a href="c++/interview.html">interview</a></li></ol></li><li class="chapter-item expanded "><a href="mojo/mojo.html">Mojo</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="mojo/mojo_crawler_guide.html">Mojo çˆ¬èŸ²å®Œæ•´æŒ‡å—</a></li></ol></li><li class="chapter-item expanded "><a href="riscv/riscv.html">RISC-V</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="riscv/qemu_riscv_linux.html">QEMUä¸Šé‹è¡ŒRISV-V Linux</a></li><li class="chapter-item "><a href="riscv/qemi_gdb.html">QEMU GDB</a></li><li class="chapter-item "><a href="riscv/qemu_gdb_lab.html">Qemu Gdb Lab</a></li></ol></li><li class="chapter-item expanded "><a href="centos/centos.html">CentOS</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="centos/tqdb_setup.html">TQDB å®‰è£ç´€éŒ„</a></li></ol></li><li class="chapter-item expanded "><a href="ssh/ssh.html">SSH</a></li><li class="chapter-item expanded "><a href="network/socket.html">Network</a></li><li class="chapter-item expanded "><a href="docker/docker_helloworld.html">Docker</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="docker/docker.html">Docker åŸºæœ¬æ•™å­¸</a></li><li class="chapter-item "><a href="docker/example.html">ç°¡å–®ç¯„ä¾‹</a></li><li class="chapter-item "><a href="docker/creating-the-perfect-python-dockerfile.html">Perfect python dockerfile</a></li><li class="chapter-item "><a href="docker/dockerfile-from-docker-image.html">ç”± Docker image åæ¨å…¶ Dockerfile</a></li><li class="chapter-item "><a href="docker/python_connect_redis.html">Pythoné€£æ¥Redis</a></li><li class="chapter-item "><a href="docker/command.html">Command</a></li><li class="chapter-item "><a href="docker/docker_compose.html">Docker compose</a></li><li class="chapter-item "><a href="docker/docker_compse_example.html">Docker compose example</a></li><li class="chapter-item "><a href="docker/python_redis.html">Python-Redis</a></li><li class="chapter-item "><a href="docker/redash.html">Redash</a></li><li class="chapter-item "><a href="docker/clickhouse.html">ClickHouse</a></li><li class="chapter-item "><a href="docker/clickhouse-setup.html">clickhouse-setup</a></li><li class="chapter-item "><a href="docker/python_run_from_local.html">Docker run local</a></li><li class="chapter-item "><a href="docker/redpanda.html">Redpanda</a></li><li class="chapter-item "><a href="docker/gcc.html">é‹è¡Œæœ€æ–°ç‰ˆGCC</a></li></ol></li><li class="chapter-item expanded "><a href="rust/rust.html">Rust</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="rust/note.html">Rustç­†è¨˜</a></li><li class="chapter-item "><a href="rust/basic.html">Rust åŸºæœ¬æ•™å­¸</a></li><li class="chapter-item "><a href="rust/ownership.html">Rust æ‰€æœ‰æ¬Šç³»çµ±</a></li><li class="chapter-item "><a href="rust/lifetime.html">Rust ç”Ÿå‘½é€±æœŸ (Lifetime)</a></li><li class="chapter-item "><a href="rust/type.html">Rust å‹åˆ¥ç³»çµ±</a></li><li class="chapter-item "><a href="rust/rust_setup.html">Rust Tools</a></li><li class="chapter-item "><a href="rust/polars.html">Polars</a></li><li class="chapter-item "><a href="rust/rust_call_c.html">Rust call C</a></li><li class="chapter-item "><a href="rust/pyo3.html">PyO3</a></li><li class="chapter-item "><a href="rust/10-rust-an-introduction.html">çµ¦ C++ ä½¿ç”¨è€…çš„ Rust ç°¡ä»‹</a></li><li class="chapter-item "><a href="rust/å¯è¦–åŒ–Rustå„è³‡æ–™çµæ§‹çš„è¨˜æ†¶é«”ä½ˆå±€.html">å¯è¦–åŒ–Rustå„è³‡æ–™çµæ§‹çš„è¨˜æ†¶é«”ä½ˆå±€</a></li><li class="chapter-item "><a href="rust/rust_note.html">å­¸ç¿’é †åº</a></li><li class="chapter-item "><a href="rust/overview.html">å¤§å±€è§€</a></li><li class="chapter-item "><a href="rust/String.html">ç†è§£å­—ä¸²</a></li><li class="chapter-item "><a href="rust/easy_rust.html">Easy Rust</a></li><li class="chapter-item "><a href="rust/rust_easy.html">Rust æ–°æ‰‹</a></li><li class="chapter-item "><a href="rust/module.html">Rust æ¨¡çµ„çµæ§‹</a></li><li class="chapter-item "><a href="rust/rust_memory.html">Rustèˆ‡è¨˜æ†¶é«”</a></li><li class="chapter-item "><a href="rust/rust_vs_cpp.html">Rust vs C++èªæ³•</a></li><li class="chapter-item "><a href="rust/rust_file_format.html">Rust æª”æ¡ˆæ ¼å¼</a></li><li class="chapter-item "><a href="rust/rust-an-introduction-in-oop.html">Rust OO</a></li><li class="chapter-item "><a href="rust/rust-an-introduction-smart-pointer.html">Rust Pointer</a></li><li class="chapter-item "><a href="rust/pointer.html">Pointer</a></li><li class="chapter-item "><a href="rust/copy_trait.html">Copy Trait</a></li><li class="chapter-item "><a href="rust/binary_lib.html">Rust å‡½æ•¸åº«/åŸ·è¡Œæª”</a></li><li class="chapter-item "><a href="rust/reqwest.html">Reqwest</a></li><li class="chapter-item "><a href="rust/print-function-name-dump-stack.html">å°å‡ºå‡½æ•¸åç¨±</a></li><li class="chapter-item "><a href="rust/criterion.html">criterion</a></li><li class="chapter-item "><a href="rust/Rustçš„ç²¾é«“.html">Rustçš„ç²¾é«“</a></li><li class="chapter-item "><a href="rust/30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—.html">30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="rust/30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—/rust_30_day.html">Rust 30 Day</a></li><li class="chapter-item "><a href="rust/30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—/Move_Borrow_Ownership.html">è®Šæ•¸çš„æ‰€æœ‰æ¬Šèˆ‡å€Ÿå‡ºè®Šæ•¸</a></li><li class="chapter-item "><a href="rust/30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—/Lifetime.html">Lifetimeï¼š Borrow çš„å­˜æ´»æ™‚é–“</a></li></ol></li><li class="chapter-item "><a href="rust/cpp_vs_rust_comparison.html">C++ vs. Rust: å…¨é¢ç‰¹æ€§æ¯”è¼ƒ</a></li><li class="chapter-item "><a href="rust/cpp-move-vs-rust-ownership.html">C++ Move èªç¾© vs Rust æ‰€æœ‰æ¬Šç³»çµ±çš„æ ¸å¿ƒå·®ç•°</a></li><li class="chapter-item "><a href="rust/Rust-RESTful-API-å®Œæ•´é–‹ç™¼æŒ‡å—.html">Rust-RESTful-API-å®Œæ•´é–‹ç™¼æŒ‡å—</a></li><li class="chapter-item "><a href="rust/Rust-self-Self-èˆ‡-C++-this-å°æ¯”æŒ‡å—.html">Rust-self-Self-èˆ‡-C++-this-å°æ¯”æŒ‡å—</a></li><li class="chapter-item "><a href="rust/rust-derive-traits-comparison.html">Rust Derive Traits æ¯”è¼ƒï¼šè‡ªå‹•ç”Ÿæˆ vs æ‰‹å‹•å¯¦ä½œ</a></li><li class="chapter-item "><a href="rust/rust_traits_explained.html">Rust Traits ç™½è©±è§£é‡‹ï¼šèˆ‡ C++ çš„æ¯”è¼ƒ</a></li><li class="chapter-item "><a href="rust/rust_trait_impl_markdown.html">Rust ä¸­ trait å’Œ impl çš„å·®ç•°</a></li><li class="chapter-item "><a href="rust/rust_cpp_comparison_md.html">Rust vs C++ è©³ç´°å°æ¯”æŒ‡å—</a></li><li class="chapter-item "><a href="rust/rust_module_system_markdown.html">Rust æ¨¡çµ„ç³»çµ±å®Œæ•´æŒ‡å—</a></li><li class="chapter-item "><a href="rust/ownership_vs_borrowing_guide.html">Rust æ“æœ‰æ¬Š vs å€Ÿç”¨ï¼šç”Ÿå‘½é€±æœŸå•é¡ŒæŒ‡å—ğŸ¦€</a></li><li class="chapter-item "><a href="rust/rust_ownership_guide.html">Rust æ‰€æœ‰æ¬Šç³»çµ± - ç”Ÿæ´»åŒ–è©³è§£</a></li><li class="chapter-item "><a href="rust/rust_ownership_complete_guide.html">Rust æ‰€æœ‰æ¬Šå®Œæ•´æŒ‡å— - å¾åŸºç¤åˆ°ç²¾é€š</a></li><li class="chapter-item "><a href="rust/rust_memory_guide.html">Rust è¨˜æ†¶é«”é…ç½®æŒ‡å—ï¼šStack vs Heap</a></li><li class="chapter-item "><a href="rust/rust_wrappers_guide.html">Rust åŒ…è£é¡å‹ç™½è©±æŒ‡å—ğŸ“¦</a></li></ol></li><li class="chapter-item expanded "><a href="go/go.html">Go</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="go/note.html">Golang  Note</a></li><li class="chapter-item "><a href="go/pytago.html">pytago</a></li><li class="chapter-item "><a href="go/Goç·¨ç¨‹å¯¦æˆ°æ´¾åŸºç¤å…¥é–€.html">Goç·¨ç¨‹å¯¦æˆ°æ´¾åŸºç¤å…¥é–€</a></li><li class="chapter-item "><a href="go/Goç·¨ç¨‹å¯¦æˆ°æ´¾Webé–‹ç™¼åŸºç¤.html">Goç·¨ç¨‹å¯¦æˆ°æ´¾Webé–‹ç™¼åŸºç¤</a></li><li class="chapter-item "><a href="go/golang_debugger.html">Golang Deubgger</a></li><li class="chapter-item "><a href="go/golang-go-module-tutorial.html">å¾ä¸€çŸ¥åŠè§£åˆ°ç•¥æ‡‚ Go modules</a></li><li class="chapter-item "><a href="go/go_mod.html">Go modules</a></li><li class="chapter-item "><a href="go/trace.html">Golangå¤§æ®ºå™¨ä¹‹è·Ÿè¹¤å‰–ætrace</a></li><li class="chapter-item "><a href="go/Coroutine.html">è¡Œç¨‹ã€åŸ·è¡Œç·’ã€å”ç¨‹ï¼Œå‚»å‚»åˆ†å¾—æ¸…æ¥šï¼</a></li><li class="chapter-item "><a href="go/goroutine-and-channel.html">Goä½µç™¼</a></li><li class="chapter-item "><a href="go/websocket.html">Websocket</a></li><li class="chapter-item "><a href="go/returning-pointer-from-a-function-in-go.html">Returning Pointer from a Function in Go</a></li><li class="chapter-item "><a href="go/golang-memory-management.html">GC å…¨é¢è§£æ</a></li><li class="chapter-item "><a href="go/golang-goroutine.html">Goroutine èˆ‡ GMP åŸç†å…¨é¢åˆ†æ</a></li><li class="chapter-item "><a href="go/oo.html">OO</a></li><li class="chapter-item "><a href="go/mutex-rwmutex.html">sync.Mutex å’Œ sync.RWMutex</a></li><li class="chapter-item "><a href="go/interface.html">interface</a></li><li class="chapter-item "><a href="go/example.html">Example</a></li><li class="chapter-item "><a href="go/LiveKit.html">LiveKit</a></li></ol></li><li class="chapter-item expanded "><a href="ml/ml.html">ML</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="ml/pytorch.html">Pytorch</a></li><li class="chapter-item "><a href="ml/pytorch_setup.html">Pytorch å®‰è£</a></li><li class="chapter-item "><a href="ml/deap.html">Deap</a></li><li class="chapter-item "><a href="ml/cudf.html">CUDF</a></li><li class="chapter-item "><a href="ml/åˆæ¢åŸºå› æ¼”ç®—æ³•.html">åˆæ¢åŸºå› æ¼”ç®—æ³•-ç”¨ OneMax å•é¡Œç¤ºç¯„</a></li><li class="chapter-item "><a href="ml/ç°¡å–®è§£é‡‹æ¢¯åº¦ä¸‹é™æ³•.html">ç°¡å–®è§£é‡‹æ¢¯åº¦ä¸‹é™æ³•</a></li><li class="chapter-item "><a href="ml/æ¢¯åº¦ä¸‹é™æ³•_gradient_descent.html">æ¢¯åº¦ä¸‹é™æ³• gradient descent</a></li><li class="chapter-item "><a href="ml/æ¢¯åº¦æœ€ä½³è§£ç›¸é—œç®—æ³•.html">æ¢¯åº¦æœ€ä½³è§£ç›¸é—œç®—æ³•</a></li><li class="chapter-item "><a href="ml/åŸºæ–¼DEAPåº«çš„Pythoné€²åŒ–æ¼”ç®—æ³•å¾å…¥é–€åˆ°å…¥åœŸ.html">åŸºæ–¼DEAPåº«çš„Pythoné€²åŒ–æ¼”ç®—æ³•å¾å…¥é–€åˆ°å…¥åœŸ</a></li><li class="chapter-item "><a href="ml/GA.html">GA</a></li><li class="chapter-item "><a href="ml/XGBoost.html">XGBoost</a></li><li class="chapter-item "><a href="ml/YOLO.html">YOLO</a></li><li class="chapter-item "><a href="ml/yolov8æ‰‹å‹¢è­˜åˆ¥.html">YOLOv8æ‰‹å‹¢è­˜åˆ¥</a></li><li class="chapter-item "><a href="ml/Roboflow.html">Roboflow</a></li></ol></li><li class="chapter-item expanded "><a href="python/python.html">Python</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="python/Poetryå®Œå…¨å…¥é–€æŒ‡å—.html">Poetryå®Œå…¨å…¥é–€æŒ‡å—</a></li><li class="chapter-item "><a href="python/æ­å»ºgRPCæœå‹™.html">æ­å»ºgRPCæœå‹™</a></li><li class="chapter-item "><a href="python/python_debugger.html">Python Debugger</a></li><li class="chapter-item "><a href="python/decorator.html">Python decorator</a></li><li class="chapter-item "><a href="python/python-decorator.html">è£é£¾å™¨çœ‹é€™ä¸€ç¯‡å°±å¤ äº†</a></li><li class="chapter-item "><a href="python/import-concept.html">import-concept</a></li><li class="chapter-item "><a href="python/process_thread.html">Process/Threadå„ªç¼ºé»</a></li><li class="chapter-item "><a href="python/processing_communcation.html">Processing é€šè¨Š</a></li><li class="chapter-item "><a href="python/condition.html">Pythonä¸­çš„waitå’Œnotify</a></li><li class="chapter-item "><a href="python/ç”Ÿç”¢è€…æ¶ˆè²»è€…æ¨¡å¼.html">ç”Ÿç”¢è€…æ¶ˆè²»è€…æ¨¡å¼</a></li><li class="chapter-item "><a href="python/Loguru.html">Loguru</a></li><li class="chapter-item "><a href="python/cython.html">Cython</a></li><li class="chapter-item "><a href="python/WebSocket_reconnect.html">Python WebSocketé•·é€£æ¥å¿ƒè·³èˆ‡çŸ­é€£æ¥</a></li><li class="chapter-item "><a href="python/bloomrpc.html">bloomrpc</a></li><li class="chapter-item "><a href="python/concurrent.futures.html">Concurrent futures</a></li><li class="chapter-item "><a href="python/schedule.html">ä»»å‹™èª¿åº¦</a></li><li class="chapter-item "><a href="python/plot/plot.html">Plot</a></li><li class="chapter-item "><a href="python/plot/dash.html">Dash</a></li><li class="chapter-item "><a href="python/Rust_bindings_for_Python.html">Rust bindings for Python</a></li><li class="chapter-item "><a href="python/pandas.html">Pandas</a></li><li class="chapter-item "><a href="python/coroutine.html">Coroutine</a></li><li class="chapter-item "><a href="python/finmind.html">FinMind</a></li><li class="chapter-item "><a href="python/telegram_bot.html">Telegram Bot</a></li><li class="chapter-item "><a href="python/python-different-ways-to-kill-a-thread.html">Different ways kill thread</a></li><li class="chapter-item "><a href="python/websocket_client_server.html">Websocket client/server</a></li><li class="chapter-item "><a href="python/poetry.html">å¾é›¶é–‹å§‹ä½¿ç”¨ Poetry</a></li><li class="chapter-item "><a href="python/fil-memory-usage-profiler.html">Fil-memory-usage-profiler</a></li><li class="chapter-item "><a href="python/plot.html">ç¹ªåœ–</a></li><li class="chapter-item "><a href="python/shioaji.html">æ°¸è±shioaji</a></li><li class="chapter-item "><a href="python/other.html">Other</a></li></ol></li><li class="chapter-item expanded "><a href="mermaid/mermaid.html">Mermaid</a></li><li class="chapter-item expanded "><a href="linux_system/linux_system.html">Linux System</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="linux_system/1_day_socket.html">Socket</a></li><li class="chapter-item "><a href="linux_system/cgroup.html">Cgroup</a></li><li class="chapter-item "><a href="linux_system/perf.html">Perf</a></li><li class="chapter-item "><a href="linux_system/è‡ªè£½Lib.html">build Lib</a></li><li class="chapter-item "><a href="linux_system/performance.html">performance</a></li></ol></li><li class="chapter-item expanded "><a href="strategy/bollmaker.html">Strategy</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="strategy/é€ å¸‚/market_market.html">é€ å¸‚</a></li><li class="chapter-item "><a href="strategy/tw_futures.html">è‡ºæŒ‡</a></li><li class="chapter-item "><a href="strategy/arbitrage.html">å¥—åˆ©</a></li><li class="chapter-item "><a href="strategy/é…å°äº¤æ˜“.html">é…å°äº¤æ˜“</a></li><li class="chapter-item "><a href="strategy/æµ·é¾œäº¤æ˜“.html">æµ·é¾œäº¤æ˜“</a></li><li class="chapter-item "><a href="strategy/è‚¡æµ·ç­‹è‚‰äºº.html">è‚¡æµ·ç­‹è‚‰äºº</a></li><li class="chapter-item "><a href="strategy/å¦‚ä½•é¿å…éæ“¬åˆ.html">å¦‚ä½•é¿å…éæ“¬åˆ</a></li><li class="chapter-item "><a href="strategy/å¤šç©ºæ“ä½œè¡“.html">å¤šç©ºæ“ä½œè¡“</a></li><li class="chapter-item "><a href="strategy/è³‡é‡‘æ§ç®¡æ‰æ˜¯ç‹é“.html">è³‡é‡‘æ§ç®¡æ‰æ˜¯ç‹é“</a></li><li class="chapter-item "><a href="strategy/00713_00675Læ­£äºŒèœˆèš£ç­–ç•¥.html">æ­£äºŒèœˆèš£ç­–ç•¥</a></li><li class="chapter-item "><a href="strategy/è³ªæŠ¼00713+æ­£äºŒ.html">è³ªæŠ¼00713+æ­£äºŒ</a></li><li class="chapter-item "><a href="strategy/phcebus/phcebus.html">phcebus</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="strategy/phcebus/è²å¼æ€è€ƒ.html">è²å¼æ€è€ƒ</a></li><li class="chapter-item "><a href="strategy/phcebus/è²·è‚¡3å¿ƒæ³•.html">è²·è‚¡3å¿ƒæ³•</a></li></ol></li><li class="chapter-item "><a href="strategy/Option/option.html">é¸æ“‡æ¬Š</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="strategy/Option/option_note.html">Option note</a></li></ol></li><li class="chapter-item "><a href="strategy/vectorbt.html">VectorBT</a></li><li class="chapter-item "><a href="strategy/orderbook.html">Orderbook</a></li><li class="chapter-item "><a href="strategy/é¸è‚¡æ¢ä»¶.html">é¸è‚¡æ¢ä»¶</a></li><li class="chapter-item "><a href="strategy/å¦‚ä½•é€²å ´.html">å¦‚ä½•é€²å ´</a></li><li class="chapter-item "><a href="strategy/å¦‚ä½•å‡ºå ´.html">å¦‚ä½•å‡ºå ´</a></li><li class="chapter-item "><a href="strategy/å»ºå€‰åŠ ç¢¼.html">å»ºå€‰åŠ ç¢¼</a></li><li class="chapter-item "><a href="strategy/DT.html">ç•¶æ²–</a></li><li class="chapter-item "><a href="strategy/ç•¶æ²–åšç©º.html">ç•¶æ²–åšç©º</a></li><li class="chapter-item "><a href="strategy/æŠ„åº•.html">æŠ„åº•</a></li><li class="chapter-item "><a href="strategy/éº»é“æ˜/éº»é“æ˜.html">éº»é“æ˜</a></li><li class="chapter-item "><a href="strategy/è³ºè´å¤§ç›¤çš„å‹•èƒ½æŠ•è³‡æ³•.html">è³ºè´å¤§ç›¤çš„å‹•èƒ½æŠ•è³‡æ³•</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="strategy/éº»é“æ˜/å‡çªç ´.html">å‡çªç ´</a></li></ol></li><li class="chapter-item "><a href="strategy/å¥‡æ­£/å¥‡æ­£.html">å¥‡æ­£</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="strategy/å¥‡æ­£/è³‡é‡‘æ§ç®¡èˆ‡è©¦å–®ç­–ç•¥.html">è³‡é‡‘æ§ç®¡èˆ‡è©¦å–®ç­–ç•¥</a></li><li class="chapter-item "><a href="strategy/å¥‡æ­£/å¦‚ä½•å‡ºå ´.html">å¦‚ä½•å‡ºå ´</a></li></ol></li><li class="chapter-item "><a href="strategy/ptt_stock/a0808996.html">PTT Stock</a></li><li class="chapter-item "><a href="strategy/Book/JG.html">JG</a></li><li class="chapter-item "><a href="strategy/bnf.html">BNF</a></li><li class="chapter-item "><a href="strategy/cis.html">CIS</a></li><li class="chapter-item "><a href="strategy/GA.html">GA</a></li><li class="chapter-item "><a href="strategy/stock.html">Stock</a></li><li class="chapter-item "><a href="strategy/note.html">Resource</a></li><li class="chapter-item "><a href="strategy/nansen.html">Nansen</a></li><li class="chapter-item "><a href="strategy/example.html">Example</a></li><li class="chapter-item "><a href="strategy/other.html">Other</a></li><li class="chapter-item "><a href="strategy/sample.html">Sample</a></li><li class="chapter-item "><a href="strategy/shioaji.html">shioaji æ¨¡æ“¬</a></li><li class="chapter-item "><a href="strategy/grid.html">Grid</a></li><li class="chapter-item "><a href="strategy/pine-script.html">pine-script</a></li><li class="chapter-item "><a href="strategy/æ‹¾äººç‰™æ…§.html">æ‹¾äººç‰™æ…§</a></li><li class="chapter-item "><a href="strategy/sharpe_ratio.html">å¤æ™®å€¼</a></li><li class="chapter-item "><a href="strategy/display_mae_mfe_analysis.html">MAE&amp;MFEåˆ†æ</a></li><li class="chapter-item "><a href="strategy/æµ·é¾œæŠ•è³‡æ³•å‰‡.html">æµ·é¾œæŠ•è³‡æ³•å‰‡</a></li><li class="chapter-item "><a href="strategy/edge-ratio-follow-application.html">å½ˆæ€§é€²å‡ºå ´çš„åˆ¤æ–·</a></li><li class="chapter-item "><a href="strategy/ä¸‰å¿ƒæ³•é †å‹¢æ“ä½œé™³æ—å…ƒ10å¹´è³‡ç”¢ç¿»10å€.html">ä¸‰å¿ƒæ³•é †å‹¢æ“ä½œé™³æ—å…ƒ10å¹´è³‡ç”¢ç¿»10å€</a></li><li class="chapter-item "><a href="strategy/Jump.html">JUMP</a></li><li class="chapter-item "><a href="strategy/å¼µæ¾å…æŠ•è³‡å¿ƒæ³•.html">å¼µå…æŠ•è³‡å¿ƒæ³•</a></li><li class="chapter-item "><a href="strategy/vectorbt_é…å°.html">vectorbt é…å°</a></li><li class="chapter-item "><a href="strategy/äº¤æ˜“çš„è¡Œç‚ºèˆ‡æ€ç¶­åˆ†äº«.html">äº¤æ˜“çš„è¡Œç‚ºèˆ‡æ€ç¶­åˆ†äº«</a></li><li class="chapter-item "><a href="strategy/æŠ•è³‡æŠ•æ©Ÿçš„è§€å¿µèˆ‡å¿ƒå¾—åˆ†äº«.html">æŠ•è³‡æŠ•æ©Ÿçš„è§€å¿µèˆ‡å¿ƒå¾—åˆ†äº«</a></li><li class="chapter-item "><a href="strategy/finlab.html">Finlab</a></li><li class="chapter-item "><a href="strategy/backtrader/basis.html">Backtrader</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶ä¸€Backtraderä»‹ç´¹.html">Pythonå›æ¸¬æ¡†æ¶ä¸€Backtraderä»‹ç´¹</a></li><li class="chapter-item "><a href="strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶äºŒå®šæœŸå®šé¡æŠ•è³‡.html">Python å›æ¸¬æ¡†æ¶ï¼ˆäºŒï¼‰å®šæœŸå®šé¡æŠ•è³‡</a></li><li class="chapter-item "><a href="strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶ä¸‰æŠ€è¡“æŒ‡æ¨™.html">Python å›æ¸¬æ¡†æ¶ï¼ˆä¸‰ï¼‰æŠ€è¡“æŒ‡æ¨™</a></li><li class="chapter-item "><a href="strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶å››CrossOverå’ŒSignal.html">Python å›æ¸¬æ¡†æ¶ï¼ˆå››ï¼‰CrossOver å’Œ Signal</a></li><li class="chapter-item "><a href="strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶äº”Sizer.html">Python å›æ¸¬æ¡†æ¶ï¼ˆäº”ï¼‰Sizer</a></li><li class="chapter-item "><a href="strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶å…­Analyzers.html">Python å›æ¸¬æ¡†æ¶ï¼ˆå…­ï¼‰Analyzers</a></li><li class="chapter-item "><a href="strategy/backtrader/å¤šè‚¡çµ„åˆæ“ä½œç­–ç•¥.html">å¤šè‚¡çµ„åˆæ“ä½œ</a></li><li class="chapter-item "><a href="strategy/backtrader/å‡ç·šäº¤å‰ç­–ç•¥.html">å‡ç·šäº¤å‰ç­–ç•¥</a></li><li class="chapter-item "><a href="strategy/backtrader/å”å¥‡å®‰é€šé“ç­–ç•¥.html">å”å¥‡å®‰é€šé“ç­–ç•¥</a></li><li class="chapter-item "><a href="strategy/backtrader/Sizersæ¨¡çµ„.html">Sizersæ¨¡çµ„</a></li><li class="chapter-item "><a href="strategy/backtrader/Observersæ¨¡çµ„.html">Observersæ¨¡çµ„</a></li><li class="chapter-item "><a href="strategy/backtrader/Pyfolio.html">Pyfolio</a></li><li class="chapter-item "><a href="strategy/backtrader/Sample.html">Sample</a></li><li class="chapter-item "><a href="strategy/backtrader/performance.html">Performance</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="mq/kafka.html">MQ</a></li><li class="chapter-item expanded "><a href="mq/kafka-python.html">Kafkaçš„é€šä¿—ç¸½çµ</a></li><li class="chapter-item expanded "><a href="database/database.html">Database</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="database/redis.html">Redis</a></li><li class="chapter-item "><a href="database/hash.html">Redis Hash</a></li><li class="chapter-item "><a href="database/clickhouse.html">ClickHouse</a></li><li class="chapter-item "><a href="database/dolphin.html">Dolphin</a></li><li class="chapter-item "><a href="database/sqlite.html">Sqlite</a></li></ol></li><li class="chapter-item expanded "><a href="cryptotrade/cryptotrade.html">CryptoTrade</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="cryptotrade/binance/binance.html">Binance</a></li><li class="chapter-item "><a href="cryptotrade/binance/oco.html">å¦‚ä½•å°‡OCOè¨‚å–®ç™¼é€åˆ°Binance</a></li></ol></li><li class="chapter-item expanded "><a href="git/git.html">Git</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="git/git-remove-commited-files.html">git-remove-commited-files</a></li><li class="chapter-item "><a href="git/cheat-sheet.html">Git å¸¸ç”¨</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_notes" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ä½¿ç”¨gdbqemuåµéŒ¯64ä½risc-v-linux-æ ¸å¿ƒ"><a class="header" href="#ä½¿ç”¨gdbqemuåµéŒ¯64ä½risc-v-linux-æ ¸å¿ƒ">ä½¿ç”¨GDB+QEMUåµéŒ¯64ä½RISC-V LINUX æ ¸å¿ƒ</a></h1>
<p>https://www.nuanyun.cloud/?p=1481</p>
<h2 id="1-å¯¦é©—ç›®æ¨™"><a class="header" href="#1-å¯¦é©—ç›®æ¨™">1 å¯¦é©—ç›®æ¨™</a></h2>
<p>ä½¿ç”¨GDBåœ¨QEMUæ¨¡æ“¬å™¨ä¸­åµéŒ¯é‹è¡ŒåŸºæ–¼64ä½RISCVæ¶æ§‹çš„Linuxæ ¸å¿ƒã€‚</p>
<h2 id="2-å¯¦é©—ç°¡ä»‹"><a class="header" href="#2-å¯¦é©—ç°¡ä»‹">2 å¯¦é©—ç°¡ä»‹</a></h2>
<p>æœ¬æ¬¡å¯¦é©—å°‡å¹«åŠ©æˆ‘å€‘æ›´å¥½åœ°ç­è§£å¦‚ä½•ä½¿ç”¨äº¤å‰ç·¨è­¯å·¥å…·éˆç·¨è­¯Linuxæ ¸å¿ƒåŸå§‹ç¢¼ï¼Œä¸¦å°‡ç·¨è­¯æ‰€å¾—åˆ°çš„åŸºæ–¼RISCVæŒ‡ä»¤é›†æ¶æ§‹çš„Linuxæ ¸å¿ƒé‹è¡Œåœ¨QEMUæ¨¡æ“¬å™¨ä¸Šã€‚æœ¬æ¬¡å¯¦é©—é‚„å°‡å¹«åŠ©æˆ‘å€‘æ›´å¥½åœ°ç­è§£æŒæ¡å¦‚ä½•åˆ©ç”¨GDBå’ŒQEMUè¯åˆåµéŒ¯æ ¸å¿ƒé‹è¡Œã€‚</p>
<pre><code>é—œéµè©: Qemu, Kernel, Linux, OS, RISC-V, Cross Compiler Toolchain, GDB
</code></pre>
<h2 id="3-å¯¦é©—ç’°å¢ƒ"><a class="header" href="#3-å¯¦é©—ç’°å¢ƒ">3 å¯¦é©—ç’°å¢ƒ</a></h2>
<h3 id="31-å¯¦é©—å¹³è‡º"><a class="header" href="#31-å¯¦é©—å¹³è‡º">3.1 å¯¦é©—å¹³è‡º</a></h3>
<ul>
<li>Linux ç™¼è¡Œç‰ˆ: <a href="http://mirrors.zju.edu.cn/ubuntu-releases/releases/20.04.2.0/ubuntu-20.04.2.0-desktop-amd64.iso">Ubuntu 20.04 LTS</a></li>
</ul>
<pre><code>$ lsb_release -a # æŸ¥çœ‹ç•¶å‰å¯¦é©—å¹³è‡ºç³»çµ±ç™¼è¡Œç‰ˆçš„å…·é«”ç‰ˆæœ¬è™Ÿ 
No LSB modules are available.
Distributor ID:	Ubuntu
Description:	Ubuntu 20.04.2 LTS
Release:	20.04
Codename:	focal
</code></pre>
<ul>
<li>è«‹é¸æ“‡å¦‚ä¸‹åˆé©çš„æ–¹å¼é‹è¡ŒLinuxå¯¦é©—ä½œæ¥­ç³»çµ±
<ul>
<li>ç‰©ç†æ©Ÿ/è™›æ“¬æ©Ÿå™¨(Virtual Box, Vmwareâ€¦)</li>
<li>Windows Subsystem for Linux(WSL)</li>
<li>Dockeré¡åƒé‹è¡Œ</li>
</ul>
</li>
</ul>
<h3 id="32-å¯¦é©—æ‰€éœ€çš„å·¥å…·åŸå§‹ç¢¼"><a class="header" href="#32-å¯¦é©—æ‰€éœ€çš„å·¥å…·åŸå§‹ç¢¼">3.2 å¯¦é©—æ‰€éœ€çš„å·¥å…·/åŸå§‹ç¢¼</a></h3>
<ul>
<li><a href="https://download.qemu.org/qemu-6.0.0.tar.xz">QEMU 6.0.0</a></li>
<li><a href="https://mirrors.edge.kernel.org/pub/linux/kernel/v5.x/linux-5.10.42.tar.gz">Linux Kernel 5.10.42(LTS)</a></li>
<li>[RISCâ€‘V Compiler Toolchain](http://riscv-gnu-toolchain: riscv-gnu-toolchain æ˜¯ä¸€å€‹ç”¨ä¾†æ”¯æŒ RISC-V ç‚ºå¾Œç«¯çš„Cå’ŒC++äº¤å‰ç·¨è­¯å·¥å…·éˆ, åŒ…å«é€šç”¨çš„ELF/Newlibå’Œæ›´å¾©é›œçš„Linux-ELF/glibcå…©ç¨® (gitee.com))</li>
</ul>
<h2 id="4-èƒŒæ™¯çŸ¥è­˜"><a class="header" href="#4-èƒŒæ™¯çŸ¥è­˜">4 èƒŒæ™¯çŸ¥è­˜</a></h2>
<h3 id="41-risc-vè‡ªç”±å’Œé–‹æ”¾çš„riscæŒ‡ä»¤é›†æ¶æ§‹"><a class="header" href="#41-risc-vè‡ªç”±å’Œé–‹æ”¾çš„riscæŒ‡ä»¤é›†æ¶æ§‹">4.1 RISC-Vï¼šè‡ªç”±å’Œé–‹æ”¾çš„RISCæŒ‡ä»¤é›†æ¶æ§‹</a></h3>
<ul>
<li><a href="https://riscv.org/about/history/">RISC-Væ­·å²</a></li>
<li><a href="https://riscv.org/wp-content/uploads/2021/05/RISC-V-Introduction.pptx">RISC-Vä»‹ç´¹</a></li>
</ul>
<pre><code>RISC-V ISAç™¼ç«¯æ–¼æ·±åšçš„å­¸è¡“ç ”ç©¶ï¼Œå°‡å…è²»ä¸”å¯æ“´å±•çš„è»Ÿç¡¬é«”æ¶æ§‹è‡ªç”±åº¦æå‡è‡³æ–°çš„æ°´å¹³ï¼Œç‚ºæœªä¾†50å¹´çš„è¨ˆç®—è¨­è¨ˆèˆ‡å‰µæ–°é‹ªå¹³äº†é“è·¯ã€‚
</code></pre>
<h3 id="42-qemuä¸€æ¬¾é–‹æºä¸”é€šç”¨çš„æ¨¡æ“¬å™¨å’Œè™›æ“¬æ©Ÿå™¨"><a class="header" href="#42-qemuä¸€æ¬¾é–‹æºä¸”é€šç”¨çš„æ¨¡æ“¬å™¨å’Œè™›æ“¬æ©Ÿå™¨">4.2 QEMUï¼šä¸€æ¬¾é–‹æºä¸”é€šç”¨çš„æ¨¡æ“¬å™¨å’Œè™›æ“¬æ©Ÿå™¨</a></h3>
<ul>
<li><a href="https://wiki.qemu.org/Main_Page">QEMUä»‹ç´¹</a></li>
<li><a href="https://qemu-project.gitlab.io/qemu/system/index.html">QEMUä½¿ç”¨è€…æ‰‹å†Š</a></li>
</ul>
<h4 id="421-ä»€éº¼æ˜¯qemu"><a class="header" href="#421-ä»€éº¼æ˜¯qemu">4.2.1 ä»€éº¼æ˜¯QEMU</a></h4>
<p>QEMUæœ€é–‹å§‹æ˜¯ç”±æ³•åœ‹ç¨‹å¼è¨­è¨ˆå¸«Fabrice Bellardé–‹ç™¼çš„æ¨¡æ“¬å™¨ã€‚QEMUèƒ½å¤ å®Œæˆä½¿ç”¨è€…ç¨‹åºæ¨¡æ“¬å’Œç³»çµ±è™›æ“¬åŒ–æ¨¡æ“¬ã€‚ä½¿ç”¨è€…ç¨‹åºæ¨¡æ“¬æŒ‡çš„æ˜¯QEMUèƒ½å¤ å°‡ç‚ºä¸€å€‹å¹³è‡ºç·¨è­¯çš„äºŒé€²åˆ¶æª”æ¡ˆé‹è¡Œåœ¨å¦ä¸€å€‹ä¸åŒçš„å¹³è‡ºï¼Œå¦‚ä¸€å€‹ARMæŒ‡ä»¤é›†çš„äºŒé€²è£½ç¨‹åºï¼Œé€šéQEMUçš„TCGï¼ˆTiny Code Generatorï¼‰å¼•æ“çš„è™•ç†ä¹‹å¾Œï¼ŒARMæŒ‡ä»¤è¢«è½‰åŒ–ç‚ºTCGä¸­é–“ç¨‹å¼ç¢¼ï¼Œç„¶å¾Œå†è½‰åŒ–ç‚ºç›®æ¨™å¹³è‡ºï¼ˆæ¯”å¦‚Intel x86ï¼‰çš„ç¨‹å¼ç¢¼ã€‚ç³»çµ±è™›æ“¬åŒ–æ¨¡æ“¬æŒ‡çš„æ˜¯QEMUèƒ½å¤ æ¨¡æ“¬ä¸€å€‹å®Œæ•´çš„ç³»çµ±è™›æ“¬æ©Ÿå™¨ï¼Œè©²è™›æ“¬æ©Ÿå™¨æœ‰è‡ªå·±çš„è™›æ“¬CPUï¼Œæ™¶ç‰‡çµ„ï¼Œè™›æ“¬è¨˜æ†¶é«”ä»¥åŠå„ç¨®è™›æ“¬å¤–éƒ¨è£ç½®ï¼Œèƒ½å¤ ç‚ºè™›æ“¬æ©Ÿå™¨ä¸­é‹è¡Œçš„ä½œæ¥­ç³»çµ±å’Œæ‡‰ç”¨è»Ÿé«”å‘ˆç¾å‡ºèˆ‡ç‰©ç†é›»è…¦å®Œå…¨ä¸€è‡´çš„ç¡¬é«”æª¢è¦–ã€‚</p>
<h4 id="422-å¦‚ä½•ä½¿ç”¨-qemuå¸¸è¦‹åƒæ•¸ä»‹ç´¹"><a class="header" href="#422-å¦‚ä½•ä½¿ç”¨-qemuå¸¸è¦‹åƒæ•¸ä»‹ç´¹">4.2.2 å¦‚ä½•ä½¿ç”¨ QEMUï¼ˆå¸¸è¦‹åƒæ•¸ä»‹ç´¹ï¼‰</a></h4>
<p>ä»¥ä»¥ä¸‹å‘½ä»¤ç‚ºä¾‹ï¼Œæˆ‘å€‘ç°¡å–®ä»‹ç´¹QEMUçš„åƒæ•¸æ‰€ä»£è¡¨çš„å«ç¾©</p>
<pre><code>$ qemu-system-riscv64 -nographic -machine virt -kernel build/linux/arch/riscv/boot/Image  \
 -device virtio-blk-device,drive=hd0 -append "root=/dev/vda ro console=ttyS0"   \
 -bios default -drive file=rootfs.ext4,format=raw,id=hd0 \
 -netdev user,id=net0 -device virtio-net-device,netdev=net0 -S -s
</code></pre>
<p><strong>-nographic</strong>: ä¸ä½¿ç”¨åœ–å½¢çª—å£ï¼Œä½¿ç”¨å‘½ä»¤åˆ—
<strong>-machine</strong>: æŒ‡å®šè¦emulateçš„æ©Ÿå™¨ï¼Œå¯ä»¥é€šéå‘½ä»¤<code>qemu-system-riscv64 -machine help</code>æŸ¥çœ‹å¯é¸æ“‡çš„æ©Ÿå™¨é¸é …
<strong>-kernel</strong>: æŒ‡å®šæ ¸å¿ƒimage
<strong>-append cmdline</strong>: ä½¿ç”¨cmdlineä½œç‚ºæ ¸å¿ƒçš„å‘½ä»¤åˆ—
<strong>-device</strong>: æŒ‡å®šè¦æ¨¡æ“¬çš„è£ç½®ï¼Œå¯ä»¥é€šéå‘½ä»¤<code>qemu-system-riscv64 -device help</code>æŸ¥çœ‹å¯é¸æ“‡çš„è£ç½®ï¼Œé€šéå‘½ä»¤<code>qemu-system-riscv64 -device &lt;å…·é«”çš„è£ç½®&gt;,help</code>æŸ¥çœ‹æŸå€‹è£ç½®çš„å‘½ä»¤é¸é …
<strong>-drive, file=&lt;file_name&gt;</strong>: ä½¿ç”¨â€™fileâ€™ä½œç‚ºæª”æ¡ˆç³»çµ±
<strong>-netdev user,id=str</strong>: æŒ‡å®šuser modeçš„è™›æ“¬ç¶²è·¯å¡, æŒ‡å®šIDç‚ºstr
<strong>-S</strong>: å•Ÿå‹•æ™‚æš«åœCPUåŸ·è¡Œ(ä½¿ç”¨â€™câ€™å•Ÿå‹•åŸ·è¡Œ)
<strong>-s</strong>: -gdb tcp::1234 çš„ç°¡å¯«
<strong>-bios default</strong>: ä½¿ç”¨é»˜èªçš„OpenSBI firmwareä½œç‚ºbootloader</p>
<p>æ›´å¤šåƒæ•¸è³‡è¨Šå¯ä»¥åƒè€ƒ<a href="https://www.qemu.org/docs/master/system/index.html">é€™è£¡</a></p>
<h3 id="43-linux-æ ¸å¿ƒ"><a class="header" href="#43-linux-æ ¸å¿ƒ">4.3 Linux æ ¸å¿ƒ</a></h3>
<p>Linux is a clone of the operating system Unix, written from scratch by Linus Torvalds with assistance from a loosely-knit team of hackers across the Net. It aims towards POSIX and <a href="http://www.unix.org/">Single UNIX Specification</a> compliance.</p>
<p>It has all the features you would expect in a modern fully-fledged Unix, including true multitasking, virtual memory, shared libraries, demand loading, shared copy-on-write executables, proper memory management, and multistack networking including IPv4 and IPv6.</p>
<p>Although originally developed first for 32-bit x86-based PCs (386 or higher), today Linux also runs on a multitude of other processor architectures, in both 32- and 64-bit variants.</p>
<h4 id="431-linux-ä½¿ç”¨åŸºç¤"><a class="header" href="#431-linux-ä½¿ç”¨åŸºç¤">4.3.1 Linux ä½¿ç”¨åŸºç¤</a></h4>
<p>åœ¨Linuxç’°å¢ƒä¸‹ï¼Œäººå€‘é€šå¸¸ä½¿ç”¨å‘½ä»¤åˆ—ä»‹é¢ä¾†å®Œæˆèˆ‡é›»è…¦çš„äº’å‹•ã€‚çµ‚ç«¯ï¼ˆTerminalï¼‰æ˜¯ç”¨æ–¼è™•ç†è©²éç¨‹çš„ä¸€å€‹æ‡‰ç”¨ç¨‹å¼ï¼Œé€šéçµ‚ç«¯ä½ å¯ä»¥é‹è¡Œå„ç¨®ç¨‹åºä»¥åŠåœ¨è‡ªå·±çš„é›»è…¦ä¸Šè™•ç†æª”æ¡ˆã€‚åœ¨é¡Unixçš„ä½œæ¥­ç³»çµ±ä¸Šï¼Œçµ‚ç«¯å¯ä»¥ç‚ºä½ å®Œæˆä¸€åˆ‡ä½ æ‰€éœ€è¦çš„æ“ä½œã€‚
ä¸‹é¢æˆ‘å€‘åƒ…å°å¯¦é©—ä¸­æ¶‰åŠçš„ä¸€äº›æ¦‚å¿µé€²è¡Œä»‹ç´¹ï¼Œä½ å¯ä»¥é€šéä¸‹é¢çš„é€£çµä¾†å°å‘½ä»¤åˆ—çš„ä½¿ç”¨é€²è¡Œå­¸ç¿’ï¼š</p>
<ol>
<li><a href="https://missing-semester-cn.github.io/2020/shell-tools">The Missing Semester of Your CS Education</a> <a href="https://www.bilibili.com/video/BV1x7411H7wa?p=2">&gt;&gt;Video&lt;&lt;</a></li>
<li><a href="https://tldp.org/LDP/GNU-Linux-Tools-Summary/html/index.html">GNU/Linux Command-Line Tools Summary</a></li>
<li><a href="https://github.com/berkeley-scf/tutorial-unix-basics">Basics of UNIX</a></li>
</ol>
<h4 id="432-linux-ç’°å¢ƒè®Šæ•¸"><a class="header" href="#432-linux-ç’°å¢ƒè®Šæ•¸">4.3.2 Linux ç’°å¢ƒè®Šæ•¸</a></h4>
<p>ç•¶æˆ‘å€‘åœ¨çµ‚ç«¯è¼¸å…¥å‘½ä»¤æ™‚ï¼Œçµ‚ç«¯æœƒæ‰¾åˆ°å°æ‡‰çš„ç¨‹åºä¾†é‹è¡Œã€‚æˆ‘å€‘å¯ä»¥é€šé<code>which</code>å‘½ä»¤ä¾†åšä¸€äº›å°çš„å¯¦é©—ï¼š</p>
<pre><code>$ which gcc
/usr/bin/gcc
$ ls -l /usr/bin/gcc
lrwxrwxrwx 1 root root 5 5æœˆ  21  2019 /usr/bin/gcc -&gt; gcc-7
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç•¶æˆ‘å€‘åœ¨è¼¸å…¥<code>gcc</code>å‘½ä»¤æ™‚ï¼Œçµ‚ç«¯å¯¦éš›åŸ·è¡Œçš„ç¨‹åºæ˜¯<code>/usr/bin/gcc</code>ã€‚å¯¦éš›ä¸Šï¼Œçµ‚ç«¯åœ¨åŸ·è¡Œå‘½ä»¤æ™‚ï¼Œæœƒå¾<code>PATH</code>ç’°å¢ƒè®Šæ•¸æ‰€åŒ…å«çš„åœ°å€ä¸­å°‹æ‰¾å°æ‡‰çš„ç¨‹åºä¾†åŸ·è¡Œã€‚æˆ‘å€‘å¯ä»¥å°‡<code>PATH</code>è®Šæ•¸åˆ—å°å‡ºä¾†ä¾†æª¢æŸ¥ä¸€ä¸‹å…¶æ˜¯å¦åŒ…å«<code>/usr/bin</code>ã€‚</p>
<pre><code>$ echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/phantom/.local/bin
</code></pre>
<p>åœ¨å¾Œé¢çš„å¯¦é©—ä¸­ï¼Œå¦‚æœä½ æƒ³ç›´æ¥è¨ªå•<code>riscv64-unknown-linux-gnu-gcc</code>ã€<code>qemu-system-riscv64</code>ç­‰ç¨‹åºï¼Œé‚£éº¼ä½ éœ€è¦æŠŠä»–å€‘æ‰€åœ¨çš„ç›®éŒ„æ–°å¢åˆ°ç›®éŒ„ä¸­ã€‚</p>
<pre><code>$ export PATH=$PATH:/opt/riscv/bin
</code></pre>
<h3 id="44-äº¤å‰ç·¨è­¯å·¥å…·éˆ"><a class="header" href="#44-äº¤å‰ç·¨è­¯å·¥å…·éˆ">4.4 äº¤å‰ç·¨è­¯å·¥å…·éˆ</a></h3>
<p>compiler is a kind of computer software that compiles a high-level language (such as C) into machine instructions that can be executed by the target CPU platform.</p>
<h4 id="441-ç·¨è­¯å™¨çš„é¡åˆ¥"><a class="header" href="#441-ç·¨è­¯å™¨çš„é¡åˆ¥">4.4.1 ç·¨è­¯å™¨çš„é¡åˆ¥</a></h4>
<p>é€™è£¡é¦–å…ˆä»‹ç´¹å¦‚ä¸‹ä¸‰ç¨®æ¦‚å¿µåè©ï¼š</p>
<ul>
<li><em><strong>*The build system: The machine which generates the compiler binaries.*</strong></em></li>
<li><em><strong>*The host system: The system which runs the compiler binaries.*</strong></em></li>
<li><em><strong>*The target system: The system which runs the application code compiled by the compiler binari*</strong></em></li>
</ul>
<p>æ ¹æ“šä¸Šè¿°ä¸åŒå¹³è‡ºä¹‹é–“çš„ç•°åŒï¼Œç·¨è­¯å™¨å¯ä»¥åˆ†ç‚ºå¦‚ä¸‹å¹¾ç¨®é¡å‹ï¼š</p>
<ul>
<li><strong>native compiler</strong>: A compiler where <strong>target</strong> is the same system as <strong>host</strong>.</li>
<li><strong>cross compiler</strong>: A compiler where <strong>target</strong> is not the same system as <strong>host</strong>.</li>
</ul>
<p>å…¶ä¸­**äº¤å‰ç·¨è­¯å·¥å…·éˆï¼ˆCross Compilerï¼‰**æ˜¯æˆ‘å€‘åœ¨æœ¬ç³»åˆ—å¯¦é©—ä¸­æ”¹æ¡ç”¨çš„ä¸»è¦ç·¨è­¯å·¥å…·ã€‚äº¤å‰ç·¨è­¯æŒ‡çš„æ˜¯åœ¨ä¸€å€‹å¹³è‡ºä¸Šç·¨è­¯å¯ä»¥åœ¨å¦ä¸€å€‹å¹³è‡ºé‹è¡Œçš„ç¨‹åºï¼Œä¾‹å¦‚åœ¨x86æ©Ÿå™¨ä¸Šç·¨è­¯å¯ä»¥åœ¨armå¹³è‡ºé‹è¡Œçš„ç¨‹åºï¼Œäº¤å‰ç·¨è­¯éœ€è¦äº¤å‰ç·¨è­¯å·¥å…·éˆçš„æ”¯æ´ã€‚</p>
<p>åœ¨å¾ŒçºŒå¯¦é©—ä¸­æˆ‘å€‘ä»¤ï¼š</p>
<pre><code>build = X86_64 linux
host =  X86_64 linux
target = RISC-V64 
</code></pre>
<h4 id="442-gnu-gcc"><a class="header" href="#442-gnu-gcc">4.4.2 GNU GCC</a></h4>
<p>GCC stands for GNU Compiler Collection</p>
<p>GCC is an integrated distribution of compilers for several major programming languages. These languages currently include C, C++,Objective-C, Objective-C++, Fortran, Ada, D, Go, and BRIG (HSAIL)</p>
<blockquote>
<p><a href="https://gcc.gnu.org/onlinedocs/gcc-11.1.0/gcc/">GCC 11.1 Manual</a></p>
<p>Using the GNU Compiler Collection For gcc version 11.1.0
<a href="https://stallman.org/">Richard M. Stallman</a> and the <a href="https://gcc.gnu.org/">GCC Developer Community</a></p>
</blockquote>
<h4 id="442-gnu-binutils"><a class="header" href="#442-gnu-binutils">4.4.2 GNU Binutils</a></h4>
<p>The GNU Binutils are a collection of binary tools. The main ones are:</p>
<ul>
<li><strong>ld</strong> â€“ the GNU linker.</li>
<li><strong>as</strong> â€“ the GNU assembler.</li>
</ul>
<p>But they also include:</p>
<ul>
<li><strong>addr2line</strong> â€“ Converts addresses into filenames and line numbers.</li>
<li><strong>ar</strong> â€“ A utility for creating, modifying and extracting from archives.</li>
<li><strong>c++filt</strong> â€“ Filter to demangle encoded C++ symbols.</li>
<li><strong>dlltool</strong> â€“ Creates files for building and using DLLs.</li>
<li><strong>gold</strong> â€“ A new, faster, ELF only linker, still in beta test.</li>
<li><strong>gprof</strong> â€“ Displays profiling information.</li>
<li><strong>nlmconv</strong> â€“ Converts object code into an NLM.</li>
<li><strong>nm</strong> â€“ Lists symbols from object files.</li>
<li><strong>objcopy</strong> â€“ Copies and translates object files.</li>
<li><strong>objdump</strong> â€“ Displays information from object files.</li>
<li><strong>ranlib</strong> â€“ Generates an index to the contents of an archive.</li>
<li><strong>readelf</strong> â€“ Displays information from any ELF format object file.</li>
<li><strong>size</strong> â€“ Lists the section sizes of an object or archive file.</li>
<li><strong>strings</strong> â€“ Lists printable strings from files.</li>
<li><strong>strip</strong> â€“ Discards symbols.</li>
<li><strong>windmc</strong> â€“ A Windows compatible message compiler.</li>
<li><strong>windres</strong> â€“ A compiler for Windows resource files.</li>
</ul>
<p>Most of these programs use <strong>BFD</strong>, the Binary File Descriptor library, to do low-level manipulation. Many of them also use the <strong>opcodes</strong> library to assemble and disassemble machine instructions.</p>
<blockquote>
<p><a href="https://www.gnu.org/software/binutils/">GNU Binutils</a></p>
<p><a href="https://www.gnu.org/"><strong>GNU</strong> Operating System</a>
Supported by the <a href="https://www.gnu.org/software/binutils/#mission-statement">Free Software Foundation</a></p>
</blockquote>
<h3 id="45-gdb-ä½¿ç”¨åŸºç¤"><a class="header" href="#45-gdb-ä½¿ç”¨åŸºç¤">4.5 GDB ä½¿ç”¨åŸºç¤</a></h3>
<h4 id="451-ä»€éº¼æ˜¯-gdb"><a class="header" href="#451-ä»€éº¼æ˜¯-gdb">4.5.1 ä»€éº¼æ˜¯ GDB</a></h4>
<p>GNUåµéŒ¯ç¨‹å¼ï¼ˆè‹±èªï¼šGNU Debuggerï¼Œç¸®å¯«ï¼šgdbï¼‰æ˜¯ä¸€å€‹ç”±GNUé–‹æºçµ„ç¹”ç™¼ä½ˆçš„ã€UNIX/LINUXä½œæ¥­ç³»çµ±ä¸‹çš„ã€åŸºæ–¼å‘½ä»¤åˆ—çš„ã€åŠŸèƒ½å¼·å¤§çš„ç¨‹åºåµéŒ¯å·¥å…·ã€‚è—‰åŠ©åµéŒ¯ç¨‹å¼ï¼Œæˆ‘å€‘èƒ½å¤ æŸ¥çœ‹å¦ä¸€å€‹ç¨‹åºåœ¨åŸ·è¡Œæ™‚å¯¦éš›åœ¨åšä»€éº¼ï¼ˆæ¯”å¦‚è¨ªå•å“ªäº›è¨˜æ†¶é«”ã€æš«å­˜å™¨ï¼‰ï¼Œåœ¨å…¶ä»–ç¨‹å¼ç•¶æ‰çš„æ™‚å€™å¯ä»¥æ¯”è¼ƒå¿«é€Ÿåœ°ç­è§£å°è‡´ç¨‹å¼ç•¶æ‰çš„åŸå› ã€‚
è¢«åµéŒ¯çš„ç¨‹åºå¯ä»¥æ˜¯å’Œgdbåœ¨åŒä¸€è‡ºæ©Ÿå™¨ä¸Šï¼ˆæœ¬åœ°åµéŒ¯ï¼Œor native debugï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸åŒæ©Ÿå™¨ä¸Šï¼ˆé ç«¯åµéŒ¯ï¼Œ or remote debugï¼‰ã€‚</p>
<p>ç¸½çš„ä¾†èªªï¼Œgdbå¯ä»¥æœ‰ä»¥ä¸‹4å€‹åŠŸèƒ½</p>
<ul>
<li>å•Ÿå‹•ç¨‹åºï¼Œä¸¦æŒ‡å®šå¯èƒ½å½±éŸ¿å…¶è¡Œç‚ºçš„æ‰€æœ‰å…§å®¹</li>
<li>ä½¿ç¨‹åºåœ¨æŒ‡å®šæ¢ä»¶ä¸‹åœæ­¢</li>
<li>æª¢æŸ¥ç¨‹åºåœæ­¢æ™‚ç™¼ç”Ÿäº†ä»€éº¼</li>
<li>æ›´æ”¹ç¨‹åºä¸­çš„å…§å®¹ï¼Œä»¥ä¾¿ç³¾æ­£ä¸€å€‹bugçš„å½±éŸ¿</li>
</ul>
<h4 id="452-gdb-åŸºæœ¬å‘½ä»¤ä»‹ç´¹"><a class="header" href="#452-gdb-åŸºæœ¬å‘½ä»¤ä»‹ç´¹">4.5.2 GDB åŸºæœ¬å‘½ä»¤ä»‹ç´¹</a></h4>
<p>(gdb) startï¼šå–®æ­¥åŸ·è¡Œï¼Œé‹è¡Œç¨‹åºï¼Œåœåœ¨ç¬¬ä¸€åŸ·è¡Œèªå¥
(gdb) nextï¼šå–®æ­¥åµéŒ¯ï¼ˆé€éç¨‹ï¼Œå‡½æ•¸ç›´æ¥åŸ·è¡Œï¼‰,ç°¡å¯«n
(gdb) runï¼šé‡æ–°é–‹å§‹é‹è¡Œæª”æ¡ˆï¼ˆrun-textï¼šè¼‰å…¥æ–‡å­—æª”ï¼Œrun-binï¼šè¼‰å…¥äºŒé€²åˆ¶æª”æ¡ˆï¼‰ï¼Œç°¡å¯«r
(gdb) backtraceï¼šæŸ¥çœ‹å‡½æ•¸çš„å‘¼å«çš„æ£§å¹€å’Œå±¤ç´šé—œä¿‚ï¼Œç°¡å¯«bt
(gdb) break è¨­å®šæ–·é»ã€‚æ¯”å¦‚æ–·åœ¨å…·é«”çš„å‡½æ•¸å°±break funcï¼›æ–·åœ¨æŸä¸€è¡Œbreak filename:num
(gdb) finishï¼šçµæŸç•¶å‰å‡½æ•¸ï¼Œè¿”å›åˆ°å‡½æ•¸å‘¼å«é»
(gdb) frameï¼šåˆ‡æ›å‡½æ•¸çš„æ£§å¹€ï¼Œç°¡å¯«f
(gdb) printï¼šåˆ—å°å€¼åŠåœ°å€ï¼Œç°¡å¯«p
(gdb) infoï¼šæŸ¥çœ‹å‡½æ•¸å…§éƒ¨å±€éƒ¨è®Šæ•¸çš„æ•¸å€¼ï¼Œç°¡å¯«iï¼›æŸ¥çœ‹æš«å­˜å™¨çš„å€¼i register xxx
(gdb) displayï¼šè¿½è¹¤æŸ¥çœ‹å…·é«”è®Šæ•¸å€¼</p>
<p>æ›´å¤šå‘½ä»¤å¯ä»¥åƒè€ƒ<a href="https://wizardforcel.gitbooks.io/100-gdb-tips/content/">100å€‹gdbå°æŠ€å·§</a></p>
<h4 id="453-gdb-å¤–æ›ä½¿ç”¨ä¸åšè¦æ±‚"><a class="header" href="#453-gdb-å¤–æ›ä½¿ç”¨ä¸åšè¦æ±‚">4.5.3 GDB å¤–æ›ä½¿ç”¨ï¼ˆä¸åšè¦æ±‚ï¼‰</a></h4>
<p>å–®ç´”ä½¿ç”¨gdbæ¯”è¼ƒç¹ç‘£ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨gdbå¤–æ›è®“åµéŒ¯éç¨‹æ›´æœ‰æ•ˆç‡ã€‚æ¨è–¦å„ä½åŒå­¸ä½¿ç”¨gefï¼Œç”±æ–¼ç•¶å‰å·¥å…·éˆé‚„ä¸æ”¯æ´ <code>python3</code>ï¼Œè«‹ä½¿ç”¨èˆŠç‰ˆæœ¬çš„<a href="https://github.com/hugsy/gef-legacy">gef-legacy</a>ã€‚
è©²å€‰åº«ä¸­å·²ç¶“å–æ¶ˆçš„åŸæœ‰çš„å®‰è£æŒ‡ä»¤ç¢¼ï¼ŒåŒå­¸å€‘å¯ä»¥æŠŠ <code>gef.py</code> æŒ‡ä»¤ç¢¼è¤‡è£½ä¸‹ä¾†ï¼Œç›´æ¥åœ¨ <code>.gdbinit</code> ä¸­å¼•å°ï¼Œæ„Ÿèˆˆè¶£çš„åŒå­¸å¯ä»¥åƒè€ƒé€™ç¯‡<a href="http://zju.phvntom.tech/markdown/md2html.php?id=md/gef.md">æ–‡ç« ï¼ˆå…§éƒ¨ç¶²è·¯è¨ªå•)</a>ã€‚</p>
<h3 id="46-linux-æ ¸å¿ƒç·¨è­¯åŸºç¤"><a class="header" href="#46-linux-æ ¸å¿ƒç·¨è­¯åŸºç¤">4.6 LINUX æ ¸å¿ƒç·¨è­¯åŸºç¤</a></h3>
<h4 id="461-æ ¸å¿ƒçµ„æ…‹"><a class="header" href="#461-æ ¸å¿ƒçµ„æ…‹">4.6.1 æ ¸å¿ƒçµ„æ…‹</a></h4>
<p>æ ¸å¿ƒçµ„æ…‹æ˜¯ç”¨æ–¼çµ„æ…‹æ˜¯å¦å•Ÿç”¨æ ¸å¿ƒçš„å„é …ç‰¹æ€§ï¼Œæ ¸å¿ƒæœƒæä¾›ä¸€å€‹åç‚º <code>defconfig</code>(å³default configuration) çš„é»˜èªçµ„æ…‹ï¼Œè©²çµ„æ…‹æª”æ¡ˆä½æ–¼å„å€‹æ¶æ§‹ç›®éŒ„çš„ <code>configs</code> è³‡æ–™å¤¾ä¸‹ï¼Œä¾‹å¦‚å°æ–¼RISC-Vè€Œè¨€ï¼Œå…¶é»˜èªçµ„æ…‹æª”æ¡ˆç‚º <code>arch/riscv/configs/defconfig</code>ã€‚ä½¿ç”¨ <code>make ARCH=riscv defconfig</code> å‘½ä»¤å¯ä»¥åœ¨æ ¸å¿ƒæ ¹ç›®éŒ„ä¸‹ç”Ÿæˆä¸€å€‹åç‚º <code>.config</code> çš„æª”æ¡ˆï¼ŒåŒ…å«äº†æ ¸å¿ƒå®Œæ•´çš„çµ„æ…‹ï¼Œæ ¸å¿ƒåœ¨ç·¨è­¯æ™‚æœƒæ ¹æ“š <code>.config</code> é€²è¡Œç·¨è­¯ã€‚çµ„æ…‹ä¹‹é–“å­˜åœ¨ç›¸äº’çš„ä¾è³´é—œä¿‚ï¼Œç›´æ¥ä¿®æ”¹defconfigæª”æ¡ˆæˆ–è€… <code>.config</code> æœ‰æ™‚å€™ä¸¦ä¸èƒ½é”åˆ°æƒ³è¦çš„æ•ˆæœã€‚å› æ­¤å¦‚æœéœ€è¦ä¿®æ”¹çµ„æ…‹ä¸€èˆ¬æ¡ç”¨ <code>make ARCH=riscv menuconfig</code> çš„æ–¹å¼å°æ ¸å¿ƒé€²è¡Œçµ„æ…‹ã€‚</p>
<h4 id="462-å¸¸è¦‹åƒæ•¸"><a class="header" href="#462-å¸¸è¦‹åƒæ•¸">4.6.2 å¸¸è¦‹åƒæ•¸</a></h4>
<p><strong>ARCH</strong> æŒ‡å®šæ¶æ§‹ï¼Œå¯é¸çš„å€¼åŒ…æ‹¬archç›®éŒ„ä¸‹çš„è³‡æ–™å¤¾åï¼Œå¦‚x86,arm,arm64ç­‰ï¼Œä¸åŒæ–¼armå’Œarm64ï¼Œ32ä½å’Œ64ä½çš„RISC-Vå…±ç”¨ <code>arch/riscv</code> ç›®éŒ„ï¼Œé€šéä½¿ç”¨ä¸åŒçš„configå¯ä»¥ç·¨è­¯32ä½æˆ–64ä½çš„æ ¸å¿ƒã€‚</p>
<p><strong>CROSS_COMPILE</strong> æŒ‡å®šä½¿ç”¨çš„äº¤å‰ç·¨è­¯å·¥å…·éˆï¼Œä¾‹å¦‚æŒ‡å®š <code>CROSS_COMPILE=aarch64-linux-gnu-</code>ï¼Œå‰‡ç·¨è­¯æ™‚æœƒæ¡ç”¨ <code>aarch64-linux-gnu-gcc</code> ä½œç‚ºç·¨è­¯å™¨ï¼Œç·¨è­¯å¯ä»¥åœ¨arm64å¹³è‡ºä¸Šé‹è¡Œçš„kernelã€‚</p>
<p><strong>CC</strong> æŒ‡å®šç·¨è­¯å™¨ï¼Œé€šå¸¸æŒ‡å®šè©²è®Šæ•¸æ˜¯ç‚ºäº†ä½¿ç”¨clangç·¨è­¯è€Œä¸æ˜¯ç”¨gccç·¨è­¯ï¼ŒLinuxæ ¸å¿ƒåœ¨é€æ­¥æä¾›å°clangç·¨è­¯çš„æ”¯æ´ï¼Œarm64å’Œx86å·²ç¶“èƒ½å¤ å¾ˆå¥½çš„ä½¿ç”¨clangé€²è¡Œç·¨è­¯ã€‚</p>
<h4 id="463-å¸¸ç”¨ç·¨è­¯é¸é …"><a class="header" href="#463-å¸¸ç”¨ç·¨è­¯é¸é …">4.6.3 å¸¸ç”¨ç·¨è­¯é¸é …</a></h4>
<pre><code>$ make defconfig	        ### ä½¿ç”¨ç•¶å‰å¹³è‡ºçš„é»˜èªçµ„æ…‹ï¼Œåœ¨x86æ©Ÿå™¨ä¸Šæœƒä½¿ç”¨x86çš„é»˜èªçµ„æ…‹
$ make -j$(nproc)	        ### ç·¨è­¯ç•¶å‰å¹³è‡ºçš„æ ¸å¿ƒï¼Œ-j$(nproc)ç‚ºä»¥æ©Ÿå™¨ç¡¬é«”åŸ·è¡Œç·’æ•¸é€²è¡Œå¤šåŸ·è¡Œç·’ç·¨è­¯

$ make ARCH=riscv defconfig	### ä½¿ç”¨RISC-Vå¹³è‡ºçš„é»˜èªçµ„æ…‹
$ make ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- -j$(nproc)     ### ç·¨è­¯RISC-Vå¹³è‡ºæ ¸å¿ƒ

$ make clean	                ### æ¸…é™¤æ‰€æœ‰ç·¨è­¯å¥½çš„objectæª”æ¡ˆ
$ make mrproper	                ### æ¸…é™¤ç·¨è­¯çš„çµ„æ…‹æª”æ¡ˆï¼Œä¸­é–“æª”æ¡ˆå’Œçµæœæª”æ¡ˆ

$ make init/main.o	        ### ç·¨è­¯ç•¶å‰å¹³è‡ºçš„å–®å€‹objectæª”æ¡ˆinit/main.oï¼ˆæœƒåŒæ™‚ç·¨è­¯ä¾è³´çš„æª”æ¡ˆï¼‰
</code></pre>
<h2 id="5-å¯¦é©—æ­¥é©Ÿ"><a class="header" href="#5-å¯¦é©—æ­¥é©Ÿ">5 å¯¦é©—æ­¥é©Ÿ</a></h2>
<p>é€šå¸¸æƒ…æ³ä¸‹ï¼Œ<code>$</code> æç¤ºç¬¦è¡¨ç¤ºç•¶å‰é‹è¡Œçš„ä½¿ç”¨è€…ç‚ºæ™®é€šä½¿ç”¨è€…ï¼Œ<code>#</code> ä»£è¡¨ç•¶å‰é‹è¡Œçš„ä½¿ç”¨è€…ç‚ºç‰¹æ¬Šä½¿ç”¨è€…ã€‚
ä½†æ³¨æ„ï¼Œåœ¨ä¸‹æ–‡çš„ç¤ºä¾‹ä¸­ï¼Œä»¥ <code>###</code> é–‹é ­çš„è¡Œä»£è¡¨è¨»é‡‹ï¼Œ<code>$</code> é–‹é ­çš„è¡Œä»£è¡¨åœ¨ä½ çš„å®¿ä¸»æ©Ÿ/è™›æ“¬æ©Ÿå™¨ä¸Šé‹è¡Œçš„å‘½ä»¤ï¼Œ<code>#</code> é–‹é ­çš„è¡Œä»£è¡¨åœ¨ <code>docker</code> ä¸­é‹è¡Œçš„å‘½ä»¤ï¼Œ<code>(gdb)</code> é–‹é ­çš„è¡Œä»£è¡¨åœ¨ <code>gdb</code> ä¸­é‹è¡Œçš„å‘½ä»¤ã€‚
<strong>åœ¨åŸ·è¡Œæ¯ä¸€æ¢å‘½ä»¤å‰ï¼Œè«‹ä½ å°å°‡è¦é€²è¡Œçš„æ“ä½œé€²è¡Œæ€è€ƒï¼Œçµ¦å‡ºçš„å‘½ä»¤ä¸éœ€è¦å…¨éƒ¨åŸ·è¡Œï¼Œä¸¦ä¸”ä¸æ˜¯æ‰€æœ‰çš„å‘½ä»¤éƒ½å¯ä»¥ç„¡æ¢ä»¶åŸ·è¡Œï¼Œè«‹ä¸è¦ç›´æ¥è¤‡è£½è²¼ä¸Šå‘½ä»¤å»åŸ·è¡Œã€‚</strong></p>
<h3 id="51-å¯¦é©—ç’°å¢ƒè¨­å®š"><a class="header" href="#51-å¯¦é©—ç’°å¢ƒè¨­å®š">5.1 å¯¦é©—ç’°å¢ƒè¨­å®š</a></h3>
<h4 id="511-ä¸‹è¼‰å®‰è£å¿…è¦çš„å·¥å…·å’Œåº«"><a class="header" href="#511-ä¸‹è¼‰å®‰è£å¿…è¦çš„å·¥å…·å’Œåº«">5.1.1 ä¸‹è¼‰å®‰è£å¿…è¦çš„å·¥å…·å’Œåº«</a></h4>
<pre><code>$ sudo apt update
$ sudo apt upgrade
$ sudo apt install git \
        autoconf \
        automake \
        autotools-dev \
        ninja-build \
        build-essential \
        libmpc-dev \
        libmpfr-dev \
        libgmp-dev \
        libglib2.0-dev \
        libpixman-1-dev \
        libncurses5-dev \
        libtool \
        libexpat-dev \
        zlib1g-dev \
        curl \
        gawk \
        bison \
        flex \
        texinfo \
        gperf \
        patchutils \
        bc 
</code></pre>
<h4 id="512-ä¸‹è¼‰å’Œå®‰è£å¿…è¦çš„å·¥å…·éˆä»¥åŠåŸå§‹ç¢¼åŒ…"><a class="header" href="#512-ä¸‹è¼‰å’Œå®‰è£å¿…è¦çš„å·¥å…·éˆä»¥åŠåŸå§‹ç¢¼åŒ…">5.1.2 ä¸‹è¼‰å’Œå®‰è£å¿…è¦çš„å·¥å…·éˆä»¥åŠåŸå§‹ç¢¼åŒ…</a></h4>
<h5 id="5121-ç·¨è­¯å®‰è£-qemu-500"><a class="header" href="#5121-ç·¨è­¯å®‰è£-qemu-500">5.1.2.1 ç·¨è­¯å®‰è£ QEMU 5.0.0</a></h5>
<pre><code>$ mkdir riscv_oslab
$ cd ~/riscv64_oslab  ### é€²å…¥å¯¦é©—å·¥ä½œç›®éŒ„ï¼Œç„¶å¾Œç·šä¸Šç²å–QEMU 5.0.0ç‰ˆæœ¬çš„åŸå§‹ç¢¼å®‰è£åŒ…åˆ°ç•¶å‰ç›®éŒ„ä¸‹
$ wget https://download.qemu.org/qemu-5.0.0.tar.xz 
$ tar -xvJf qemu-5.0.0.tar.xz ### è§£å£“ç¸®åŸå§‹ç¢¼åŒ…åˆ°qemu-5.0.0è³‡æ–™å¤¾ä¸­
$ cd qemu-5.0.0 ### é€²å…¥è©²ç›®éŒ„
$ ./configure --static --target-list=riscv64-softmmu,riscv64-linux-user ### ç·¨è­¯å‰çµ„æ…‹å¥½QEMUï¼Œç—…è¨­å®šç›®æ¨™è™•ç†å™¨æ¶æ§‹ç‚º"64ä½çš„RISC-V"
$ make -j16 ### ç·¨è­¯ï¼Œå¯ç”¨nprocæŸ¥çœ‹å¯ç”¨çš„åŸ·è¡Œç·’æ•¸
$ make install ### å®‰è£QEMUåˆ°é»˜èªä½ç½®
</code></pre>
<p>æ­¤è™•ç·¨è­¯qemuçš„æ™‚å€™ï¼Œç›®æ¨™é¸æ“‡äº† riscv64-softmmu å’Œ riscv64-linux-userï¼Œå…©è€…å…·é«”çš„å€åˆ¥ç‚ºï¼š</p>
<p>To put it simply, xxx-softmmu will compile <strong>qemu-system-xxx</strong>, which is an emulated machine for xxx architecture (System Emulation). When it resets, the starting point will be the reset vector of that architecture. While xxx-linux-user, compiles <strong>qemu-xxx</strong>, which allows you to run user application in xxx architecture (User-mode Emulation). Which will seek the user applicationsâ€™ main function, and start execution from there.</p>
<p>å®‰è£å®Œç•¢å¾Œå¦‚æœåŸ·è¡Œå¦‚ä¸‹å‘½ä»¤å¾Œèƒ½å¤ æŸ¥çœ‹åˆ°qemuçš„å…·é«”ç‰ˆæœ¬ï¼Œå‰‡èªªæ˜å®‰è£æˆåŠŸ</p>
<pre><code>$ qemu-system-riscv64 --version
QEMU emulator version 5.0.0
Copyright (c) 2003-2021 Fabrice Bellard and the QEMU Project developers
</code></pre>
<h5 id="5122-ä¸‹è¼‰æˆ–ç·¨è­¯å®‰è£-riscv-gcc-toolchain"><a class="header" href="#5122-ä¸‹è¼‰æˆ–ç·¨è­¯å®‰è£-riscv-gcc-toolchain">5.1.2.2 ä¸‹è¼‰æˆ–ç·¨è­¯å®‰è£ RISCâ€‘V GCC Toolchain</a></h5>
<p><strong>é€”å¾‘</strong>1ï¼ˆæ¨è–¦ï¼‰ï¼šä¸‹è¼‰é ç·¨è­¯ç‰ˆæœ¬çš„ riscv-gnu-toolchain</p>
<ul>
<li>ä¸‹è¼‰newlibcç‰ˆæœ¬çš„riscv-gnu-toolchainï¼Œåœ°å€ï¼šhttps://www.sifive.com/software</li>
</ul>
<p>é€™è£¡å¯é¸æ“‡ä¸‹è¼‰ï¼šGNU Embedded Toolchain â€” v2020.12.8 Ubuntuç‰ˆæœ¬çš„ Prebuilt RISCâ€‘V GCC Toolchainï¼ˆå¸¶æœ‰gdbåµéŒ¯å·¥å…·ï¼‰åœ¨æ­¤æ‚¨ä¹Ÿå¯ä»¥é¸æ“‡é‹è¡Œåœ¨å…¶å®ƒç³»çµ±ç’°å¢ƒä¸‹çš„riscv-gnu-toolchain.</p>
<pre><code>$ cd ~/riscv64_oslab
$ wget https://static.dev.sifive.com/dev-tools/freedom-tools/v2020.12/riscv64-unknown-elf-toolchain-10.2.0-2020.12.8-x86_64-linux-ubuntu14.tar.gz
$ tar -xzvf riscv64-unknown-elf-toolchain-10.2.0-2020.12.8-x86_64-linux-ubuntu14.tar.gz ###è§£å£“
$ mv riscv64-unknown-elf-toolchain-10.2.0-2020.12.8-x86_64-linux-ubuntu14 \
     riscv64-unknown-elf-toolchain ### é‡æ–°å‘½åè³‡æ–™å¤¾
$ ç·¨è¼¯~/.bashrc åœ¨æª”æ¡ˆæœ«å°¾æ–°å¢å¦‚ä¸‹ç’°å¢ƒè®Šæ•¸è¨­å®šèªå¥
export PATH=~/riscv_oslab/riscv64-unknown-elf-toolchain/bin:$PATH
$ source ~/.bashrc
$ riscv64-unknown-elf-gcc --version ### æŸ¥çœ‹gccç‰ˆæœ¬
riscv64-unknown-elf-gcc (SiFive GCC-Metal 10.2.0-2020.12.8) 10.2.0
Copyright (C) 2020 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
</code></pre>
<ul>
<li>å®‰è£ glibc ç‰ˆæœ¬çš„ riscv-gnu-toolchain</li>
</ul>
<pre><code>$ sudo apt install binutils-riscv64-linux-gnu
$ sudo apt install gcc-riscv64-linux-gnu
$ riscv64-linux-gnu-gcc --version ### æŸ¥çœ‹gccç‰ˆæœ¬
riscv64-linux-gnu-gcc (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
Copyright (C) 2019 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
</code></pre>
<p><strong>é€”å¾‘2</strong>ï¼šå¾åŸå§‹ç¢¼ç·¨è­¯ç²å¾—</p>
<p>é¦–å…ˆä¸‹è¼‰ riscv-gnu-toolchainå€‰åº«</p>
<pre><code>$ git clone --recursive https://github.com/riscv/riscv-gnu-toolchain
</code></pre>
<p>æ³¨æ„ï¼šæ¡ç”¨ä¸Šè¿°Git cloneçš„æ–¹å¼ä¾†ç²å¾—riscv-gnu-toolchainå¯èƒ½éœ€è¦6.65GBçš„ç©ºé–“</p>
<p>ç·¨è­¯å®‰è£æ­¥é©Ÿï¼š</p>
<pre><code>./configure --prefix=/opt/riscv
make
</code></pre>
<h5 id="5123-ä½¿ç”¨ä¸Šè¿°äº¤å‰ç·¨è­¯å·¥å…·éˆç·¨è­¯linux-51042ç‰ˆæœ¬çš„æ ¸å¿ƒ"><a class="header" href="#5123-ä½¿ç”¨ä¸Šè¿°äº¤å‰ç·¨è­¯å·¥å…·éˆç·¨è­¯linux-51042ç‰ˆæœ¬çš„æ ¸å¿ƒ">5.1.2.3 ä½¿ç”¨ä¸Šè¿°äº¤å‰ç·¨è­¯å·¥å…·éˆç·¨è­¯Linux 5.10.42ç‰ˆæœ¬çš„æ ¸å¿ƒ</a></h5>
<pre><code class="language-sh">$ cd ~/riscv64_oslab
$ wget https://mirrors.edge.kernel.org/pub/linux/kernel/v5.x/linux-5.10.42.tar.gz
$ tar -xzvf linux-5.10.42.tar.gz
$ cd linux-5.10.42
$ make ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- defconfig
$ make ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- -j $(nproc)
  ...
  GEN     .version
  CHK     include/generated/compile.h
  LD      vmlinux.o
  MODPOST vmlinux.symvers
  MODINFO modules.builtin.modinfo
  GEN     modules.builtin
  LD      .tmp_vmlinux.kallsyms1
  KSYMS   .tmp_vmlinux.kallsyms1.S
  AS      .tmp_vmlinux.kallsyms1.S
  LD      .tmp_vmlinux.kallsyms2
  KSYMS   .tmp_vmlinux.kallsyms2.S
  AS      .tmp_vmlinux.kallsyms2.S
  LD      vmlinux
  SYSMAP  System.map
  MODPOST modules-only.symvers
  GEN     Module.symvers
  OBJCOPY arch/riscv/boot/Image
  CC [M]  fs/efivarfs/efivarfs.mod.o
  GZIP    arch/riscv/boot/Image.gz
  LD [M]  fs/efivarfs/efivarfs.ko
  Kernel: arch/riscv/boot/Image.gz is ready
</code></pre>
<h5 id="5124-ä½¿ç”¨ä¸Šè¿°äº¤å‰ç·¨è­¯å·¥å…·éˆç·¨è­¯busybox"><a class="header" href="#5124-ä½¿ç”¨ä¸Šè¿°äº¤å‰ç·¨è­¯å·¥å…·éˆç·¨è­¯busybox">5.1.2.4 ä½¿ç”¨ä¸Šè¿°äº¤å‰ç·¨è­¯å·¥å…·éˆç·¨è­¯Busybox</a></h5>
<pre><code class="language-sh">$ cd ~/riscv64_oslab
$ wget https://busybox.net/downloads/busybox-1.33.1.tar.bz2
$ tar  -jxvf  busybox-1.33.1.tar.bz2 
$ cd busybox-1.33.1
$ make ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- defconfig
$ make ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- menuconfig ### é€™è£¡æ‰“é–‹å¾Œå¯ä»¥é¸æ“‡ç›´æ¥exitï¼Œä¸¦ä¿å­˜åˆ°çµ„æ…‹æª”æ¡ˆ.configä¸­
$ æ‰“é–‹.configæª”æ¡ˆä¸¦ç·¨è¼¯æ–°å¢ 
  CONFIG_STATIC=y
$ make ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- -j $(nproc)
$ make ARCH=riscv CROSS_COMPILE=riscv64-linux-gnu- install
$ cd _install
$ mkdir proc sys dev etc etc/init.d
$ ls ### æŸ¥çœ‹ç›®éŒ„çµæ§‹
bin  dev  etc  linuxrc  proc  sbin  sys  usr
$ touch etc/init.d/rcS ä¸¦ç·¨è¼¯æª”æ¡ˆå…§å®¹ç‚ºå¦‚ä¸‹ï¼š ### We will now create a bash script in order to mount some devices automatically after the boot.
$ sudo mknod dev/console c 5 1
$ sudo mknod dev/ram b 1 0
#!bin/sh
mount -t proc none /proc
mount -t sysfs none /sys
/sbin/mdev -s
$ chmod +x etc/init.d/rcS # Now change the fileâ€™s mode as executable.
$ find -print0 | cpio -0oH newc | gzip -9 &gt; ../rootfs.img
$ cd ..
</code></pre>
<h5 id="5125-ä½¿ç”¨qemu-é‹è¡Œæˆ‘å€‘çš„linux-kernel"><a class="header" href="#5125-ä½¿ç”¨qemu-é‹è¡Œæˆ‘å€‘çš„linux-kernel">5.1.2.5 ä½¿ç”¨qemu é‹è¡Œæˆ‘å€‘çš„linux kernel</a></h5>
<p>å¾ä¸Šè¿°çš„å¯¦é©—æ­¥é©Ÿä¸­æˆ‘å€‘åˆ†åˆ¥ç²å¾—äº†</p>
<pre><code>~/riscv_oslab/busybox-1.33.1/rootfs.img
~/riscv_oslab/linux-5.10.42/arch/riscv/boot/Image
</code></pre>
<p>ä¸‹é¢æˆ‘å€‘åœ¨QEMUä¸­æ¨¡æ“¬é‹è¡Œæˆ‘å€‘åœ°Linuxæ ¸å¿ƒï¼š</p>
<p>åŸ·è¡Œå¦‚ä¸‹å‘½ä»¤åˆ—:</p>
<pre><code class="language-sh">$ qemu-system-riscv64 \
        -nographic -machine virt \
        -kernel ~/riscv_oslab/linux-5.10.42/arch/riscv/boot/Image \
        -initrd ~/riscv_oslab/busybox-1.33.1/rootfs.img  \
        -append "root=/dev/ram rdinit=/sbin/init"
</code></pre>
<p>å¯ä»¥çœ‹åˆ°æ•´å€‹Linux Kernelåœ°å•Ÿå‹•æµç¨‹ï¼š</p>
<pre><code>OpenSBI v0.9
   ____                    _____ ____ _____
  / __ \                  / ____|  _ \_   _|
 | |  | |_ __   ___ _ __ | (___ | |_) || |
 | |  | | '_ \ / _ \ '_ \ \___ \|  _ &lt; | |
 | |__| | |_) |  __/ | | |____) | |_) || |_
  \____/| .__/ \___|_| |_|_____/|____/_____|
        | |
        |_|

Platform Name             : riscv-virtio,qemu
Platform Features         : timer,mfdeleg
Platform HART Count       : 1
Firmware Base             : 0x80000000
Firmware Size             : 100 KB
Runtime SBI Version       : 0.2

Domain0 Name              : root
Domain0 Boot HART         : 0
Domain0 HARTs             : 0*
Domain0 Region00          : 0x0000000080000000-0x000000008001ffff ()
Domain0 Region01          : 0x0000000000000000-0xffffffffffffffff (R,W,X)
Domain0 Next Address      : 0x0000000080200000
Domain0 Next Arg1         : 0x0000000087000000
Domain0 Next Mode         : S-mode
Domain0 SysReset          : yes

Boot HART ID              : 0
Boot HART Domain          : root
Boot HART ISA             : rv64imafdcsu
Boot HART Features        : scounteren,mcounteren,time
Boot HART PMP Count       : 16
Boot HART PMP Granularity : 4
Boot HART PMP Address Bits: 54
Boot HART MHPM Count      : 0
Boot HART MHPM Count      : 0
Boot HART MIDELEG         : 0x0000000000000222
Boot HART MEDELEG         : 0x000000000000b109
[    0.000000] Linux version 5.10.42 (nn@ubuntu) (riscv64-linux-gnu-gcc (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0, GNU ld (GNU Binutils for Ubuntu) 2.34) #1 SMP Sat Jun 26 22:53:26 PDT 2021
[    0.000000] OF: fdt: Ignoring memory range 0x80000000 - 0x80200000
[    0.000000] efi: UEFI not found.
[    0.000000] Initial ramdisk at: 0x(____ptrval____) (1146880 bytes)
[    0.000000] Zone ranges:
[    0.000000]   DMA32    [mem 0x0000000080200000-0x0000000087ffffff]
[    0.000000]   Normal   empty
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x0000000080200000-0x0000000087ffffff]
[    0.000000] Initmem setup node 0 [mem 0x0000000080200000-0x0000000087ffffff]
[    0.000000] software IO TLB: Cannot allocate buffer
[    0.000000] SBI specification v0.2 detected
[    0.000000] SBI implementation ID=0x1 Version=0x9
[    0.000000] SBI v0.2 TIME extension detected
[    0.000000] SBI v0.2 IPI extension detected
[    0.000000] SBI v0.2 RFENCE extension detected
[    0.000000] SBI v0.2 HSM extension detected
[    0.000000] riscv: ISA extensions acdfimsu
[    0.000000] riscv: ELF capabilities acdfim
[    0.000000] percpu: Embedded 17 pages/cpu s32360 r8192 d29080 u69632
[    0.000000] Built 1 zonelists, mobility grouping on.  Total pages: 31815
[    0.000000] Kernel command line: root=/dev/ram rdinit=/sbin/init
[    0.000000] Dentry cache hash table entries: 16384 (order: 5, 131072 bytes, linear)
[    0.000000] Inode-cache hash table entries: 8192 (order: 4, 65536 bytes, linear)
[    0.000000] Sorting __ex_table...
[    0.000000] mem auto-init: stack:off, heap alloc:off, heap free:off
[    0.000000] Memory: 108180K/129024K available (6954K kernel code, 4125K rwdata, 4096K rodata, 223K init, 342K bss, 20844K reserved, 0K cma-reserved)
[    0.000000] Virtual kernel memory layout:
[    0.000000]       fixmap : 0xffffffcefee00000 - 0xffffffceff000000   (2048 kB)
[    0.000000]       pci io : 0xffffffceff000000 - 0xffffffcf00000000   (  16 MB)
[    0.000000]      vmemmap : 0xffffffcf00000000 - 0xffffffcfffffffff   (4095 MB)
[    0.000000]      vmalloc : 0xffffffd000000000 - 0xffffffdfffffffff   (65535 MB)
[    0.000000]       lowmem : 0xffffffe000000000 - 0xffffffe007e00000   ( 126 MB)
[    0.000000] SLUB: HWalign=64, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
[    0.000000] rcu: Hierarchical RCU implementation.
[    0.000000] rcu: 	RCU restricting CPUs from NR_CPUS=8 to nr_cpu_ids=1.
[    0.000000] rcu: 	RCU debug extended QS entry/exit.
[    0.000000] 	Tracing variant of Tasks RCU enabled.
[    0.000000] rcu: RCU calculated value of scheduler-enlistment delay is 25 jiffies.
[    0.000000] rcu: Adjusting geometry for rcu_fanout_leaf=16, nr_cpu_ids=1
[    0.000000] NR_IRQS: 64, nr_irqs: 64, preallocated irqs: 0
[    0.000000] riscv-intc: 64 local interrupts mapped
[    0.000000] plic: plic@c000000: mapped 53 interrupts with 1 handlers for 2 contexts.
[    0.000000] random: get_random_bytes called from start_kernel+0x312/0x484 with crng_init=0
[    0.000000] riscv_timer_init_dt: Registering clocksource cpuid [0] hartid [0]
[    0.000000] clocksource: riscv_clocksource: mask: 0xffffffffffffffff max_cycles: 0x24e6a1710, max_idle_ns: 440795202120 ns
[    0.000155] sched_clock: 64 bits at 10MHz, resolution 100ns, wraps every 4398046511100ns
[    0.003256] Console: colour dummy device 80x25
[    0.004684] printk: console [tty0] enabled
[    0.008705] Calibrating delay loop (skipped), value calculated using timer frequency.. 20.00 BogoMIPS (lpj=40000)
[    0.008862] pid_max: default: 32768 minimum: 301
[    0.009925] Mount-cache hash table entries: 512 (order: 0, 4096 bytes, linear)
[    0.009977] Mountpoint-cache hash table entries: 512 (order: 0, 4096 bytes, linear)
[    0.031354] rcu: Hierarchical SRCU implementation.
[    0.033066] EFI services will not be available.
[    0.034680] smp: Bringing up secondary CPUs ...
[    0.034774] smp: Brought up 1 node, 1 CPU
[    0.042458] devtmpfs: initialized
[    0.047904] clocksource: jiffies: mask: 0xffffffff max_cycles: 0xffffffff, max_idle_ns: 7645041785100000 ns
[    0.048157] futex hash table entries: 256 (order: 2, 16384 bytes, linear)
[    0.052753] NET: Registered protocol family 16
[    0.096960] vgaarb: loaded
[    0.097897] SCSI subsystem initialized
[    0.099470] usbcore: registered new interface driver usbfs
[    0.099708] usbcore: registered new interface driver hub
[    0.099841] usbcore: registered new device driver usb
[    0.109735] clocksource: Switched to clocksource riscv_clocksource
[    0.121388] NET: Registered protocol family 2
[    0.122636] IP idents hash table entries: 2048 (order: 2, 16384 bytes, linear)
[    0.125264] tcp_listen_portaddr_hash hash table entries: 128 (order: 0, 5120 bytes, linear)
[    0.125384] TCP established hash table entries: 1024 (order: 1, 8192 bytes, linear)
[    0.125566] TCP bind hash table entries: 1024 (order: 3, 32768 bytes, linear)
[    0.125704] TCP: Hash tables configured (established 1024 bind 1024)
[    0.126589] UDP hash table entries: 256 (order: 2, 24576 bytes, linear)
[    0.126838] UDP-Lite hash table entries: 256 (order: 2, 24576 bytes, linear)
[    0.127964] NET: Registered protocol family 1
[    0.130578] RPC: Registered named UNIX socket transport module.
[    0.130640] RPC: Registered udp transport module.
[    0.130666] RPC: Registered tcp transport module.
[    0.130690] RPC: Registered tcp NFSv4.1 backchannel transport module.
[    0.130796] PCI: CLS 0 bytes, default 64
[    0.132983] Unpacking initramfs...
[    0.184451] Freeing initrd memory: 1116K
[    0.186811] workingset: timestamp_bits=62 max_order=15 bucket_order=0
[    0.196540] NFS: Registering the id_resolver key type
[    0.197258] Key type id_resolver registered
[    0.197309] Key type id_legacy registered
[    0.197590] nfs4filelayout_init: NFSv4 File Layout Driver Registering...
[    0.197681] nfs4flexfilelayout_init: NFSv4 Flexfile Layout Driver Registering...
[    0.198313] 9p: Installing v9fs 9p2000 file system support
[    0.199295] NET: Registered protocol family 38
[    0.199533] Block layer SCSI generic (bsg) driver version 0.4 loaded (major 251)
[    0.199661] io scheduler mq-deadline registered
[    0.199745] io scheduler kyber registered
[    0.206411] pci-host-generic 30000000.pci: host bridge /soc/pci@30000000 ranges:
[    0.207040] pci-host-generic 30000000.pci:       IO 0x0003000000..0x000300ffff -&gt; 0x0000000000
[    0.207407] pci-host-generic 30000000.pci:      MEM 0x0040000000..0x007fffffff -&gt; 0x0040000000
[    0.207473] pci-host-generic 30000000.pci:      MEM 0x0400000000..0x07ffffffff -&gt; 0x0400000000
[    0.209120] pci-host-generic 30000000.pci: ECAM at [mem 0x30000000-0x3fffffff] for [bus 00-ff]
[    0.209814] pci-host-generic 30000000.pci: PCI host bridge to bus 0000:00
[    0.210081] pci_bus 0000:00: root bus resource [bus 00-ff]
[    0.210175] pci_bus 0000:00: root bus resource [io  0x0000-0xffff]
[    0.210203] pci_bus 0000:00: root bus resource [mem 0x40000000-0x7fffffff]
[    0.210228] pci_bus 0000:00: root bus resource [mem 0x400000000-0x7ffffffff]
[    0.211207] pci 0000:00:00.0: [1b36:0008] type 00 class 0x060000
[    0.257315] Serial: 8250/16550 driver, 4 ports, IRQ sharing disabled
[    0.263577] 10000000.uart: ttyS0 at MMIO 0x10000000 (irq = 2, base_baud = 230400) is a 16550A
[    0.293271] printk: console [ttyS0] enabled
[    0.298044] [drm] radeon kernel modesetting enabled.
[    0.311076] loop: module loaded
[    0.313675] libphy: Fixed MDIO Bus: probed
[    0.314711] e1000e: Intel(R) PRO/1000 Network Driver
[    0.314950] e1000e: Copyright(c) 1999 - 2015 Intel Corporation.
[    0.315481] ehci_hcd: USB 2.0 'Enhanced' Host Controller (EHCI) Driver
[    0.315834] ehci-pci: EHCI PCI platform driver
[    0.316191] ehci-platform: EHCI generic platform driver
[    0.316510] ohci_hcd: USB 1.1 'Open' Host Controller (OHCI) Driver
[    0.316869] ohci-pci: OHCI PCI platform driver
[    0.317290] ohci-platform: OHCI generic platform driver
[    0.318730] usbcore: registered new interface driver uas
[    0.319250] usbcore: registered new interface driver usb-storage
[    0.320182] mousedev: PS/2 mouse device common for all mice
[    0.323094] goldfish_rtc 101000.rtc: registered as rtc0
[    0.323986] goldfish_rtc 101000.rtc: setting system clock to 2021-06-27T06:45:02 UTC (1624776302)
[    0.326296] syscon-poweroff soc:poweroff: pm_power_off already claimed (____ptrval____) sbi_shutdown
[    0.326805] syscon-poweroff: probe of soc:poweroff failed with error -16
[    0.327990] usbcore: registered new interface driver usbhid
[    0.328373] usbhid: USB HID core driver
[    0.330278] NET: Registered protocol family 10
[    0.337351] Segment Routing with IPv6
[    0.338095] sit: IPv6, IPv4 and MPLS over IPv4 tunneling driver
[    0.340452] NET: Registered protocol family 17
[    0.341736] 9pnet: Installing 9P2000 support
[    0.342188] Key type dns_resolver registered
[    0.342886] debug_vm_pgtable: [debug_vm_pgtable         ]: Validating architecture page table helpers
[    0.378742] Freeing unused kernel memory: 220K
[    0.381020] Run /sbin/init as init process

Please press Enter to activate this console. 
</code></pre>
<p>ç”±æ–¼ä»¥å®‰è£äº†Busy Boxä¸¦è£½ä½œäº†rootfsï¼Œå› æ­¤å¯ä»¥é‹è¡Œè¼ƒå¤šçš„å¸¸ç”¨å‘½ä»¤ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code>/ # ls
bin      etc      proc     sbin     usr
dev      linuxrc  root     sys
/ # pwd
/ # cd bin
/bin # ls
arch           dumpkmap       kill           netstat        setarch
ash            echo           link           nice           setpriv
base32         ed             linux32        nuke           setserial
base64         egrep          linux64        pidof          sh
busybox        false          ln             ping           sleep
cat            fatattr        login          ping6          stat
chattr         fdflush        ls             pipe_progress  stty
chgrp          fgrep          lsattr         printenv       su
chmod          fsync          lzop           ps             sync
chown          getopt         makemime       pwd            tar
conspy         grep           mkdir          reformime      touch
cp             gunzip         mknod          resume         true
cpio           gzip           mktemp         rev            umount
cttyhack       hostname       more           rm             uname
date           hush           mount          rmdir          usleep
dd             ionice         mountpoint     rpm            vi
df             iostat         mpstat         run-parts      watch
dmesg          ipcalc         mt             scriptreplay   zcat
dnsdomainname  kbd_mode       mv             sed
/bin # 
é€€å‡ºQEMUæ¨¡æ“¬å™¨çš„æ–¹æ³•ç‚ºï¼š
ä½¿ç”¨ctrl+a(macOSä¸‹ç‚ºcontrol+a)ï¼Œé¬†é–‹å¾Œå†æŒ‰ä¸‹xéµå³å¯é€€å‡ºqemu
</code></pre>
<h2 id="debug-with-gdb"><a class="header" href="#debug-with-gdb">Debug with GDB</a></h2>
<p>æ¥ä¸‹ä¾†ä½¿ç”¨GDBä¾†åµéŒ¯é‹è¡Œåœ¨QEMUä¸­åœ°Linux Kernelï¼š</p>
<p>åœ¨ä¹‹å‰é‹è¡ŒQEMUå•Ÿå‹•Linux Kernelçš„å‘½ä»¤åˆ—ä¹‹å¾Œè¿½åŠ å¦‚ä¸‹å…©å€‹åƒæ•¸ <strong>-s -S</strong></p>
<pre><code>$ qemu-system-riscv64 \
        -nographic -machine virt \
        -kernel ~/riscv_oslab/linux-5.10.42/arch/riscv/boot/Image \
        -initrd ~/riscv_oslab/busybox-1.33.1/rootfs.img  \
        -append "root=/dev/ram rdinit=/sbin/init" \
        -s -S
</code></pre>
<p>ç„¶å¾Œæ‰“é–‹å¦ä¸€å€‹çµ‚ç«¯ï¼Œä½¿ç”¨ riscv64-unknown-elf-gdb é€²è¡Œæ ¸å¿ƒçš„åµéŒ¯å·¥ä½œ:</p>
<p>æŸ¥çœ‹gdbçš„ç‰ˆæœ¬è™Ÿï¼š</p>
<pre><code>$ riscv64-unknown-elf-gdb --version
GNU gdb (SiFive GDB-Metal 10.1.0-2020.12.7) 10.1
$ riscv64-unknown-elf-gdb ~/riscv_oslab/linux-5.10.42/vmlinux
</code></pre>
<p>è‹¥gdbæç¤ºå¦‚ä¸‹è³‡è¨Šï¼š</p>
<pre><code>Reading symbols from .../vmlinuxâ€¦
(No debugging symbols found in .../vmlinux)
</code></pre>
<p>éœ€è¦é‡æ–°ç·¨è­¯æ ¸å¿ƒ,éœ€è¦åœ¨æ ¸å¿ƒMakefileçš„KBUILD_CFLAGSä¸Šæ–°å¢**-g**é¸é …ï¼Œç„¶å¾Œç¹¼çºŒé‹è¡Œä¸Šè¿°å‘½ä»¤åˆ—å•Ÿå‹•gdbé–‹å§‹åµéŒ¯</p>
<p>åœ¨gdbä¸­æ–°å¢æ–·é»,å¦‚åœ¨start_kernelè™•æ–°å¢æ–·é»å¾Œ,è¼¸â¼Šcontinue,å‰‡qemuæœƒåœ¨åˆå§‹åŒ–kernelçš„éç¨‹ä¸­åœæ­¢,å¦‚ä¸‹æ‰€ç¤º:</p>
<pre><code>(gdb) remote target localhost:1234 ### é€£æ¥æœ¬åœ°QemuåµéŒ¯é€£æ¥åŸ 
(gdb) b start_kernel 
Breakpoint 1 at 0xffffffe00000272e
(gdb) continue
Continuing.
Breakpoint 1, 0xffffffe00000272e in start_kernel ()
</code></pre>

                        <script src="https://utteranc.es/client.js"
                            repo="imxood/imxood.github.io"
                            issue-term="pathname"
                            theme="boxy-light"
                            crossorigin="anonymous"
                            async>
                        </script>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../riscv/qemi_gdb.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../centos/centos.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../riscv/qemi_gdb.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../centos/centos.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script type="text/javascript">
            window.playground_line_numbers = true;
        </script>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>

        <script src="../ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="../editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>

        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../theme/custom/mermaid.min.js"></script>
        <script type="text/javascript" src="../theme/custom/mermaid-init.js"></script>


    </body>
</html>
