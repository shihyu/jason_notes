<!DOCTYPE HTML>
<html lang="zh" class="sidebar-visible no-js rust">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Move - Jason Notes</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/custom/custom.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html">Jason Notes</a></li><li class="chapter-item expanded "><a href="../ubuntu/ubuntu_setup.html">Ubuntu</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../ubuntu/command.html">Command</a></li><li class="chapter-item "><a href="../ubuntu/gcp.html">GCP ssh</a></li><li class="chapter-item "><a href="../ubuntu/wine.html">Wine</a></li></ol></li><li class="chapter-item expanded "><a href="../android/android.html">Android</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../android/install_sdk.html">SDK install</a></li><li class="chapter-item "><a href="../android/flutter.html">Flutter</a></li></ol></li><li class="chapter-item expanded "><a href="../tools/tools.html">Tools</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tools/asciinema.html">asciinema æŠŠçµ‚ç«¯æ“ä½œéŒ„è£½æˆ gif å‹•ç•«</a></li><li class="chapter-item "><a href="../tools/finmind.html">Finmind</a></li><li class="chapter-item "><a href="../tools/add-enter-and-exit-trace-for-your-function.html">addr2line</a></li><li class="chapter-item "><a href="../tools/cmake.html">cmake</a></li><li class="chapter-item "><a href="../tools/network.html">Network</a></li><li class="chapter-item "><a href="../tools/python-pycryptodome-aes-symmetric-encryption-tutorial-examples.html">å¯¦ä½œ AES å°ç¨±å¼åŠ å¯†</a></li></ol></li><li class="chapter-item expanded "><a href="../html/html.html">HTML</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../html/vue.html">Vue</a></li></ol></li><li class="chapter-item expanded "><a href="../vim/vim.html">Vim</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../vim/copilot.html">copilot</a></li><li class="chapter-item "><a href="../vim/tabnine.html">tabnine</a></li></ol></li><li class="chapter-item expanded "><a href="../gdb/gdb.html">Gdb</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../gdb/å¸¸ç”¨æŒ‡ä»¤.html">å¸¸ç”¨æŒ‡ä»¤</a></li><li class="chapter-item "><a href="../gdb/jemalloc.html">jemalloc</a></li><li class="chapter-item "><a href="../gdb/graphs.html">graphs</a></li><li class="chapter-item "><a href="../gdb/rust-gdb.html">rust gdb</a></li><li class="chapter-item "><a href="../gdb/qemu-gdb-risc-v64.html">qemu-gdb-risc-v64-kernel</a></li><li class="chapter-item "><a href="../gdb/go-rust-gdb-debug.html">ä½¿ç”¨gdb è¿½è¹¤go/rustç¨‹å¼ç¢¼</a></li><li class="chapter-item "><a href="../gdb/gdb-function-trace-to-flowchart-guide.html">GDBå‡½æ•¸èª¿ç”¨è»Œè·¡åˆ†æèˆ‡æµç¨‹åœ–ç”Ÿæˆå®Œæ•´æŒ‡å—</a></li></ol></li><li class="chapter-item expanded "><a href="../c++/cpp.html">C++</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../c++/benchmark.html">benchmark</a></li><li class="chapter-item "><a href="../c++/ä¹˜ä»¥0.01å’Œé™¤ä»¥100å“ªå€‹å¿«.html">ä¹˜ä»¥ 0.01 å’Œé™¤ä»¥ 100 å“ªå€‹å¿«</a></li><li class="chapter-item "><a href="../c++/smart_pointer.html">Smart pointer</a></li><li class="chapter-item "><a href="../c++/l&rvalue.html">L&R value</a></li><li class="chapter-item expanded "><a href="../c++/move.html" class="active">Move</a></li><li class="chapter-item "><a href="../c++/CAS.html">CAS</a></li><li class="chapter-item "><a href="../c++/HFT.html">HFT</a></li><li class="chapter-item "><a href="../c++/cpp_note.html">Note</a></li><li class="chapter-item "><a href="../c++/é«˜æ€§èƒ½ç¨‹å¼è¨­è¨ˆå¯¦æˆ°.html">é«˜æ€§èƒ½ç¨‹å¼è¨­è¨ˆå¯¦æˆ°</a></li><li class="chapter-item "><a href="../c++/å¦‚ä½•é«˜æ•ˆåœ°å„²å­˜ä¸¦æ“ä½œè¶…å¤§è¦æ¨¡.html">å¦‚ä½•é«˜æ•ˆåœ°å„²å­˜ä¸¦æ“ä½œè¶…å¤§è¦æ¨¡</a></li><li class="chapter-item "><a href="../c++/UC_CAPITAL.html">UC_CAPITAL</a></li><li class="chapter-item "><a href="../c++/cpp-smart-pointers-guide.html">unique_ptr vs shared_ptr</a></li><li class="chapter-item "><a href="../c++/cpp-move-semantics-guide.html">C++ Move èªæ„å®Œæ•´æŒ‡å—</a></li><li class="chapter-item "><a href="../c++/interview.html">interview</a></li></ol></li><li class="chapter-item expanded "><a href="../mojo/mojo.html">Mojo</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../mojo/mojo_crawler_guide.html">Mojo çˆ¬èŸ²å®Œæ•´æŒ‡å—</a></li></ol></li><li class="chapter-item expanded "><a href="../riscv/riscv.html">RISC-V</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../riscv/qemu_riscv_linux.html">QEMUä¸Šé‹è¡ŒRISV-V Linux</a></li><li class="chapter-item "><a href="../riscv/qemi_gdb.html">QEMU GDB</a></li><li class="chapter-item "><a href="../riscv/qemu_gdb_lab.html">Qemu Gdb Lab</a></li></ol></li><li class="chapter-item expanded "><a href="../centos/centos.html">CentOS</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../centos/tqdb_setup.html">TQDB å®‰è£ç´€éŒ„</a></li></ol></li><li class="chapter-item expanded "><a href="../ssh/ssh.html">SSH</a></li><li class="chapter-item expanded "><a href="../network/socket.html">Network</a></li><li class="chapter-item expanded "><a href="../docker/docker_helloworld.html">Docker</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../docker/docker.html">Docker åŸºæœ¬æ•™å­¸</a></li><li class="chapter-item "><a href="../docker/example.html">ç°¡å–®ç¯„ä¾‹</a></li><li class="chapter-item "><a href="../docker/creating-the-perfect-python-dockerfile.html">Perfect python dockerfile</a></li><li class="chapter-item "><a href="../docker/dockerfile-from-docker-image.html">ç”± Docker image åæ¨å…¶ Dockerfile</a></li><li class="chapter-item "><a href="../docker/python_connect_redis.html">Pythoné€£æ¥Redis</a></li><li class="chapter-item "><a href="../docker/command.html">Command</a></li><li class="chapter-item "><a href="../docker/docker_compose.html">Docker compose</a></li><li class="chapter-item "><a href="../docker/docker_compse_example.html">Docker compose example</a></li><li class="chapter-item "><a href="../docker/python_redis.html">Python-Redis</a></li><li class="chapter-item "><a href="../docker/redash.html">Redash</a></li><li class="chapter-item "><a href="../docker/clickhouse.html">ClickHouse</a></li><li class="chapter-item "><a href="../docker/clickhouse-setup.html">clickhouse-setup</a></li><li class="chapter-item "><a href="../docker/python_run_from_local.html">Docker run local</a></li><li class="chapter-item "><a href="../docker/redpanda.html">Redpanda</a></li><li class="chapter-item "><a href="../docker/gcc.html">é‹è¡Œæœ€æ–°ç‰ˆGCC</a></li></ol></li><li class="chapter-item expanded "><a href="../rust/rust.html">Rust</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../rust/note.html">Rustç­†è¨˜</a></li><li class="chapter-item "><a href="../rust/basic.html">Rust åŸºæœ¬æ•™å­¸</a></li><li class="chapter-item "><a href="../rust/ownership.html">Rust æ‰€æœ‰æ¬Šç³»çµ±</a></li><li class="chapter-item "><a href="../rust/lifetime.html">Rust ç”Ÿå‘½é€±æœŸ (Lifetime)</a></li><li class="chapter-item "><a href="../rust/type.html">Rust å‹åˆ¥ç³»çµ±</a></li><li class="chapter-item "><a href="../rust/rust_setup.html">Rust Tools</a></li><li class="chapter-item "><a href="../rust/polars.html">Polars</a></li><li class="chapter-item "><a href="../rust/rust_call_c.html">Rust call C</a></li><li class="chapter-item "><a href="../rust/pyo3.html">PyO3</a></li><li class="chapter-item "><a href="../rust/10-rust-an-introduction.html">çµ¦ C++ ä½¿ç”¨è€…çš„ Rust ç°¡ä»‹</a></li><li class="chapter-item "><a href="../rust/å¯è¦–åŒ–Rustå„è³‡æ–™çµæ§‹çš„è¨˜æ†¶é«”ä½ˆå±€.html">å¯è¦–åŒ–Rustå„è³‡æ–™çµæ§‹çš„è¨˜æ†¶é«”ä½ˆå±€</a></li><li class="chapter-item "><a href="../rust/rust_note.html">å­¸ç¿’é †åº</a></li><li class="chapter-item "><a href="../rust/overview.html">å¤§å±€è§€</a></li><li class="chapter-item "><a href="../rust/String.html">ç†è§£å­—ä¸²</a></li><li class="chapter-item "><a href="../rust/easy_rust.html">Easy Rust</a></li><li class="chapter-item "><a href="../rust/rust_easy.html">Rust æ–°æ‰‹</a></li><li class="chapter-item "><a href="../rust/module.html">Rust æ¨¡çµ„çµæ§‹</a></li><li class="chapter-item "><a href="../rust/rust_memory.html">Rustèˆ‡è¨˜æ†¶é«”</a></li><li class="chapter-item "><a href="../rust/rust_vs_cpp.html">Rust vs C++èªæ³•</a></li><li class="chapter-item "><a href="../rust/rust_file_format.html">Rust æª”æ¡ˆæ ¼å¼</a></li><li class="chapter-item "><a href="../rust/rust-an-introduction-in-oop.html">Rust OO</a></li><li class="chapter-item "><a href="../rust/rust-an-introduction-smart-pointer.html">Rust Pointer</a></li><li class="chapter-item "><a href="../rust/pointer.html">Pointer</a></li><li class="chapter-item "><a href="../rust/copy_trait.html">Copy Trait</a></li><li class="chapter-item "><a href="../rust/binary_lib.html">Rust å‡½æ•¸åº«/åŸ·è¡Œæª”</a></li><li class="chapter-item "><a href="../rust/reqwest.html">Reqwest</a></li><li class="chapter-item "><a href="../rust/print-function-name-dump-stack.html">å°å‡ºå‡½æ•¸åç¨±</a></li><li class="chapter-item "><a href="../rust/criterion.html">criterion</a></li><li class="chapter-item "><a href="../rust/Rustçš„ç²¾é«“.html">Rustçš„ç²¾é«“</a></li><li class="chapter-item "><a href="../rust/30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—.html">30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../rust/30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—/rust_30_day.html">Rust 30 Day</a></li><li class="chapter-item "><a href="../rust/30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—/Move_Borrow_Ownership.html">è®Šæ•¸çš„æ‰€æœ‰æ¬Šèˆ‡å€Ÿå‡ºè®Šæ•¸</a></li><li class="chapter-item "><a href="../rust/30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—/Lifetime.html">Lifetimeï¼š Borrow çš„å­˜æ´»æ™‚é–“</a></li></ol></li><li class="chapter-item "><a href="../rust/cpp_vs_rust_comparison.html">C++ vs. Rust: å…¨é¢ç‰¹æ€§æ¯”è¼ƒ</a></li><li class="chapter-item "><a href="../rust/cpp-move-vs-rust-ownership.html">C++ Move èªç¾© vs Rust æ‰€æœ‰æ¬Šç³»çµ±çš„æ ¸å¿ƒå·®ç•°</a></li><li class="chapter-item "><a href="../rust/Rust-RESTful-API-å®Œæ•´é–‹ç™¼æŒ‡å—.html">Rust-RESTful-API-å®Œæ•´é–‹ç™¼æŒ‡å—</a></li><li class="chapter-item "><a href="../rust/Rust-self-Self-èˆ‡-C++-this-å°æ¯”æŒ‡å—.html">Rust-self-Self-èˆ‡-C++-this-å°æ¯”æŒ‡å—</a></li><li class="chapter-item "><a href="../rust/rust-derive-traits-comparison.html">Rust Derive Traits æ¯”è¼ƒï¼šè‡ªå‹•ç”Ÿæˆ vs æ‰‹å‹•å¯¦ä½œ</a></li><li class="chapter-item "><a href="../rust/rust_traits_explained.html">Rust Traits ç™½è©±è§£é‡‹ï¼šèˆ‡ C++ çš„æ¯”è¼ƒ</a></li><li class="chapter-item "><a href="../rust/rust_trait_impl_markdown.html">Rust ä¸­ trait å’Œ impl çš„å·®ç•°</a></li><li class="chapter-item "><a href="../rust/rust_cpp_comparison_md.html">Rust vs C++ è©³ç´°å°æ¯”æŒ‡å—</a></li><li class="chapter-item "><a href="../rust/rust_module_system_markdown.html">Rust æ¨¡çµ„ç³»çµ±å®Œæ•´æŒ‡å—</a></li><li class="chapter-item "><a href="../rust/ownership_vs_borrowing_guide.html">Rust æ“æœ‰æ¬Š vs å€Ÿç”¨ï¼šç”Ÿå‘½é€±æœŸå•é¡ŒæŒ‡å—ğŸ¦€</a></li><li class="chapter-item "><a href="../rust/rust_ownership_guide.html">Rust æ‰€æœ‰æ¬Šç³»çµ± - ç”Ÿæ´»åŒ–è©³è§£</a></li><li class="chapter-item "><a href="../rust/rust_ownership_complete_guide.html">Rust æ‰€æœ‰æ¬Šå®Œæ•´æŒ‡å— - å¾åŸºç¤åˆ°ç²¾é€š</a></li><li class="chapter-item "><a href="../rust/rust_memory_guide.html">Rust è¨˜æ†¶é«”é…ç½®æŒ‡å—ï¼šStack vs Heap</a></li><li class="chapter-item "><a href="../rust/rust_wrappers_guide.html">Rust åŒ…è£é¡å‹ç™½è©±æŒ‡å—ğŸ“¦</a></li></ol></li><li class="chapter-item expanded "><a href="../go/go.html">Go</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../go/note.html">Golang  Note</a></li><li class="chapter-item "><a href="../go/pytago.html">pytago</a></li><li class="chapter-item "><a href="../go/Goç·¨ç¨‹å¯¦æˆ°æ´¾åŸºç¤å…¥é–€.html">Goç·¨ç¨‹å¯¦æˆ°æ´¾åŸºç¤å…¥é–€</a></li><li class="chapter-item "><a href="../go/Goç·¨ç¨‹å¯¦æˆ°æ´¾Webé–‹ç™¼åŸºç¤.html">Goç·¨ç¨‹å¯¦æˆ°æ´¾Webé–‹ç™¼åŸºç¤</a></li><li class="chapter-item "><a href="../go/golang_debugger.html">Golang Deubgger</a></li><li class="chapter-item "><a href="../go/golang-go-module-tutorial.html">å¾ä¸€çŸ¥åŠè§£åˆ°ç•¥æ‡‚ Go modules</a></li><li class="chapter-item "><a href="../go/go_mod.html">Go modules</a></li><li class="chapter-item "><a href="../go/trace.html">Golangå¤§æ®ºå™¨ä¹‹è·Ÿè¹¤å‰–ætrace</a></li><li class="chapter-item "><a href="../go/Coroutine.html">è¡Œç¨‹ã€åŸ·è¡Œç·’ã€å”ç¨‹ï¼Œå‚»å‚»åˆ†å¾—æ¸…æ¥šï¼</a></li><li class="chapter-item "><a href="../go/goroutine-and-channel.html">Goä½µç™¼</a></li><li class="chapter-item "><a href="../go/websocket.html">Websocket</a></li><li class="chapter-item "><a href="../go/returning-pointer-from-a-function-in-go.html">Returning Pointer from a Function in Go</a></li><li class="chapter-item "><a href="../go/golang-memory-management.html">GC å…¨é¢è§£æ</a></li><li class="chapter-item "><a href="../go/golang-goroutine.html">Goroutine èˆ‡ GMP åŸç†å…¨é¢åˆ†æ</a></li><li class="chapter-item "><a href="../go/oo.html">OO</a></li><li class="chapter-item "><a href="../go/mutex-rwmutex.html">sync.Mutex å’Œ sync.RWMutex</a></li><li class="chapter-item "><a href="../go/interface.html">interface</a></li><li class="chapter-item "><a href="../go/example.html">Example</a></li><li class="chapter-item "><a href="../go/LiveKit.html">LiveKit</a></li></ol></li><li class="chapter-item expanded "><a href="../ml/ml.html">ML</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../ml/pytorch.html">Pytorch</a></li><li class="chapter-item "><a href="../ml/pytorch_setup.html">Pytorch å®‰è£</a></li><li class="chapter-item "><a href="../ml/deap.html">Deap</a></li><li class="chapter-item "><a href="../ml/cudf.html">CUDF</a></li><li class="chapter-item "><a href="../ml/åˆæ¢åŸºå› æ¼”ç®—æ³•.html">åˆæ¢åŸºå› æ¼”ç®—æ³•-ç”¨ OneMax å•é¡Œç¤ºç¯„</a></li><li class="chapter-item "><a href="../ml/ç°¡å–®è§£é‡‹æ¢¯åº¦ä¸‹é™æ³•.html">ç°¡å–®è§£é‡‹æ¢¯åº¦ä¸‹é™æ³•</a></li><li class="chapter-item "><a href="../ml/æ¢¯åº¦ä¸‹é™æ³•_gradient_descent.html">æ¢¯åº¦ä¸‹é™æ³• gradient descent</a></li><li class="chapter-item "><a href="../ml/æ¢¯åº¦æœ€ä½³è§£ç›¸é—œç®—æ³•.html">æ¢¯åº¦æœ€ä½³è§£ç›¸é—œç®—æ³•</a></li><li class="chapter-item "><a href="../ml/åŸºæ–¼DEAPåº«çš„Pythoné€²åŒ–æ¼”ç®—æ³•å¾å…¥é–€åˆ°å…¥åœŸ.html">åŸºæ–¼DEAPåº«çš„Pythoné€²åŒ–æ¼”ç®—æ³•å¾å…¥é–€åˆ°å…¥åœŸ</a></li><li class="chapter-item "><a href="../ml/GA.html">GA</a></li><li class="chapter-item "><a href="../ml/XGBoost.html">XGBoost</a></li><li class="chapter-item "><a href="../ml/YOLO.html">YOLO</a></li><li class="chapter-item "><a href="../ml/yolov8æ‰‹å‹¢è­˜åˆ¥.html">YOLOv8æ‰‹å‹¢è­˜åˆ¥</a></li><li class="chapter-item "><a href="../ml/Roboflow.html">Roboflow</a></li></ol></li><li class="chapter-item expanded "><a href="../python/python.html">Python</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../python/Poetryå®Œå…¨å…¥é–€æŒ‡å—.html">Poetryå®Œå…¨å…¥é–€æŒ‡å—</a></li><li class="chapter-item "><a href="../python/æ­å»ºgRPCæœå‹™.html">æ­å»ºgRPCæœå‹™</a></li><li class="chapter-item "><a href="../python/python_debugger.html">Python Debugger</a></li><li class="chapter-item "><a href="../python/decorator.html">Python decorator</a></li><li class="chapter-item "><a href="../python/python-decorator.html">è£é£¾å™¨çœ‹é€™ä¸€ç¯‡å°±å¤ äº†</a></li><li class="chapter-item "><a href="../python/import-concept.html">import-concept</a></li><li class="chapter-item "><a href="../python/process_thread.html">Process/Threadå„ªç¼ºé»</a></li><li class="chapter-item "><a href="../python/processing_communcation.html">Processing é€šè¨Š</a></li><li class="chapter-item "><a href="../python/condition.html">Pythonä¸­çš„waitå’Œnotify</a></li><li class="chapter-item "><a href="../python/ç”Ÿç”¢è€…æ¶ˆè²»è€…æ¨¡å¼.html">ç”Ÿç”¢è€…æ¶ˆè²»è€…æ¨¡å¼</a></li><li class="chapter-item "><a href="../python/Loguru.html">Loguru</a></li><li class="chapter-item "><a href="../python/cython.html">Cython</a></li><li class="chapter-item "><a href="../python/WebSocket_reconnect.html">Python WebSocketé•·é€£æ¥å¿ƒè·³èˆ‡çŸ­é€£æ¥</a></li><li class="chapter-item "><a href="../python/bloomrpc.html">bloomrpc</a></li><li class="chapter-item "><a href="../python/concurrent.futures.html">Concurrent futures</a></li><li class="chapter-item "><a href="../python/schedule.html">ä»»å‹™èª¿åº¦</a></li><li class="chapter-item "><a href="../python/plot/plot.html">Plot</a></li><li class="chapter-item "><a href="../python/plot/dash.html">Dash</a></li><li class="chapter-item "><a href="../python/Rust_bindings_for_Python.html">Rust bindings for Python</a></li><li class="chapter-item "><a href="../python/pandas.html">Pandas</a></li><li class="chapter-item "><a href="../python/coroutine.html">Coroutine</a></li><li class="chapter-item "><a href="../python/finmind.html">FinMind</a></li><li class="chapter-item "><a href="../python/telegram_bot.html">Telegram Bot</a></li><li class="chapter-item "><a href="../python/python-different-ways-to-kill-a-thread.html">Different ways kill thread</a></li><li class="chapter-item "><a href="../python/websocket_client_server.html">Websocket client/server</a></li><li class="chapter-item "><a href="../python/poetry.html">å¾é›¶é–‹å§‹ä½¿ç”¨ Poetry</a></li><li class="chapter-item "><a href="../python/fil-memory-usage-profiler.html">Fil-memory-usage-profiler</a></li><li class="chapter-item "><a href="../python/plot.html">ç¹ªåœ–</a></li><li class="chapter-item "><a href="../python/shioaji.html">æ°¸è±shioaji</a></li><li class="chapter-item "><a href="../python/other.html">Other</a></li></ol></li><li class="chapter-item expanded "><a href="../mermaid/mermaid.html">Mermaid</a></li><li class="chapter-item expanded "><a href="../linux_system/linux_system.html">Linux System</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../linux_system/1_day_socket.html">Socket</a></li><li class="chapter-item "><a href="../linux_system/cgroup.html">Cgroup</a></li><li class="chapter-item "><a href="../linux_system/perf.html">Perf</a></li><li class="chapter-item "><a href="../linux_system/è‡ªè£½Lib.html">build Lib</a></li><li class="chapter-item "><a href="../linux_system/performance.html">performance</a></li></ol></li><li class="chapter-item expanded "><a href="../strategy/bollmaker.html">Strategy</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../strategy/é€ å¸‚/market_market.html">é€ å¸‚</a></li><li class="chapter-item "><a href="../strategy/tw_futures.html">è‡ºæŒ‡</a></li><li class="chapter-item "><a href="../strategy/arbitrage.html">å¥—åˆ©</a></li><li class="chapter-item "><a href="../strategy/é…å°äº¤æ˜“.html">é…å°äº¤æ˜“</a></li><li class="chapter-item "><a href="../strategy/æµ·é¾œäº¤æ˜“.html">æµ·é¾œäº¤æ˜“</a></li><li class="chapter-item "><a href="../strategy/è‚¡æµ·ç­‹è‚‰äºº.html">è‚¡æµ·ç­‹è‚‰äºº</a></li><li class="chapter-item "><a href="../strategy/å¦‚ä½•é¿å…éæ“¬åˆ.html">å¦‚ä½•é¿å…éæ“¬åˆ</a></li><li class="chapter-item "><a href="../strategy/å¤šç©ºæ“ä½œè¡“.html">å¤šç©ºæ“ä½œè¡“</a></li><li class="chapter-item "><a href="../strategy/è³‡é‡‘æ§ç®¡æ‰æ˜¯ç‹é“.html">è³‡é‡‘æ§ç®¡æ‰æ˜¯ç‹é“</a></li><li class="chapter-item "><a href="../strategy/00713_00675Læ­£äºŒèœˆèš£ç­–ç•¥.html">æ­£äºŒèœˆèš£ç­–ç•¥</a></li><li class="chapter-item "><a href="../strategy/è³ªæŠ¼00713+æ­£äºŒ.html">è³ªæŠ¼00713+æ­£äºŒ</a></li><li class="chapter-item "><a href="../strategy/phcebus/phcebus.html">phcebus</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../strategy/phcebus/è²å¼æ€è€ƒ.html">è²å¼æ€è€ƒ</a></li><li class="chapter-item "><a href="../strategy/phcebus/è²·è‚¡3å¿ƒæ³•.html">è²·è‚¡3å¿ƒæ³•</a></li></ol></li><li class="chapter-item "><a href="../strategy/Option/option.html">é¸æ“‡æ¬Š</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../strategy/Option/option_note.html">Option note</a></li></ol></li><li class="chapter-item "><a href="../strategy/vectorbt.html">VectorBT</a></li><li class="chapter-item "><a href="../strategy/orderbook.html">Orderbook</a></li><li class="chapter-item "><a href="../strategy/é¸è‚¡æ¢ä»¶.html">é¸è‚¡æ¢ä»¶</a></li><li class="chapter-item "><a href="../strategy/å¦‚ä½•é€²å ´.html">å¦‚ä½•é€²å ´</a></li><li class="chapter-item "><a href="../strategy/å¦‚ä½•å‡ºå ´.html">å¦‚ä½•å‡ºå ´</a></li><li class="chapter-item "><a href="../strategy/å»ºå€‰åŠ ç¢¼.html">å»ºå€‰åŠ ç¢¼</a></li><li class="chapter-item "><a href="../strategy/DT.html">ç•¶æ²–</a></li><li class="chapter-item "><a href="../strategy/ç•¶æ²–åšç©º.html">ç•¶æ²–åšç©º</a></li><li class="chapter-item "><a href="../strategy/æŠ„åº•.html">æŠ„åº•</a></li><li class="chapter-item "><a href="../strategy/éº»é“æ˜/éº»é“æ˜.html">éº»é“æ˜</a></li><li class="chapter-item "><a href="../strategy/è³ºè´å¤§ç›¤çš„å‹•èƒ½æŠ•è³‡æ³•.html">è³ºè´å¤§ç›¤çš„å‹•èƒ½æŠ•è³‡æ³•</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../strategy/éº»é“æ˜/å‡çªç ´.html">å‡çªç ´</a></li></ol></li><li class="chapter-item "><a href="../strategy/å¥‡æ­£/å¥‡æ­£.html">å¥‡æ­£</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../strategy/å¥‡æ­£/è³‡é‡‘æ§ç®¡èˆ‡è©¦å–®ç­–ç•¥.html">è³‡é‡‘æ§ç®¡èˆ‡è©¦å–®ç­–ç•¥</a></li><li class="chapter-item "><a href="../strategy/å¥‡æ­£/å¦‚ä½•å‡ºå ´.html">å¦‚ä½•å‡ºå ´</a></li></ol></li><li class="chapter-item "><a href="../strategy/ptt_stock/a0808996.html">PTT Stock</a></li><li class="chapter-item "><a href="../strategy/Book/JG.html">JG</a></li><li class="chapter-item "><a href="../strategy/bnf.html">BNF</a></li><li class="chapter-item "><a href="../strategy/cis.html">CIS</a></li><li class="chapter-item "><a href="../strategy/GA.html">GA</a></li><li class="chapter-item "><a href="../strategy/stock.html">Stock</a></li><li class="chapter-item "><a href="../strategy/note.html">Resource</a></li><li class="chapter-item "><a href="../strategy/nansen.html">Nansen</a></li><li class="chapter-item "><a href="../strategy/example.html">Example</a></li><li class="chapter-item "><a href="../strategy/other.html">Other</a></li><li class="chapter-item "><a href="../strategy/sample.html">Sample</a></li><li class="chapter-item "><a href="../strategy/shioaji.html">shioaji æ¨¡æ“¬</a></li><li class="chapter-item "><a href="../strategy/grid.html">Grid</a></li><li class="chapter-item "><a href="../strategy/pine-script.html">pine-script</a></li><li class="chapter-item "><a href="../strategy/æ‹¾äººç‰™æ…§.html">æ‹¾äººç‰™æ…§</a></li><li class="chapter-item "><a href="../strategy/sharpe_ratio.html">å¤æ™®å€¼</a></li><li class="chapter-item "><a href="../strategy/display_mae_mfe_analysis.html">MAE&MFEåˆ†æ</a></li><li class="chapter-item "><a href="../strategy/æµ·é¾œæŠ•è³‡æ³•å‰‡.html">æµ·é¾œæŠ•è³‡æ³•å‰‡</a></li><li class="chapter-item "><a href="../strategy/edge-ratio-follow-application.html">å½ˆæ€§é€²å‡ºå ´çš„åˆ¤æ–·</a></li><li class="chapter-item "><a href="../strategy/ä¸‰å¿ƒæ³•é †å‹¢æ“ä½œé™³æ—å…ƒ10å¹´è³‡ç”¢ç¿»10å€.html">ä¸‰å¿ƒæ³•é †å‹¢æ“ä½œé™³æ—å…ƒ10å¹´è³‡ç”¢ç¿»10å€</a></li><li class="chapter-item "><a href="../strategy/Jump.html">JUMP</a></li><li class="chapter-item "><a href="../strategy/å¼µæ¾å…æŠ•è³‡å¿ƒæ³•.html">å¼µå…æŠ•è³‡å¿ƒæ³•</a></li><li class="chapter-item "><a href="../strategy/vectorbt_é…å°.html">vectorbt é…å°</a></li><li class="chapter-item "><a href="../strategy/äº¤æ˜“çš„è¡Œç‚ºèˆ‡æ€ç¶­åˆ†äº«.html">äº¤æ˜“çš„è¡Œç‚ºèˆ‡æ€ç¶­åˆ†äº«</a></li><li class="chapter-item "><a href="../strategy/æŠ•è³‡æŠ•æ©Ÿçš„è§€å¿µèˆ‡å¿ƒå¾—åˆ†äº«.html">æŠ•è³‡æŠ•æ©Ÿçš„è§€å¿µèˆ‡å¿ƒå¾—åˆ†äº«</a></li><li class="chapter-item "><a href="../strategy/finlab.html">Finlab</a></li><li class="chapter-item "><a href="../strategy/backtrader/basis.html">Backtrader</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶ä¸€Backtraderä»‹ç´¹.html">Pythonå›æ¸¬æ¡†æ¶ä¸€Backtraderä»‹ç´¹</a></li><li class="chapter-item "><a href="../strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶äºŒå®šæœŸå®šé¡æŠ•è³‡.html">Python å›æ¸¬æ¡†æ¶ï¼ˆäºŒï¼‰å®šæœŸå®šé¡æŠ•è³‡</a></li><li class="chapter-item "><a href="../strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶ä¸‰æŠ€è¡“æŒ‡æ¨™.html">Python å›æ¸¬æ¡†æ¶ï¼ˆä¸‰ï¼‰æŠ€è¡“æŒ‡æ¨™</a></li><li class="chapter-item "><a href="../strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶å››CrossOverå’ŒSignal.html">Python å›æ¸¬æ¡†æ¶ï¼ˆå››ï¼‰CrossOver å’Œ Signal</a></li><li class="chapter-item "><a href="../strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶äº”Sizer.html">Python å›æ¸¬æ¡†æ¶ï¼ˆäº”ï¼‰Sizer</a></li><li class="chapter-item "><a href="../strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶å…­Analyzers.html">Python å›æ¸¬æ¡†æ¶ï¼ˆå…­ï¼‰Analyzers</a></li><li class="chapter-item "><a href="../strategy/backtrader/å¤šè‚¡çµ„åˆæ“ä½œç­–ç•¥.html">å¤šè‚¡çµ„åˆæ“ä½œ</a></li><li class="chapter-item "><a href="../strategy/backtrader/å‡ç·šäº¤å‰ç­–ç•¥.html">å‡ç·šäº¤å‰ç­–ç•¥</a></li><li class="chapter-item "><a href="../strategy/backtrader/å”å¥‡å®‰é€šé“ç­–ç•¥.html">å”å¥‡å®‰é€šé“ç­–ç•¥</a></li><li class="chapter-item "><a href="../strategy/backtrader/Sizersæ¨¡çµ„.html">Sizersæ¨¡çµ„</a></li><li class="chapter-item "><a href="../strategy/backtrader/Observersæ¨¡çµ„.html">Observersæ¨¡çµ„</a></li><li class="chapter-item "><a href="../strategy/backtrader/Pyfolio.html">Pyfolio</a></li><li class="chapter-item "><a href="../strategy/backtrader/Sample.html">Sample</a></li><li class="chapter-item "><a href="../strategy/backtrader/performance.html">Performance</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../mq/kafka.html">MQ</a></li><li class="chapter-item expanded "><a href="../mq/kafka-python.html">Kafkaçš„é€šä¿—ç¸½çµ</a></li><li class="chapter-item expanded "><a href="../database/database.html">Database</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../database/redis.html">Redis</a></li><li class="chapter-item "><a href="../database/hash.html">Redis Hash</a></li><li class="chapter-item "><a href="../database/clickhouse.html">ClickHouse</a></li><li class="chapter-item "><a href="../database/dolphin.html">Dolphin</a></li><li class="chapter-item "><a href="../database/sqlite.html">Sqlite</a></li></ol></li><li class="chapter-item expanded "><a href="../cryptotrade/cryptotrade.html">CryptoTrade</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../cryptotrade/binance/binance.html">Binance</a></li><li class="chapter-item "><a href="../cryptotrade/binance/oco.html">å¦‚ä½•å°‡OCOè¨‚å–®ç™¼é€åˆ°Binance</a></li></ol></li><li class="chapter-item expanded "><a href="../git/git.html">Git</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../git/git-remove-commited-files.html">git-remove-commited-files</a></li><li class="chapter-item "><a href="../git/cheat-sheet.html">Git å¸¸ç”¨</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_notes" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="c-stdmove"><a class="header" href="#c-stdmove">C++ std::move</a></h1>
<p>https://medium.com/@berton1679/c-std-move-133d99d87fc1</p>
<p>ä¸€é–‹å§‹æ¥è§¸c++11/14çš„äººè€Œè¨€ï¼Œçµ•å¤§å¤šæ•¸éƒ½æœƒå° <code>std::move()</code> é€™å€‹ç¥å¥‡çš„function æ‰€å›°æƒ‘ã€‚é¦–å…ˆè®“æˆ‘å€‘ç›´æ¥çœ‹ä¸€ä¸‹<a href="https://en.cppreference.com/w/cpp/utility/move">cppreference</a> ä¸­çš„ä»‹ç´¹ï¼Œ</p>
<pre><code>std::move is used to indicate that an object t may be "moved from", i.e. allowing the efficient transfer of resources from t to another object.In particular, std::move produces an xvalue expression that identifies its argument t. It is exactly equivalent to a static_cast to an rvalue reference type.
</code></pre>
<p>è€Œå…¶å¯¦ <code>std::move()</code> ä¸¦æ²’æœ‰ç§»å‹•ä»»ä½•çš„ç‰©ä»¶ï¼ŒåŸºæœ¬ä¸Šåªæ˜¯è½‰å‹è€Œå·²ï¼Œç¨‹å¼ç¢¼åŸºæœ¬ä¸Šæ˜¯å¦‚ä¸‹</p>
<pre><code>static_cast&lt;typename std::remove_reference&lt;T&gt;::type&amp;&amp;&gt;(t)
</code></pre>
<p>æ‰€ä»¥ä»–ä¸¦ä¸æ˜¯ä»€éº¼ç¥å¥‡çš„é»‘é­”æ³•ï¼Œå°±åªæ˜¯è½‰å‹!</p>
<p>è‡³æ–¼ä½¿ç”¨æ™‚æ©Ÿï¼Œæˆ‘å€‘ç”¨ä»¥ä¸‹çš„class ä½œç‚ºä¾‹å­æ–¹ä¾¿èªªæ˜</p>
<pre><code class="language-cpp">class BigObject
{
public:
    BigObject()
    {
        std::cout&lt;&lt;__PRETTY_FUNCTION__&lt;&lt;std::endl;
    }
    BigObject(int g)
    {
        std::cout&lt;&lt;__PRETTY_FUNCTION__&lt;&lt;std::endl;
        gg = g;
    }
    ~BigObject()
    {
        std::cout&lt;&lt;__PRETTY_FUNCTION__&lt;&lt;std::endl;
    }
    BigObject (const BigObject &amp;b)
    {
        std::cout&lt;&lt;__PRETTY_FUNCTION__&lt;&lt;std::endl;
    }
    BigObject (BigObject &amp;&amp;b)
    {
        std::cout&lt;&lt;__PRETTY_FUNCTION__&lt;&lt;std::endl;
        this-&gt;gg = std::move(b.gg);
    }
    int gg = 0;
};
</code></pre>
<p>è¨±å¤šäººä¸€é–‹å§‹æ¥è§¸ <code>std::move()</code> èª¤ä»¥ç‚ºå¯ä»¥å¢é€²æ•ˆèƒ½ï¼Œå› ç‚ºå¯ä»¥æ¸›å°‘copy constructor çš„æ¬¡æ•¸ï¼Œä½†é€™å…¶å¯¦ä¸ä¸€å®šæ­£ç¢ºçš„!!!!!</p>
<p>ä¾‹å¦‚</p>
<pre><code class="language-cpp">BigObject test1(int i)
{
    auto dd = BigObject();
    if (i &lt;= 0){
        dd.gg = 5;
        return dd;
    }
    dd.gg = i;
    return std::move(dd);
}
BigObject test2(int i)
{
    auto dd = BigObject();
    if (i &lt;= 0){
        dd.gg = 5;
        return dd;
    }
    dd.gg = i;
    return dd;
}int main()
{
  auto tt1 = test1(5);
  auto tt2 = test2(5);  return 0;
}
</code></pre>
<p>output å‰‡ç‚º</p>
<pre><code>BigObject::BigObject()
BigObject::BigObject(BigObject&amp;&amp;)
BigObject::~BigObject()BigObject::BigObject()
BigObject::~BigObject()
BigObject::~BigObject()
</code></pre>
<p>å¾ˆå¤šäººä»¥ç‚ºfunction return object æœƒå¤šä¸€å€‹copy constructor è€Œä½¿ç”¨ <code>std::move()</code> ï¼Œå› ç‚ºå¾ˆå¤šäººä»¥ç‚ºoverload è¼ƒä½ï¼Œä½†æ˜¯å¾ˆæ˜é¡¯çœ‹åˆ° <code>test2</code> å»æ¯” <code>test1</code> æ›´æœ‰æ•ˆç‡ï¼Œå› ç‚ºæ²’æœ‰å¤šé¤˜çš„copy/move constructorï¼Œ å› ç‚ºcompiler æœƒè‡ªå‹•åš RVO(Return Value Optimization)ï¼Œ æ‰€ä»¥åˆ‡è¨˜</p>
<p><strong>function è£¡é¢èƒ½ä½¿ç”¨RVO å°±ä½¿ç”¨RVO ä¸è¦è‡ªä½œè°æ˜ä½¿ç”¨</strong> <code>**std::move**</code></p>
<p>é‚£éº¼åˆ°åº•ä»€éº¼æ™‚å€™å¯ä»¥ä½¿ç”¨ <code>std::move</code> è®“ç¨‹å¼åŠ å¿«å‘¢?</p>
<p>å¯ä»¥åƒè€ƒä»¥ä¸‹ä¾‹å­</p>
<p><code>std::array&lt;T&gt;</code> , <code>std::vector&lt;T&gt;</code> åŸºæœ¬ä¸Šéƒ½å¯ä»¥æ”¯æ´random access çš„containerï¼Œä½†æ˜¯ <code>std::move</code> çš„å¯¦ä½œå»å·®åˆ¥å¾ˆå¤§</p>
<pre><code class="language-cpp">int main()
{
  std::vector&lt;BigObject&gt; test;
  test.resize(2);
  auto m_test = std::move(test);
  for(auto &amp;it : test)
    std::cout&lt;&lt;it.gg&lt;&lt;std::endl;
  for(auto &amp;it : m_test)
    std::cout&lt;&lt;it.gg&lt;&lt;std::endl;}
</code></pre>
<p>output</p>
<pre><code>BigObject::BigObject()
BigObject::BigObject()
0
0
BigObject::~BigObject()
BigObject::~BigObject()
</code></pre>
<p>å¯ä»¥çœ‹åˆ° <code>std::vector</code> å°æ‡‰çš„move constructor å¯ä»¥ä¸æœƒåšå¤šé¤˜çš„constructor ï¼Œä¸”åŸæœ¬çš„element éƒ½ç§»åˆ° <code>m_test</code> ä¹‹ä¸­ã€‚</p>
<p>output</p>
<pre><code>BigObject::BigObject()
BigObject::BigObject()
BigObject::BigObject(BigObject&amp;&amp;)
BigObject::BigObject(BigObject&amp;&amp;)
0
0
0
0
BigObject::~BigObject()
BigObject::~BigObject()
BigObject::~BigObject()
BigObject::~BigObject()
</code></pre>
<p>ä½†æ˜¯ <code>std::array&lt;T&gt;</code> å°æ‡‰çš„ move constructor å»æœ‰å¾ˆå¤§çš„åˆ†åˆ¥ï¼ŒåŸºæœ¬ä¸Šæ˜¯æœƒå°æ¯å€‹element éƒ½ call move constructor è€Œä¸æ˜¯å°container</p>
<p>æ‰€ä»¥åœ¨ä½¿ç”¨ <code>std::move()</code> èªæ³•çš„æ™‚å€™ï¼Œæœ€å¥½è¦çŸ¥é“åˆ°åº•ç¨‹å¼æœƒæ€éº¼è·‘ï¼Œä¸ç„¶å¾€å¾€æœƒè‡ªæˆç¨‹å¼ç¢¼çš„å¤±æ§â€¦..</p>
<p>æœ€å¾Œåˆ†äº«ä¸€ä¸‹ï¼Œæ¸›å°‘copy/move constructor æ¬¡æ•¸çš„ç¢ºå¯ä»¥å¢é€²ç¨‹å¼æ•ˆèƒ½ï¼Œä½†é€šå¸¸éƒ½æ˜¯ æ¼”ç®—æ³• &gt; ç¨‹å¼å„ªåŒ– ï¼Œæ‰€ä»¥å¾€å¾€æ¼”ç®—æ³•éƒ½æ˜¯å„ªåŒ–çš„ç¬¬ä¸€æ­¥ï¼Œä½†æ˜¯å¦‚æœåœ¨ç‰¹å®šç”¢æ¥­çš„è©±ï¼Œå°ç¨‹å¼çš„é€Ÿåº¦éå¸¸åœ¨æ„ï¼Œé‚£å„ªåŒ– c++ ç¨‹å¼é‚è¼¯çš„ç¢ºå¯ä»¥å¢é€²æ•ˆèƒ½ï¼Œå› ç‚ºç¾åœ¨ç”¢æ¥­çš„é—œä¿‚å¸¸å¸¸åšé€™é¡ä¼¼çš„å„ªåŒ–ï¼Œä¹‹å‰å°±æœ‰åˆ©ç”¨ universal reference é™ä½constructor æ¬¡æ•¸å¢é€²ç´„10%çš„æ•ˆèƒ½ã€‚</p>
<p>ç¬¬ä¸€ç¯‡å…ˆä»¥ <code>std::move()</code> é–‹é ­ï¼Œä¹‹å¾Œå¯èƒ½æœƒå¤šè¬›ä¸€ä¸‹ c++ optimization çš„å¿ƒå¾—ï¼Œé †ä¾¿ç´€éŒ„å·¥ä½œç”¨åˆ°çš„èƒ½åŠ›</p>
<hr />
<p>C++ 11å¼•é€²äº†move semanticã€‚åœ¨C++03æ™‚ï¼Œâ€temporariesâ€ or â€rvaluesâ€éƒ½è¢«è¦–ç‚ºnon-modifiableï¼Œä½†C++11å…è¨±äº†å³å€¼çš„æ”¹å‹•ï¼Œå› ç‚ºé€™æœƒæœ‰äº›æ™‚å€™ç›¸ç•¶æœ‰ç”¨ã€‚æ›´ç²¾æº–ä¾†èªªï¼š</p>
<blockquote>
<p>ç•¶å³å€¼è¢«åˆå§‹åŒ–ä¹‹å¾Œï¼Œå³å¯ä»¥è¢«æ›´æ”¹ã€‚å…¶è¨»è¨˜æ–¹å¼ç‚º T&amp;&amp;, for a type of T</p>
</blockquote>
<p>è€Œmove semanticsè¦è§£æ±ºçš„å•é¡Œæ˜¯ï¼š<strong>C++ 03ä¸­å¸¸å¸¸æœ‰ä¸å¿…è¦çš„copyï¼Œå°¤å…¶åœ¨object pass by valueçš„æ™‚å€™ã€‚</strong></p>
<p>è€Œmove semanticsæ˜¯ç‚ºäº†æå‡é€™éƒ¨åˆ†çš„æ•ˆèƒ½ã€‚</p>
<p>èˆ‰å€‹ä¾‹å­ï¼š</p>
<p>å‡è¨­ç¾åœ¨æœ‰å€‹ std::vector<T> typeï¼ˆå¯ä»¥æƒ³åƒè£¡é¢æœ‰å€‹ C-style arrayä»¥åŠå®šç¾©çš„size)ã€‚æƒ³åƒä¸€å€‹å‡½æ•¸å‰µé€ äº†é€™å€‹vectorä¸¦è¦å°‡å…¶å›å‚³ã€‚æŒ‰ç…§C++03çš„æ–¹æ³•å‰‡æ˜¯å®£å‘Šä¸€å€‹containerä¾†æ¥æ”¶ã€‚å¦‚std::vector<T> ret = f()ã€‚æ­¤æ™‚å‡½æ•¸å…§éƒ¨å‰µé€ çš„temporaryå…§å®¹æœƒè¢«å®Œæ•´è¤‡è£½ä¸€ä»½æ”¾åˆ°retï¼Œæ¥è‘—å¾è¨˜æ†¶é«”ä¸­æŠ¹å»æ‰€æœ‰temporary memoryã€‚é€™å€‹éç¨‹å¾ˆç¹ç‘£ï¼Œå› ç‚º<strong>è¤‡è£½èˆ‡åˆªå»</strong>é€™å…©å€‹æ­¥é©Ÿæ˜¯ä¸å¿…è¦çš„ã€‚</p>
<p>å†ä»”ç´°çœ‹move constructorçš„é‹ä½œæ–¹å¼ã€‚ä»Šå¤©ä¸€å€‹std::vector<T>è¦é€érvalueå½¢å¼çš„std::vector<T>ä¾†å‰µå»ºï¼Œå‰‡æœƒç™¼ç”Ÿä»¥ä¸‹æ­¥é©Ÿã€‚</p>
<ol>
<li>rvalueçš„vectorä¸­ï¼ŒC-style array pointeræœƒè¢«è¤‡è£½åˆ°destination vector<T>ä¸­ã€‚</li>
<li>åŸæœ¬rvalueçš„C-array pointeræœƒè¢«æŒ‡å‘nullã€‚</li>
<li>å› ç‚ºrvalueæ˜¯temporariesï¼Œæ¥ä¸‹ä¾†çš„contextä¹Ÿä¸æœƒå†ä½¿ç”¨åˆ°ï¼Œæ‰€ä»¥å…¶null pointerä¹Ÿä¸æœƒè¢«accessï¼ˆæ‰€ä»¥ä¸ç”¨æ“”å¿ƒout of scopeä¹‹å¾Œï¼Œå˜—è©¦å»deleteä¸€å€‹null pointerçš„memoryï¼‰ã€‚</li>
</ol>
<p>ç”±æ­¤å¯è¦‹ï¼Œé€™è£¡å®Œå…¨æ‘’æ£„äº†deep copyçš„éç¨‹ï¼Œä½†ä»æ˜¯safeçš„ç‹€æ…‹ã€‚</p>
<p>é™¤äº†move constructorçš„caseï¼Œé‚„æœ‰åœ¨function return ä¸€å€‹æ–°çš„ç‰©ä»¶çš„æ™‚å€™ï¼ˆèˆ‰ä¾‹: std::vector<T>ï¼‰ï¼Œmove semanticsä¹Ÿå¯ä»¥é¿å…å¤šé¤˜çš„deep copyã€‚å…¶åŸå› æ˜¯å‡½æ•¸å›å‚³ä¸€å€‹æ–°ç‰©ä»¶æ™‚ï¼Œå¤šäº†ä¸€æ­¥deep copyä¹Ÿæ˜¯ä¸å¿…è¦çš„ã€‚åœ¨function returnçš„é€™å€‹caseï¼Œtemporary vectoræœƒè‡ªå‹•è¢«ç•¶ä½œå³å€¼ï¼Œmove constructoræœƒimplicitly calledã€‚ï¼ˆåœ¨C++ 03ä¸­ï¼Œå¦‚æœæ²’æœ‰move constructorï¼Œå‰‡æœƒè‡ªå‹•å‘¼å«copy constructorï¼‰</p>
<p>å†ä¾†çœ‹ä¸€å€‹stackoveflowçš„ä¾‹å­ï¼Œå¹«åŠ©ç†è§£lvalue, rvalueä»¥åŠmoveã€‚</p>
<p>å‡è¨­ç¾åœ¨æœ‰å€‹string classï¼ŒåŒæ™‚ä¹Ÿå®šç¾©å…¶copy constructorå’Œdestructorã€‚</p>
<pre><code class="language-cpp">class string
{
char* datapublic:
    string(const char* p)
    {
        size_t size = std::strlen(p) + 1;
        data = new char[size];
        std::memcpy(data, p, size);
    }

    ~string()
    {
        delete[] data;
    }
}

</code></pre>
<p>æ¥è‘—æˆ‘å€‘åŸ·è¡Œä¸‰ç¨®stringçš„æ“ä½œï¼š</p>
<pre><code class="language-cpp">string a(x);
string b(x + y);
string c(// a function returning string);
</code></pre>
<p>é€™è£¡åªæœ‰ç¬¬ä¸€è¡Œçš„æ“ä½œæœƒä½¿ç”¨åˆ°deep copyã€‚é€™è£¡xä»£è¡¨çš„å°±æ˜¯stringé€™å€‹objectã€‚ä¸€å€‹å¯¦éš›å­˜åœ¨è¨˜æ†¶é«”ä¸­ï¼Œé€éxå»referenceçš„ç‰©ä»¶ã€‚é€™æˆ‘å€‘ç¨±ç‚º<strong>lvalue</strong>ã€‚</p>
<p>è€Œç¬¬äºŒèˆ‡ç¬¬ä¸‰è¡Œéƒ½æ˜¯åœ¨ç¨‹å¼åŸ·è¡Œéç¨‹ä¸­ç”¢ç”Ÿçš„temporariesã€‚æˆ‘å€‘æ²’è¾¦æ³•é€éä¸€å€‹nameå»å–å¾—x + yæˆ–å‡½æ•¸å›å‚³çš„string objectã€‚é€™ç¨±ç‚º<strong>rvalue</strong>ã€‚é€™äº›rvaluesæœƒåœ¨å…¶å­˜åœ¨çš„expressionçµæŸä¹‹å¾Œå°±è¢«destroyã€‚</p>
<p>è€Œåœ¨æ¥ä¸‹ä¾†çš„éƒ¨ä»½æˆ‘å€‘è¦åŠ å…¥move constructorã€‚æˆ‘å€‘å¯ä»¥é€érvalue reference &amp;&amp;åµæ¸¬constructorçš„argumentæ˜¯å¦ç‚ºrvalueã€‚</p>
<p>å› æ­¤æˆ‘å€‘å®šç¾©ï¼š</p>
<pre><code class="language-cpp">string(string&amp;&amp; rhs)
{
    data = rhs.data;
    rhs.data = nullptr;
}
</code></pre>
<p>åœ¨move constructorä¸­ï¼Œæˆ‘å€‘å¯ä»¥å°è¨˜æ†¶é«”é€²è¡Œä»»ä½•æ“ä½œã€‚åªè¦æœ€å¾Œå³å€¼æ˜¯åœ¨ä¸€å€‹valid stateå°±å¯ä»¥ã€‚åœ¨é€™è£¡æˆ‘å€‘å°‡rhs.dataæ”¹æˆnullptræ˜¯ç‚ºäº†é¿å…rhså‘¼å«äº†destructorï¼Œåˆªé™¤äº†è¢«ç§»å‹•çš„stringã€‚</p>
<p>ä»¥ä¸Šå¾ˆå®¹æ˜“çœ‹å‡ºä¾†ï¼Œmove constructoråšçš„äº‹æƒ…æ˜¯é€éæ”¹è®Špointerï¼ŒæŠŠsource (rhs)çš„è¨˜æ†¶é«”å…§å®¹æ¬ç§»åˆ°stringä¸­ã€‚</p>
<p>æœ€å¾Œä¾†çœ‹çœ‹assignment operatorã€‚ç•¶assignmentæ¥æ”¶çš„æ˜¯lvalueæ™‚ï¼Œå‘¼å«çš„å°±æœƒæ˜¯copy constructorï¼Œ<strong>è‹¥æ˜¯rvalueï¼Œé‚£å°±æœƒæ˜¯move constructor</strong>ã€‚å¦‚ï¼š</p>
<pre><code class="language-cpp">string c = a;
string c = a + b;
</code></pre>
<p>é€™è£¡move constructoråšçš„äº‹æƒ…åªæ˜¯æ›´æ”¹äº†pointeræŒ‡å‘çš„ä½ç½®ï¼Œè€Œsource objectåœ¨ä¹‹å¾Œä¹Ÿä¸å¯èƒ½è¢«ä½¿ç”¨è€…æ“ä½œï¼Œæ‰€ä»¥æ˜¯å€‹å®‰å…¨çš„æ“ä½œã€‚</p>
<hr />
<h1 id="ä¸€æ–‡è®€æ‡‚cå³å€¼å¼•ç”¨å’Œstdmove"><a class="header" href="#ä¸€æ–‡è®€æ‡‚cå³å€¼å¼•ç”¨å’Œstdmove">ä¸€æ–‡è®€æ‡‚C++å³å€¼å¼•ç”¨å’Œstd::move</a></h1>
<p>https://zhuanlan.zhihu.com/p/335994370?utm_id=0</p>
<p>C++11å¼•å…¥äº†å³å€¼å¼•ç”¨ï¼Œæœ‰ä¸€å®šçš„ç†è§£æˆæœ¬ï¼Œå·¥ä½œä¸­ç™¼ç¾ä¸å°‘åŒäº‹å°å³å€¼å¼•ç”¨ç†è§£ä¸æ·±ï¼Œèªç‚ºå³å€¼å¼•ç”¨æ€§èƒ½æ›´é«˜ç­‰ç­‰ã€‚æœ¬æ–‡å¾å¯¦ç”¨è§’åº¦å‡ºç™¼ï¼Œç”¨å„˜é‡é€šä¿—æ˜“æ‡‚çš„èªè¨€è¬›æ¸…å·¦å³å€¼å¼•ç”¨çš„åŸç†ï¼Œæ€§èƒ½åˆ†æåŠå…¶æ‡‰ç”¨å ´æ™¯ï¼Œå¹«åŠ©å¤§å®¶åœ¨æ—¥å¸¸ç¨‹å¼è¨­è¨ˆä¸­ç”¨å¥½å³å€¼å¼•ç”¨å’Œstd::moveã€‚</p>
<h3 id="1-ä»€éº¼æ˜¯å·¦å€¼å³å€¼"><a class="header" href="#1-ä»€éº¼æ˜¯å·¦å€¼å³å€¼"><strong>1. ä»€éº¼æ˜¯å·¦å€¼ã€å³å€¼</strong></a></h3>
<p>é¦–å…ˆä¸è€ƒæ…®å¼•ç”¨ä»¥æ¸›å°‘å¹¹æ“¾ï¼Œå¯ä»¥å¾2å€‹è§’åº¦åˆ¤æ–·ï¼šå·¦å€¼<strong>å¯ä»¥å–åœ°å€ã€ä½æ–¼ç­‰è™Ÿå·¦é‚Š</strong>ï¼›è€Œå³å€¼<strong>æ²’æ³•å–åœ°å€ï¼Œä½æ–¼ç­‰è™Ÿå³é‚Š</strong>ã€‚</p>
<pre><code class="language-cpp">int a = 5;
</code></pre>
<ul>
<li>aå¯ä»¥é€šé &amp; å–åœ°å€ï¼Œä½æ–¼ç­‰è™Ÿå·¦é‚Šï¼Œæ‰€ä»¥aæ˜¯å·¦å€¼ã€‚</li>
<li>5ä½æ–¼ç­‰è™Ÿå³é‚Šï¼Œ5æ²’æ³•é€šé &amp; å–åœ°å€ï¼Œæ‰€ä»¥5æ˜¯å€‹å³å€¼ã€‚</li>
</ul>
<p>å†èˆ‰å€‹ä¾‹å­ï¼š</p>
<pre><code class="language-cpp">struct A {
    A(int a = 0) {
        a_ = a;
    }
 
    int a_;
};
 
A a = A();
</code></pre>
<ul>
<li>åŒæ¨£çš„ï¼Œaå¯ä»¥é€šé &amp; å–åœ°å€ï¼Œä½æ–¼ç­‰è™Ÿå·¦é‚Šï¼Œæ‰€ä»¥aæ˜¯å·¦å€¼ã€‚</li>
<li>A()æ˜¯å€‹è‡¨æ™‚å€¼ï¼Œæ²’æ³•é€šé &amp; å–åœ°å€ï¼Œä½æ–¼ç­‰è™Ÿå³é‚Šï¼Œæ‰€ä»¥A()æ˜¯å€‹å³å€¼ã€‚</li>
</ul>
<p>å¯è¦‹å·¦å³å€¼çš„æ¦‚å¿µå¾ˆæ¸…æ™°ï¼Œæœ‰åœ°å€çš„è®Šæ•¸å°±æ˜¯å·¦å€¼ï¼Œæ²’æœ‰åœ°å€çš„å­—é¢å€¼ã€è‡¨æ™‚å€¼å°±æ˜¯å³å€¼ã€‚</p>
<h3 id="2-ä»€éº¼æ˜¯å·¦å€¼å¼•ç”¨å³å€¼å¼•ç”¨"><a class="header" href="#2-ä»€éº¼æ˜¯å·¦å€¼å¼•ç”¨å³å€¼å¼•ç”¨"><strong>2. ä»€éº¼æ˜¯å·¦å€¼å¼•ç”¨ã€å³å€¼å¼•ç”¨</strong></a></h3>
<p>å¼•ç”¨æœ¬è³ªæ˜¯åˆ¥åï¼Œå¯ä»¥é€šéå¼•ç”¨ä¿®æ”¹è®Šæ•¸çš„å€¼ï¼Œå‚³åƒæ™‚å‚³å¼•ç”¨å¯ä»¥é¿å…è¤‡è£½ï¼Œå…¶å¯¦ç¾åŸç†å’ŒæŒ‡é‡é¡ä¼¼ã€‚ å€‹äººèªç‚ºï¼Œå¼•ç”¨å‡ºç¾çš„æœ¬æ„æ˜¯ç‚ºäº†é™ä½Cèªè¨€æŒ‡é‡çš„ä½¿ç”¨é›£åº¦ï¼Œä½†ç¾åœ¨æŒ‡é‡+å·¦å³å€¼å¼•ç”¨å…±åŒå­˜åœ¨ï¼Œåè€Œå¤§å¤§å¢åŠ äº†å­¸ç¿’å’Œç†è§£æˆæœ¬ã€‚</p>
<h3 id="21-å·¦å€¼å¼•ç”¨"><a class="header" href="#21-å·¦å€¼å¼•ç”¨"><strong>2.1 å·¦å€¼å¼•ç”¨</strong></a></h3>
<p>å·¦å€¼å¼•ç”¨å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰ï¼Œ<strong>èƒ½æŒ‡å‘å·¦å€¼ï¼Œä¸èƒ½æŒ‡å‘å³å€¼çš„å°±æ˜¯å·¦å€¼å¼•ç”¨</strong>ï¼š</p>
<pre><code class="language-cpp">int a = 5;
int &amp;ref_a = a; // å·¦å€¼å¼•ç”¨æŒ‡å‘å·¦å€¼ï¼Œç·¨è­¯é€šé
int &amp;ref_a = 5; // å·¦å€¼å¼•ç”¨æŒ‡å‘äº†å³å€¼ï¼Œæœƒç·¨è­¯å¤±æ•—
</code></pre>
<p><strong>å¼•ç”¨æ˜¯è®Šæ•¸çš„åˆ¥åï¼Œç”±æ–¼å³å€¼æ²’æœ‰åœ°å€ï¼Œæ²’æ³•è¢«ä¿®æ”¹ï¼Œæ‰€ä»¥å·¦å€¼å¼•ç”¨ç„¡æ³•æŒ‡å‘å³å€¼ã€‚</strong></p>
<p>ä½†æ˜¯ï¼Œconstå·¦å€¼å¼•ç”¨æ˜¯å¯ä»¥æŒ‡å‘å³å€¼çš„ï¼š</p>
<pre><code class="language-cpp">const int &amp;ref_a = 5;  // ç·¨è­¯é€šé
</code></pre>
<p>constå·¦å€¼å¼•ç”¨ä¸æœƒä¿®æ”¹æŒ‡å‘å€¼ï¼Œå› æ­¤å¯ä»¥æŒ‡å‘å³å€¼ï¼Œé€™ä¹Ÿæ˜¯ç‚ºä»€éº¼è¦ä½¿ç”¨<code>const &amp;</code>ä½œç‚ºå‡½æ•¸åƒæ•¸çš„åŸå› ä¹‹ä¸€ï¼Œå¦‚<code>std::vector</code>çš„<code>push_back</code>ï¼š</p>
<pre><code class="language-cpp">void push_back (const value_type&amp; val);
</code></pre>
<p>å¦‚æœæ²’æœ‰<code>const</code>ï¼Œ<code>vec.push_back(5)</code>é€™æ¨£çš„ç¨‹å¼ç¢¼å°±ç„¡æ³•ç·¨è­¯é€šéäº†ã€‚</p>
<h3 id="22-å³å€¼å¼•ç”¨"><a class="header" href="#22-å³å€¼å¼•ç”¨"><strong>2.2 å³å€¼å¼•ç”¨</strong></a></h3>
<p>å†çœ‹ä¸‹å³å€¼å¼•ç”¨ï¼Œå³å€¼å¼•ç”¨çš„æ¨™èªŒæ˜¯<code>&amp;&amp;</code>ï¼Œé¡§åæ€ç¾©ï¼Œå³å€¼å¼•ç”¨å°ˆé–€ç‚ºå³å€¼è€Œç”Ÿï¼Œ<strong>å¯ä»¥æŒ‡å‘å³å€¼ï¼Œä¸èƒ½æŒ‡å‘å·¦å€¼</strong>ï¼š</p>
<pre><code class="language-cpp">int &amp;&amp;ref_a_right = 5; // ok
 
int a = 5;
int &amp;&amp;ref_a_left = a; // ç·¨è­¯ä¸éï¼Œå³å€¼å¼•ç”¨ä¸å¯ä»¥æŒ‡å‘å·¦å€¼
 
ref_a_right = 6; // å³å€¼å¼•ç”¨çš„ç”¨é€”ï¼šå¯ä»¥ä¿®æ”¹å³å€¼
</code></pre>
<h3 id="23-å°å·¦å³å€¼å¼•ç”¨æœ¬è³ªçš„è¨è«–"><a class="header" href="#23-å°å·¦å³å€¼å¼•ç”¨æœ¬è³ªçš„è¨è«–"><strong>2.3 å°å·¦å³å€¼å¼•ç”¨æœ¬è³ªçš„è¨è«–</strong></a></h3>
<p>ä¸‹é‚Šçš„è«–è¿°æ¯”è¼ƒè¤‡é›œï¼Œä¹Ÿæ˜¯æœ¬æ–‡çš„æ ¸å¿ƒï¼Œå°ç†è§£é€™äº›æ¦‚å¿µéå¸¸é‡è¦ã€‚</p>
<h3 id="231-å³å€¼å¼•ç”¨æœ‰è¾¦æ³•æŒ‡å‘å·¦å€¼å—"><a class="header" href="#231-å³å€¼å¼•ç”¨æœ‰è¾¦æ³•æŒ‡å‘å·¦å€¼å—"><strong>2.3.1 å³å€¼å¼•ç”¨æœ‰è¾¦æ³•æŒ‡å‘å·¦å€¼å—ï¼Ÿ</strong></a></h3>
<p>æœ‰è¾¦æ³•ï¼Œ<code>std::move</code>ï¼š</p>
<pre><code class="language-cpp">int a = 5; // aæ˜¯å€‹å·¦å€¼
int &amp;ref_a_left = a; // å·¦å€¼å¼•ç”¨æŒ‡å‘å·¦å€¼
int &amp;&amp;ref_a_right = std::move(a); // é€šéstd::moveå°‡å·¦å€¼è½‰åŒ–ç‚ºå³å€¼ï¼Œå¯ä»¥è¢«å³å€¼å¼•ç”¨æŒ‡å‘
 
cout &lt;&lt; a; // åˆ—å°çµæœï¼š5
</code></pre>
<p>åœ¨ä¸Šé‚Šçš„ç¨‹å¼ç¢¼è£¡ï¼Œçœ‹ä¸Šå»æ˜¯å·¦å€¼aé€šéstd::moveç§»å‹•åˆ°äº†å³å€¼ref_a_rightä¸­ï¼Œé‚£æ˜¯ä¸æ˜¯aè£¡é‚Šå°±æ²’æœ‰å€¼äº†ï¼Ÿä¸¦ä¸æ˜¯ï¼Œåˆ—å°å‡ºaçš„å€¼ä»ç„¶æ˜¯5ã€‚</p>
<p><code>std::move</code>æ˜¯ä¸€å€‹éå¸¸æœ‰è¿·æƒ‘æ€§çš„å‡½æ•¸ï¼Œä¸ç†è§£å·¦å³å€¼æ¦‚å¿µçš„äººå€‘å¾€å¾€ä»¥ç‚ºå®ƒèƒ½æŠŠä¸€å€‹è®Šæ•¸è£¡çš„å…§å®¹ç§»å‹•åˆ°å¦ä¸€å€‹è®Šæ•¸ï¼Œ<strong>ä½†äº‹å¯¦ä¸Šstd::moveç§»å‹•ä¸äº†ä»€éº¼ï¼Œå”¯ä¸€çš„åŠŸèƒ½æ˜¯æŠŠå·¦å€¼å¼·åˆ¶è½‰åŒ–ç‚ºå³å€¼</strong>ï¼Œè®“å³å€¼å¼•ç”¨å¯ä»¥æŒ‡å‘å·¦å€¼ã€‚å…¶å¯¦ç¾ç­‰åŒæ–¼ä¸€å€‹é¡å‹è½‰æ›ï¼š<code>static_cast&lt;T&amp;&amp;&gt;(lvalue)</code>ã€‚ æ‰€ä»¥ï¼Œ<strong>å–®ç´”çš„std::move(xxx)ä¸æœƒæœ‰æ€§èƒ½æå‡</strong>ï¼Œstd::moveçš„ä½¿ç”¨å ´æ™¯åœ¨ç¬¬ä¸‰ç« æœƒè¬›ã€‚</p>
<p>åŒæ¨£çš„ï¼Œå³å€¼å¼•ç”¨èƒ½æŒ‡å‘å³å€¼ï¼Œæœ¬è³ªä¸Šä¹Ÿæ˜¯æŠŠå³å€¼æå‡ç‚ºä¸€å€‹å·¦å€¼ï¼Œä¸¦å®šç¾©ä¸€å€‹å³å€¼å¼•ç”¨é€šéstd::moveæŒ‡å‘è©²å·¦å€¼ï¼š</p>
<pre><code class="language-cpp">int &amp;&amp;ref_a = 5;
ref_a = 6; 
 
ç­‰åŒæ–¼ä»¥ä¸‹ç¨‹å¼ç¢¼ï¼š
 
int temp = 5;
int &amp;&amp;ref_a = std::move(temp);
ref_a = 6;
</code></pre>
<h3 id="232-å·¦å€¼å¼•ç”¨å³å€¼å¼•ç”¨æœ¬èº«æ˜¯å·¦å€¼é‚„æ˜¯å³å€¼"><a class="header" href="#232-å·¦å€¼å¼•ç”¨å³å€¼å¼•ç”¨æœ¬èº«æ˜¯å·¦å€¼é‚„æ˜¯å³å€¼"><strong>2.3.2 å·¦å€¼å¼•ç”¨ã€å³å€¼å¼•ç”¨æœ¬èº«æ˜¯å·¦å€¼é‚„æ˜¯å³å€¼ï¼Ÿ</strong></a></h3>
<p><strong>è¢«è²æ˜å‡ºä¾†çš„å·¦ã€å³å€¼å¼•ç”¨éƒ½æ˜¯å·¦å€¼</strong>ã€‚ å› ç‚ºè¢«è²æ˜å‡ºçš„å·¦å³å€¼å¼•ç”¨æ˜¯æœ‰åœ°å€çš„ï¼Œä¹Ÿä½æ–¼ç­‰è™Ÿå·¦é‚Šã€‚ä»”ç´°çœ‹ä¸‹é‚Šç¨‹å¼ç¢¼ï¼š</p>
<pre><code class="language-cpp">// å½¢åƒæ˜¯å€‹å³å€¼å¼•ç”¨
void change(int&amp;&amp; right_value) {
    right_value = 8;
}
 
int main() {
    int a = 5; // aæ˜¯å€‹å·¦å€¼
    int &amp;ref_a_left = a; // ref_a_leftæ˜¯å€‹å·¦å€¼å¼•ç”¨
    int &amp;&amp;ref_a_right = std::move(a); // ref_a_rightæ˜¯å€‹å³å€¼å¼•ç”¨
 
    change(a); // ç·¨è­¯ä¸éï¼Œaæ˜¯å·¦å€¼ï¼Œchangeåƒæ•¸è¦æ±‚å³å€¼
    change(ref_a_left); // ç·¨è­¯ä¸éï¼Œå·¦å€¼å¼•ç”¨ref_a_leftæœ¬èº«ä¹Ÿæ˜¯å€‹å·¦å€¼
    change(ref_a_right); // ç·¨è­¯ä¸éï¼Œå³å€¼å¼•ç”¨ref_a_rightæœ¬èº«ä¹Ÿæ˜¯å€‹å·¦å€¼
     
    change(std::move(a)); // ç·¨è­¯é€šé
    change(std::move(ref_a_right)); // ç·¨è­¯é€šé
    change(std::move(ref_a_left)); // ç·¨è­¯é€šé
 
    change(5); // ç•¶ç„¶å¯ä»¥ç›´æ¥æ¥å³å€¼ï¼Œç·¨è­¯é€šé
     
    cout &lt;&lt; &amp;a &lt;&lt; ' ';
    cout &lt;&lt; &amp;ref_a_left &lt;&lt; ' ';
    cout &lt;&lt; &amp;ref_a_right;
    // åˆ—å°é€™ä¸‰å€‹å·¦å€¼çš„åœ°å€ï¼Œéƒ½æ˜¯ä¸€æ¨£çš„
}
</code></pre>
<p>çœ‹å®Œå¾Œä½ å¯èƒ½æœ‰å€‹å•é¡Œï¼Œstd::moveæœƒè¿”å›ä¸€å€‹å³å€¼å¼•ç”¨<code>int &amp;&amp;</code>ï¼Œå®ƒæ˜¯å·¦å€¼é‚„æ˜¯å³å€¼å‘¢ï¼Ÿ å¾è¡¨ç¤ºå¼<code>int &amp;&amp;ref = std::move(a)</code>ä¾†çœ‹ï¼Œå³å€¼å¼•ç”¨<code>ref</code>æŒ‡å‘çš„å¿…é ˆæ˜¯å³å€¼ï¼Œæ‰€ä»¥moveè¿”å›çš„<code>int &amp;&amp;</code>æ˜¯å€‹å³å€¼ã€‚æ‰€ä»¥å³å€¼å¼•ç”¨æ—¢å¯èƒ½æ˜¯å·¦å€¼ï¼Œåˆå¯èƒ½æ˜¯å³å€¼å—ï¼Ÿ ç¢ºå¯¦å¦‚æ­¤ï¼š<strong>å³å€¼å¼•ç”¨æ—¢å¯ä»¥æ˜¯å·¦å€¼ä¹Ÿå¯ä»¥æ˜¯å³å€¼ï¼Œå¦‚æœæœ‰åç¨±å‰‡ç‚ºå·¦å€¼ï¼Œå¦å‰‡æ˜¯å³å€¼</strong>ã€‚</p>
<p>æˆ–è€…èªªï¼š<strong>ä½œç‚ºå‡½æ•¸è¿”å›å€¼çš„ &amp;&amp; æ˜¯å³å€¼ï¼Œç›´æ¥è²æ˜å‡ºä¾†çš„ &amp;&amp; æ˜¯å·¦å€¼</strong>ã€‚ é€™åŒæ¨£ä¹Ÿç¬¦é—”ç¬¬ä¸€ç« å°å·¦å€¼ï¼Œå³å€¼çš„åˆ¤å®šæ–¹å¼ï¼šå…¶å¯¦å¼•ç”¨å’Œæ™®é€šè®Šæ•¸æ˜¯ä¸€æ¨£çš„ï¼Œ<code>int &amp;&amp;ref = std::move(a)</code>å’Œ <code>int a = 5</code>æ²’æœ‰ä»€éº¼å€åˆ¥ï¼Œç­‰è™Ÿå·¦é‚Šå°±æ˜¯å·¦å€¼ï¼Œå³é‚Šå°±æ˜¯å³å€¼ã€‚</p>
<p>æœ€å¾Œï¼Œå¾ä¸Šè¿°åˆ†æä¸­æˆ‘å€‘å¾—åˆ°å¦‚ä¸‹çµè«–ï¼š</p>
<ol>
<li><strong>å¾æ€§èƒ½ä¸Šè¬›ï¼Œå·¦å³å€¼å¼•ç”¨æ²’æœ‰å€åˆ¥ï¼Œå‚³åƒä½¿ç”¨å·¦å³å€¼å¼•ç”¨éƒ½å¯ä»¥é¿å…è¤‡è£½ã€‚</strong></li>
<li><strong>å³å€¼å¼•ç”¨å¯ä»¥ç›´æ¥æŒ‡å‘å³å€¼ï¼Œä¹Ÿå¯ä»¥é€šéstd::moveæŒ‡å‘å·¦å€¼ï¼›è€Œå·¦å€¼å¼•ç”¨åªèƒ½æŒ‡å‘å·¦å€¼(constå·¦å€¼å¼•ç”¨ä¹Ÿèƒ½æŒ‡å‘å³å€¼)ã€‚</strong></li>
<li><strong>ä½œç‚ºå‡½æ•¸å½¢åƒæ™‚ï¼Œå³å€¼å¼•ç”¨æ›´éˆæ´»ã€‚é›–ç„¶constå·¦å€¼å¼•ç”¨ä¹Ÿå¯ä»¥åšåˆ°å·¦å³å€¼éƒ½æ¥å—ï¼Œä½†å®ƒç„¡æ³•ä¿®æ”¹ï¼Œæœ‰ä¸€å®šä¾·é™æ€§ã€‚</strong></li>
</ol>
<pre><code class="language-cpp">void f(const int&amp; n) {
    n += 1; // ç·¨è­¯å¤±æ•—ï¼Œconstå·¦å€¼å¼•ç”¨ä¸èƒ½ä¿®æ”¹æŒ‡å‘è®Šæ•¸
}

void f2(int &amp;&amp; n) {
    n += 1; // ok
}

int main() {
    f(5);
    f2(5);
}
</code></pre>
<h3 id="3-å³å€¼å¼•ç”¨å’Œstdmoveçš„æ‡‰ç”¨å ´æ™¯"><a class="header" href="#3-å³å€¼å¼•ç”¨å’Œstdmoveçš„æ‡‰ç”¨å ´æ™¯"><strong>3. å³å€¼å¼•ç”¨å’Œstd::moveçš„æ‡‰ç”¨å ´æ™¯</strong></a></h3>
<p>æŒ‰ä¸Šæ–‡åˆ†æï¼Œ<code>std::move</code>åªæ˜¯é¡å‹è½‰æ›å·¥å…·ï¼Œä¸æœƒå°æ€§èƒ½æœ‰å¥½è™•ï¼›å³å€¼å¼•ç”¨åœ¨ä½œç‚ºå‡½æ•¸å½¢åƒæ™‚æ›´å…·éˆæ´»æ€§ï¼Œçœ‹ä¸Šå»é‚„æ˜¯æŒºé›è‚‹çš„ã€‚ä»–å€‘æœ‰ä»€éº¼å¯¦éš›æ‡‰ç”¨å ´æ™¯å—ï¼Ÿ</p>
<h3 id="31-å¯¦ç¾ç§»å‹•èªç¾©"><a class="header" href="#31-å¯¦ç¾ç§»å‹•èªç¾©"><strong>3.1 å¯¦ç¾ç§»å‹•èªç¾©</strong></a></h3>
<p>åœ¨å¯¦éš›å ´æ™¯ä¸­ï¼Œå³å€¼å¼•ç”¨å’Œstd::moveè¢«å»£æ³›ç”¨æ–¼åœ¨STLå’Œè‡ªè¨‚é¡ä¸­<strong>å¯¦ç¾ç§»å‹•èªç¾©ï¼Œé¿å…è¤‡è£½ï¼Œå¾è€Œæå‡ç¨‹åºæ€§èƒ½</strong>ã€‚ åœ¨æ²’æœ‰å³å€¼å¼•ç”¨ä¹‹å‰ï¼Œä¸€å€‹ç°¡å–®çš„é™£åˆ—é¡é€šå¸¸å¯¦ç¾å¦‚ä¸‹ï¼Œæœ‰<code>å»ºæ§‹å‡½å¼</code>ã€<code>è¤‡è£½å»ºæ§‹å‡½å¼</code>ã€<code>è³¦å€¼é‹ç®—å­å¤šè¼‰</code>ã€<code>è§£æ§‹å‡½å¼</code>ç­‰ã€‚æ·±è¤‡è£½/æ·ºè¤‡è£½åœ¨æ­¤ä¸åšè¬›è§£ã€‚</p>
<pre><code class="language-cpp">class Array {
public:
    Array(int size) : size_(size) {
        data = new int[size_];
    }
     
    // æ·±è¤‡è£½æ§‹é€ 
    Array(const Array&amp; temp_array) {
        size_ = temp_array.size_;
        data_ = new int[size_];
        for (int i = 0; i &lt; size_; i ++) {
            data_[i] = temp_array.data_[i];
        }
    }
     
    // æ·±è¤‡è£½è³¦å€¼
    Array&amp; operator=(const Array&amp; temp_array) {
        delete[] data_;
 
        size_ = temp_array.size_;
        data_ = new int[size_];
        for (int i = 0; i &lt; size_; i ++) {
            data_[i] = temp_array.data_[i];
        }
    }
 
    ~Array() {
        delete[] data_;
    }
 
public:
    int *data_;
    int size_;
};
</code></pre>
<p>è©²é¡çš„è¤‡è£½å»ºæ§‹å‡½å¼ã€è³¦å€¼é‹ç®—å­å¤šè¼‰å‡½æ•¸å·²ç¶“é€šéä½¿ç”¨å·¦å€¼å¼•ç”¨å‚³åƒä¾†é¿å…ä¸€æ¬¡å¤šé¤˜è¤‡è£½äº†ï¼Œä½†æ˜¯å…§éƒ¨å¯¦ç¾è¦æ·±è¤‡è£½ï¼Œç„¡æ³•é¿å…ã€‚ é€™æ™‚ï¼Œæœ‰äººæå‡ºä¸€å€‹æƒ³æ³•ï¼šæ˜¯ä¸æ˜¯å¯ä»¥æä¾›ä¸€å€‹<code>ç§»å‹•å»ºæ§‹å‡½å¼</code>ï¼ŒæŠŠè¢«è¤‡è£½è€…çš„è³‡æ–™ç§»å‹•éä¾†ï¼Œè¢«è¤‡è£½è€…å¾Œé‚Šå°±ä¸è¦äº†ï¼Œé€™æ¨£å°±å¯ä»¥é¿å…æ·±è¤‡è£½äº†ï¼Œå¦‚ï¼š</p>
<pre><code class="language-cpp">class Array {
public:
    Array(int size) : size_(size) {
        data = new int[size_];
    }
     
    // æ·±è¤‡è£½æ§‹é€ 
    Array(const Array&amp; temp_array) {
        ...
    }
     
    // æ·±è¤‡è£½è³¦å€¼
    Array&amp; operator=(const Array&amp; temp_array) {
        ...
    }
 
    // ç§»å‹•å»ºæ§‹å‡½å¼ï¼Œå¯ä»¥æ·ºè¤‡è£½
    Array(const Array&amp; temp_array, bool move) {
        data_ = temp_array.data_;
        size_ = temp_array.size_;
        // ç‚ºé˜²æ­¢temp_arrayææ§‹æ™‚delete dataï¼Œæå‰ç½®ç©ºå…¶data_      
        temp_array.data_ = nullptr;
    }
     
 
    ~Array() {
        delete [] data_;
    }
 
public:
    int *data_;
    int size_;
};
</code></pre>
<p>é€™éº¼åšæœ‰2å€‹å•é¡Œï¼š</p>
<ul>
<li>ä¸å„ªé›…ï¼Œè¡¨ç¤ºç§»å‹•èªç¾©é‚„éœ€è¦ä¸€å€‹é¡å¤–çš„åƒæ•¸(æˆ–è€…å…¶ä»–æ–¹å¼)ã€‚</li>
<li>ç„¡æ³•å¯¦ç¾ï¼<code>temp_array</code>æ˜¯å€‹constå·¦å€¼å¼•ç”¨ï¼Œç„¡æ³•è¢«ä¿®æ”¹ï¼Œæ‰€ä»¥<code>temp_array.data_ = nullptr;</code>é€™è¡Œæœƒç·¨è­¯ä¸éã€‚ç•¶ç„¶å‡½æ•¸åƒæ•¸å¯ä»¥æ”¹æˆéconstï¼š<code>Array(Array&amp; temp_array, bool move){...}</code>ï¼Œé€™æ¨£ä¹Ÿæœ‰å•é¡Œï¼Œç”±æ–¼å·¦å€¼å¼•ç”¨ä¸èƒ½æ¥å³å€¼ï¼Œ<code>Array a = Array(Array(), true);</code>é€™ç¨®å‘¼å«æ–¹å¼å°±æ²’æ³•ç”¨äº†ã€‚</li>
</ul>
<p>å¯ä»¥ç™¼ç¾å·¦å€¼å¼•ç”¨çœŸæ˜¯ç”¨çš„å¾ˆä¸çˆ½ï¼Œ<strong>å³å€¼å¼•ç”¨çš„å‡ºç¾è§£æ±ºäº†é€™å€‹å•é¡Œ</strong>ï¼Œåœ¨STLçš„å¾ˆå¤šå®¹å™¨ä¸­ï¼Œéƒ½å¯¦ç¾äº†ä»¥<strong>å³å€¼å¼•ç”¨ç‚ºåƒæ•¸</strong>çš„<code>ç§»å‹•å»ºæ§‹å‡½å¼</code>å’Œ<code>ç§»å‹•è³¦å€¼å¤šè¼‰å‡½æ•¸</code>ï¼Œæˆ–è€…å…¶ä»–å‡½æ•¸ï¼Œæœ€å¸¸è¦‹çš„å¦‚std::vectorçš„<code>push_back</code>å’Œ<code>emplace_back</code>ã€‚åƒæ•¸ç‚ºå·¦å€¼å¼•ç”¨æ„å‘³è‘—è¤‡è£½ï¼Œç‚ºå³å€¼å¼•ç”¨æ„å‘³è‘—ç§»å‹•ã€‚</p>
<pre><code class="language-cpp">class Array {
public:
    ......
 
    // å„ªé›…
    Array(Array&amp;&amp; temp_array) {
        data_ = temp_array.data_;
        size_ = temp_array.size_;
        // ç‚ºé˜²æ­¢temp_arrayææ§‹æ™‚delete dataï¼Œæå‰ç½®ç©ºå…¶data_      
        temp_array.data_ = nullptr;
    }
     
 
public:
    int *data_;
    int size_;
};
</code></pre>
<p>å¦‚ä½•ä½¿ç”¨ï¼š</p>
<pre><code class="language-cpp">// ä¾‹1ï¼šArrayç”¨æ³•
int main(){
    Array a;
 
    // åšä¸€äº›æ“ä½œ
    .....
     
    // å·¦å€¼aï¼Œç”¨std::moveè½‰åŒ–ç‚ºå³å€¼
    Array b(std::move(a));
}
</code></pre>
<h3 id="32-å¯¦ä¾‹vectorpush_backä½¿ç”¨stdmoveæé«˜æ€§èƒ½"><a class="header" href="#32-å¯¦ä¾‹vectorpush_backä½¿ç”¨stdmoveæé«˜æ€§èƒ½"><strong>3.2 å¯¦ä¾‹ï¼švector::push_backä½¿ç”¨std::moveæé«˜æ€§èƒ½</strong></a></h3>
<pre><code class="language-cpp">// ä¾‹2ï¼šstd::vectorå’Œstd::stringçš„å¯¦éš›ä¾‹å­
int main() {
    std::string str1 = "aacasxs";
    std::vector&lt;std::string&gt; vec;
     
    vec.push_back(str1); // å‚³çµ±æ–¹æ³•ï¼Œcopy
    vec.push_back(std::move(str1)); // å‘¼å«ç§»å‹•èªç¾©çš„push_backæ–¹æ³•ï¼Œé¿å…è¤‡è£½ï¼Œstr1æœƒå¤±å»åŸæœ‰å€¼ï¼Œè®Šæˆç©ºå­—ä¸²
    vec.emplace_back(std::move(str1)); // emplace_backæ•ˆæœç›¸åŒï¼Œstr1æœƒå¤±å»åŸæœ‰å€¼
    vec.emplace_back("axcsddcas"); // ç•¶ç„¶å¯ä»¥ç›´æ¥æ¥å³å€¼
}
 
// std::vectoræ–¹æ³•å®šç¾©
void push_back (const value_type&amp; val);
void push_back (value_type&amp;&amp; val);
 
void emplace_back (Args&amp;&amp;... args);
</code></pre>
<p>åœ¨vectorå’Œstringé€™å€‹å ´æ™¯ï¼ŒåŠ å€‹<code>std::move</code>æœƒå‘¼å«åˆ°ç§»å‹•èªç¾©å‡½æ•¸ï¼Œé¿å…äº†æ·±è¤‡è£½ã€‚</p>
<p>é™¤éè¨­è¨ˆä¸å…è¨±ç§»å‹•ï¼ŒSTLé¡å¤§éƒ½æ”¯æ´ç§»å‹•èªç¾©å‡½æ•¸ï¼Œå³<code>å¯ç§»å‹•çš„</code>ã€‚ å¦å¤–ï¼Œç·¨è­¯å™¨æœƒ<strong>é»˜èª</strong>åœ¨ä½¿ç”¨è€…è‡ªè¨‚çš„<code>class</code>å’Œ<code>struct</code>ä¸­ç”Ÿæˆç§»å‹•èªç¾©å‡½æ•¸ï¼Œä½†å‰ææ˜¯ä½¿ç”¨è€…æ²’æœ‰ä¸»å‹•å®šç¾©è©²é¡çš„<code>è¤‡è£½æ§‹é€ </code>ç­‰å‡½æ•¸(å…·é«”è¦å‰‡è‡ªè¡Œç™¾åº¦å“ˆ)ã€‚ <strong>å› æ­¤ï¼Œå¯ç§»å‹•å°åƒåœ¨&lt;éœ€è¦è¤‡è£½ä¸”è¢«è¤‡è£½è€…ä¹‹å¾Œä¸å†è¢«éœ€è¦&gt;çš„å ´æ™¯ï¼Œå»ºè­°ä½¿ç”¨</strong><code>std::move</code><strong>è§¸ç™¼ç§»å‹•èªç¾©ï¼Œæå‡æ€§èƒ½ã€‚</strong></p>
<pre><code class="language-cpp">moveable_objecta = moveable_objectb; 
æ”¹ç‚ºï¼š 
moveable_objecta = std::move(moveable_objectb);
</code></pre>
<p>é‚„æœ‰äº›STLé¡æ˜¯<code>move-only</code>çš„ï¼Œæ¯”å¦‚<code>unique_ptr</code>ï¼Œé€™ç¨®é¡åªæœ‰ç§»å‹•å»ºæ§‹å‡½å¼ï¼Œå› æ­¤åªèƒ½ç§»å‹•(è½‰ç§»å…§éƒ¨å°åƒæ‰€æœ‰æ¬Šï¼Œæˆ–è€…å«æ·ºè¤‡è£½)ï¼Œä¸èƒ½è¤‡è£½(æ·±è¤‡è£½):</p>
<pre><code class="language-cpp">std::unique_ptr&lt;A&gt; ptr_a = std::make_unique&lt;A&gt;();

std::unique_ptr&lt;A&gt; ptr_b = std::move(ptr_a); // unique_ptråªæœ‰â€˜ç§»å‹•è³¦å€¼å¤šè¼‰å‡½æ•¸â€˜ï¼Œåƒæ•¸æ˜¯&amp;&amp; ï¼Œåªèƒ½æ¥å³å€¼ï¼Œå› æ­¤å¿…é ˆç”¨std::moveè½‰æ›é¡å‹

std::unique_ptr&lt;A&gt; ptr_b = ptr_a; // ç·¨è­¯ä¸é€šé
</code></pre>
<p><strong>std::moveæœ¬èº«åªåšé¡å‹è½‰æ›ï¼Œå°æ€§èƒ½ç„¡å½±éŸ¿ã€‚</strong> <strong>æˆ‘å€‘å¯ä»¥åœ¨è‡ªå·±çš„é¡ä¸­å¯¦ç¾ç§»å‹•èªç¾©ï¼Œé¿å…æ·±è¤‡è£½ï¼Œå……åˆ†åˆ©ç”¨å³å€¼å¼•ç”¨å’Œstd::moveçš„èªè¨€ç‰¹æ€§ã€‚</strong></p>
<h3 id="4-å®Œç¾è½‰ç™¼-stdforward"><a class="header" href="#4-å®Œç¾è½‰ç™¼-stdforward"><strong>4. å®Œç¾è½‰ç™¼ std::forward</strong></a></h3>
<p>å’Œ<code>std::move</code>ä¸€æ¨£ï¼Œå®ƒçš„å…„å¼Ÿ<code>std::forward</code>ä¹Ÿå……æ»¿äº†è¿·æƒ‘æ€§ï¼Œé›–ç„¶åå­—å«ç¾©æ˜¯è½‰ç™¼ï¼Œä½†ä»–ä¸¦ä¸æœƒåšè½‰ç™¼ï¼ŒåŒæ¨£ä¹Ÿæ˜¯åšé¡å‹è½‰æ›.</p>
<p>èˆ‡moveç›¸æ¯”ï¼Œforwardæ›´å¼·å¤§ï¼Œmoveåªèƒ½è½‰å‡ºä¾†å³å€¼ï¼Œforwardéƒ½å¯ä»¥ã€‚</p>
<blockquote>
<p>std::forward<T>(u)æœ‰å…©å€‹åƒæ•¸ï¼šTèˆ‡ uã€‚ a. ç•¶Tç‚ºå·¦å€¼å¼•ç”¨é¡å‹æ™‚ï¼Œuå°‡è¢«è½‰æ›ç‚ºTé¡å‹çš„å·¦å€¼ï¼› b. å¦å‰‡uå°‡è¢«è½‰æ›ç‚ºTé¡å‹å³å€¼ã€‚</p>
</blockquote>
<p>èˆ‰å€‹ä¾‹å­ï¼Œæœ‰mainï¼ŒAï¼ŒBä¸‰å€‹å‡½æ•¸ï¼Œå‘¼å«é—œä¿‚ç‚ºï¼š<code>main-&gt;A-&gt;B</code>ï¼Œå»ºè­°å…ˆçœ‹æ‡‚<em>2.3ç¯€å°å·¦å³å€¼å¼•ç”¨æœ¬èº«æ˜¯å·¦å€¼é‚„æ˜¯å³å€¼çš„è¨è«–</em>å†çœ‹é€™è£¡ï¼š</p>
<pre><code class="language-cpp">void B(int&amp;&amp; ref_r) {
    ref_r = 1;
}
 
// Aã€Bçš„å…¥åƒæ˜¯å³å€¼å¼•ç”¨
// æœ‰åå­—çš„å³å€¼å¼•ç”¨æ˜¯å·¦å€¼ï¼Œå› æ­¤ref_ræ˜¯å·¦å€¼
void A(int&amp;&amp; ref_r) {
    B(ref_r);  // éŒ¯èª¤ï¼ŒBçš„å…¥åƒæ˜¯å³å€¼å¼•ç”¨ï¼Œéœ€è¦æ¥å³å€¼ï¼Œref_ræ˜¯å·¦å€¼ï¼Œç·¨è­¯å¤±æ•—
     
    B(std::move(ref_r)); // okï¼Œstd::moveæŠŠå·¦å€¼è½‰ç‚ºå³å€¼ï¼Œç·¨è­¯é€šé
    B(std::forward&lt;int&gt;(ref_r));  // okï¼Œstd::forwardçš„Tæ˜¯inté¡å‹ï¼Œå±¬æ–¼æ¢ä»¶bï¼Œå› æ­¤æœƒæŠŠref_rè½‰ç‚ºå³å€¼
}
 
int main() {
    int a = 5;
    A(std::move(a));
}
</code></pre>
<p>ä¾‹2ï¼š</p>
<pre><code class="language-cpp">void change2(int&amp;&amp; ref_r) {
    ref_r = 1;
}
 
void change3(int&amp; ref_l) {
    ref_l = 1;
}
 
// changeçš„å…¥åƒæ˜¯å³å€¼å¼•ç”¨
// æœ‰åå­—çš„å³å€¼å¼•ç”¨æ˜¯ å·¦å€¼ï¼Œå› æ­¤ref_ræ˜¯å·¦å€¼
void change(int&amp;&amp; ref_r) {
    change2(ref_r);  // éŒ¯èª¤ï¼Œchange2çš„å…¥åƒæ˜¯å³å€¼å¼•ç”¨ï¼Œéœ€è¦æ¥å³å€¼ï¼Œref_ræ˜¯å·¦å€¼ï¼Œç·¨è­¯å¤±æ•—
     
    change2(std::move(ref_r)); // okï¼Œstd::moveæŠŠå·¦å€¼è½‰ç‚ºå³å€¼ï¼Œç·¨è­¯é€šé
    change2(std::forward&lt;int &amp;&amp;&gt;(ref_r));  // okï¼Œstd::forwardçš„Tæ˜¯å³å€¼å¼•ç”¨é¡å‹(int &amp;&amp;)ï¼Œç¬¦åˆæ¢ä»¶bï¼Œå› æ­¤u(ref_r)æœƒè¢«è½‰æ›ç‚ºå³å€¼ï¼Œç·¨è­¯é€šé
     
    change3(ref_r); // okï¼Œchange3çš„å…¥åƒæ˜¯å·¦å€¼å¼•ç”¨ï¼Œéœ€è¦æ¥å·¦å€¼ï¼Œref_ræ˜¯å·¦å€¼ï¼Œç·¨è­¯é€šé
    change3(std::forward&lt;int &amp;&gt;(ref_r)); // okï¼Œstd::forwardçš„Tæ˜¯å·¦å€¼å¼•ç”¨é¡å‹(int &amp;)ï¼Œç¬¦åˆæ¢ä»¶aï¼Œå› æ­¤u(ref_r)æœƒè¢«è½‰æ›ç‚ºå·¦å€¼ï¼Œç·¨è­¯é€šé
    // å¯è¦‹ï¼Œforwardå¯ä»¥æŠŠå€¼è½‰æ›ç‚ºå·¦å€¼æˆ–è€…å³å€¼
}
 
int main() {
    int a = 5;
    change(std::move(a));
}
</code></pre>
<p>ä¸Šé‚Šçš„ç¤ºä¾‹åœ¨æ—¥å¸¸ç¨‹å¼è¨­è¨ˆä¸­åŸºæœ¬ä¸æœƒç”¨åˆ°ï¼Œ<code>std::forward</code>æœ€ä¸»è¦é‹æ–¼ç¯„æœ¬ç¨‹å¼è¨­è¨ˆçš„åƒæ•¸è½‰ç™¼ä¸­ï¼Œæƒ³æ·±å…¥ç­è§£éœ€è¦å­¸ç¿’<code>è¬èƒ½å¼•ç”¨(T &amp;&amp;)</code>å’Œ<code>å¼•ç”¨æ‘ºç–Š(eg:&amp; &amp;&amp; â†’ ?)</code>ç­‰çŸ¥è­˜ï¼Œæœ¬æ–‡å°±ä¸è©³ç´°ä»‹ç´¹é€™äº›äº†ã€‚</p>

                        <script src="https://utteranc.es/client.js"
                            repo="imxood/imxood.github.io"
                            issue-term="pathname"
                            theme="boxy-light"
                            crossorigin="anonymous"
                            async>
                        </script>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../c++/l&amp;rvalue.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../c++/CAS.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../c++/l&amp;rvalue.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../c++/CAS.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script type="text/javascript">
            window.playground_line_numbers = true;
        </script>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>

        <script src="../ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="../editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>

        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../theme/custom/mermaid.min.js"></script>
        <script type="text/javascript" src="../theme/custom/mermaid-init.js"></script>


    </body>
</html>
