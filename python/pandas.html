<!DOCTYPE HTML>
<html lang="zh" class="sidebar-visible no-js rust">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Pandas - Jason Notes</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/custom/custom.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html">Jason Notes</a></li><li class="chapter-item expanded "><a href="../ubuntu/ubuntu_setup.html">Ubuntu</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../ubuntu/command.html">Command</a></li><li class="chapter-item "><a href="../ubuntu/gcp.html">GCP ssh</a></li><li class="chapter-item "><a href="../ubuntu/wine.html">Wine</a></li></ol></li><li class="chapter-item expanded "><a href="../android/android.html">Android</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../android/install_sdk.html">SDK install</a></li><li class="chapter-item "><a href="../android/flutter.html">Flutter</a></li></ol></li><li class="chapter-item expanded "><a href="../tools/tools.html">Tools</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tools/asciinema.html">asciinema æŠŠçµ‚ç«¯æ“ä½œéŒ„è£½æˆ gif å‹•ç•«</a></li><li class="chapter-item "><a href="../tools/finmind.html">Finmind</a></li><li class="chapter-item "><a href="../tools/add-enter-and-exit-trace-for-your-function.html">addr2line</a></li><li class="chapter-item "><a href="../tools/cmake.html">cmake</a></li><li class="chapter-item "><a href="../tools/network.html">Network</a></li><li class="chapter-item "><a href="../tools/python-pycryptodome-aes-symmetric-encryption-tutorial-examples.html">å¯¦ä½œ AES å°ç¨±å¼åŠ å¯†</a></li></ol></li><li class="chapter-item expanded "><a href="../html/html.html">HTML</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../html/vue.html">Vue</a></li></ol></li><li class="chapter-item expanded "><a href="../vim/vim.html">Vim</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../vim/copilot.html">copilot</a></li><li class="chapter-item "><a href="../vim/tabnine.html">tabnine</a></li></ol></li><li class="chapter-item expanded "><a href="../gdb/gdb.html">Gdb</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../gdb/å¸¸ç”¨æŒ‡ä»¤.html">å¸¸ç”¨æŒ‡ä»¤</a></li><li class="chapter-item "><a href="../gdb/jemalloc.html">jemalloc</a></li><li class="chapter-item "><a href="../gdb/graphs.html">graphs</a></li><li class="chapter-item "><a href="../gdb/rust-gdb.html">rust gdb</a></li><li class="chapter-item "><a href="../gdb/qemu-gdb-risc-v64.html">qemu-gdb-risc-v64-kernel</a></li><li class="chapter-item "><a href="../gdb/go-rust-gdb-debug.html">ä½¿ç”¨gdb è¿½è¹¤go/rustç¨‹å¼ç¢¼</a></li><li class="chapter-item "><a href="../gdb/gdb-function-trace-to-flowchart-guide.html">GDBå‡½æ•¸èª¿ç”¨è»Œè·¡åˆ†æèˆ‡æµç¨‹åœ–ç”Ÿæˆå®Œæ•´æŒ‡å—</a></li></ol></li><li class="chapter-item expanded "><a href="../c++/cpp.html">C++</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../c++/benchmark.html">benchmark</a></li><li class="chapter-item "><a href="../c++/ä¹˜ä»¥0.01å’Œé™¤ä»¥100å“ªå€‹å¿«.html">ä¹˜ä»¥ 0.01 å’Œé™¤ä»¥ 100 å“ªå€‹å¿«</a></li><li class="chapter-item "><a href="../c++/smart_pointer.html">Smart pointer</a></li><li class="chapter-item "><a href="../c++/l&rvalue.html">L&R value</a></li><li class="chapter-item "><a href="../c++/move.html">Move</a></li><li class="chapter-item "><a href="../c++/CAS.html">CAS</a></li><li class="chapter-item "><a href="../c++/HFT.html">HFT</a></li><li class="chapter-item "><a href="../c++/cpp_note.html">Note</a></li><li class="chapter-item "><a href="../c++/é«˜æ€§èƒ½ç¨‹å¼è¨­è¨ˆå¯¦æˆ°.html">é«˜æ€§èƒ½ç¨‹å¼è¨­è¨ˆå¯¦æˆ°</a></li><li class="chapter-item "><a href="../c++/å¦‚ä½•é«˜æ•ˆåœ°å„²å­˜ä¸¦æ“ä½œè¶…å¤§è¦æ¨¡.html">å¦‚ä½•é«˜æ•ˆåœ°å„²å­˜ä¸¦æ“ä½œè¶…å¤§è¦æ¨¡</a></li><li class="chapter-item "><a href="../c++/UC_CAPITAL.html">UC_CAPITAL</a></li><li class="chapter-item "><a href="../c++/cpp-smart-pointers-guide.html">unique_ptr vs shared_ptr</a></li><li class="chapter-item "><a href="../c++/cpp-move-semantics-guide.html">C++ Move èªæ„å®Œæ•´æŒ‡å—</a></li><li class="chapter-item "><a href="../c++/interview.html">interview</a></li></ol></li><li class="chapter-item expanded "><a href="../mojo/mojo.html">Mojo</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../mojo/mojo_crawler_guide.html">Mojo çˆ¬èŸ²å®Œæ•´æŒ‡å—</a></li></ol></li><li class="chapter-item expanded "><a href="../riscv/riscv.html">RISC-V</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../riscv/qemu_riscv_linux.html">QEMUä¸Šé‹è¡ŒRISV-V Linux</a></li><li class="chapter-item "><a href="../riscv/qemi_gdb.html">QEMU GDB</a></li><li class="chapter-item "><a href="../riscv/qemu_gdb_lab.html">Qemu Gdb Lab</a></li></ol></li><li class="chapter-item expanded "><a href="../centos/centos.html">CentOS</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../centos/tqdb_setup.html">TQDB å®‰è£ç´€éŒ„</a></li></ol></li><li class="chapter-item expanded "><a href="../ssh/ssh.html">SSH</a></li><li class="chapter-item expanded "><a href="../network/socket.html">Network</a></li><li class="chapter-item expanded "><a href="../docker/docker_helloworld.html">Docker</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../docker/docker.html">Docker åŸºæœ¬æ•™å­¸</a></li><li class="chapter-item "><a href="../docker/example.html">ç°¡å–®ç¯„ä¾‹</a></li><li class="chapter-item "><a href="../docker/creating-the-perfect-python-dockerfile.html">Perfect python dockerfile</a></li><li class="chapter-item "><a href="../docker/dockerfile-from-docker-image.html">ç”± Docker image åæ¨å…¶ Dockerfile</a></li><li class="chapter-item "><a href="../docker/python_connect_redis.html">Pythoné€£æ¥Redis</a></li><li class="chapter-item "><a href="../docker/command.html">Command</a></li><li class="chapter-item "><a href="../docker/docker_compose.html">Docker compose</a></li><li class="chapter-item "><a href="../docker/docker_compse_example.html">Docker compose example</a></li><li class="chapter-item "><a href="../docker/python_redis.html">Python-Redis</a></li><li class="chapter-item "><a href="../docker/redash.html">Redash</a></li><li class="chapter-item "><a href="../docker/clickhouse.html">ClickHouse</a></li><li class="chapter-item "><a href="../docker/clickhouse-setup.html">clickhouse-setup</a></li><li class="chapter-item "><a href="../docker/python_run_from_local.html">Docker run local</a></li><li class="chapter-item "><a href="../docker/redpanda.html">Redpanda</a></li><li class="chapter-item "><a href="../docker/gcc.html">é‹è¡Œæœ€æ–°ç‰ˆGCC</a></li></ol></li><li class="chapter-item expanded "><a href="../rust/rust.html">Rust</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../rust/note.html">Rustç­†è¨˜</a></li><li class="chapter-item "><a href="../rust/basic.html">Rust åŸºæœ¬æ•™å­¸</a></li><li class="chapter-item "><a href="../rust/ownership.html">Rust æ‰€æœ‰æ¬Šç³»çµ±</a></li><li class="chapter-item "><a href="../rust/lifetime.html">Rust ç”Ÿå‘½é€±æœŸ (Lifetime)</a></li><li class="chapter-item "><a href="../rust/type.html">Rust å‹åˆ¥ç³»çµ±</a></li><li class="chapter-item "><a href="../rust/rust_setup.html">Rust Tools</a></li><li class="chapter-item "><a href="../rust/polars.html">Polars</a></li><li class="chapter-item "><a href="../rust/rust_call_c.html">Rust call C</a></li><li class="chapter-item "><a href="../rust/pyo3.html">PyO3</a></li><li class="chapter-item "><a href="../rust/10-rust-an-introduction.html">çµ¦ C++ ä½¿ç”¨è€…çš„ Rust ç°¡ä»‹</a></li><li class="chapter-item "><a href="../rust/å¯è¦–åŒ–Rustå„è³‡æ–™çµæ§‹çš„è¨˜æ†¶é«”ä½ˆå±€.html">å¯è¦–åŒ–Rustå„è³‡æ–™çµæ§‹çš„è¨˜æ†¶é«”ä½ˆå±€</a></li><li class="chapter-item "><a href="../rust/rust_note.html">å­¸ç¿’é †åº</a></li><li class="chapter-item "><a href="../rust/overview.html">å¤§å±€è§€</a></li><li class="chapter-item "><a href="../rust/String.html">ç†è§£å­—ä¸²</a></li><li class="chapter-item "><a href="../rust/easy_rust.html">Easy Rust</a></li><li class="chapter-item "><a href="../rust/rust_easy.html">Rust æ–°æ‰‹</a></li><li class="chapter-item "><a href="../rust/module.html">Rust æ¨¡çµ„çµæ§‹</a></li><li class="chapter-item "><a href="../rust/rust_memory.html">Rustèˆ‡è¨˜æ†¶é«”</a></li><li class="chapter-item "><a href="../rust/rust_vs_cpp.html">Rust vs C++èªæ³•</a></li><li class="chapter-item "><a href="../rust/rust_file_format.html">Rust æª”æ¡ˆæ ¼å¼</a></li><li class="chapter-item "><a href="../rust/rust-an-introduction-in-oop.html">Rust OO</a></li><li class="chapter-item "><a href="../rust/rust-an-introduction-smart-pointer.html">Rust Pointer</a></li><li class="chapter-item "><a href="../rust/pointer.html">Pointer</a></li><li class="chapter-item "><a href="../rust/copy_trait.html">Copy Trait</a></li><li class="chapter-item "><a href="../rust/binary_lib.html">Rust å‡½æ•¸åº«/åŸ·è¡Œæª”</a></li><li class="chapter-item "><a href="../rust/reqwest.html">Reqwest</a></li><li class="chapter-item "><a href="../rust/print-function-name-dump-stack.html">å°å‡ºå‡½æ•¸åç¨±</a></li><li class="chapter-item "><a href="../rust/criterion.html">criterion</a></li><li class="chapter-item "><a href="../rust/Rustçš„ç²¾é«“.html">Rustçš„ç²¾é«“</a></li><li class="chapter-item "><a href="../rust/30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—.html">30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../rust/30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—/rust_30_day.html">Rust 30 Day</a></li><li class="chapter-item "><a href="../rust/30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—/Move_Borrow_Ownership.html">è®Šæ•¸çš„æ‰€æœ‰æ¬Šèˆ‡å€Ÿå‡ºè®Šæ•¸</a></li><li class="chapter-item "><a href="../rust/30å¤©æ·±å…¥æ·ºå‡ºRustç³»åˆ—/Lifetime.html">Lifetimeï¼š Borrow çš„å­˜æ´»æ™‚é–“</a></li></ol></li><li class="chapter-item "><a href="../rust/cpp_vs_rust_comparison.html">C++ vs. Rust: å…¨é¢ç‰¹æ€§æ¯”è¼ƒ</a></li><li class="chapter-item "><a href="../rust/cpp-move-vs-rust-ownership.html">C++ Move èªç¾© vs Rust æ‰€æœ‰æ¬Šç³»çµ±çš„æ ¸å¿ƒå·®ç•°</a></li><li class="chapter-item "><a href="../rust/Rust-RESTful-API-å®Œæ•´é–‹ç™¼æŒ‡å—.html">Rust-RESTful-API-å®Œæ•´é–‹ç™¼æŒ‡å—</a></li><li class="chapter-item "><a href="../rust/Rust-self-Self-èˆ‡-C++-this-å°æ¯”æŒ‡å—.html">Rust-self-Self-èˆ‡-C++-this-å°æ¯”æŒ‡å—</a></li><li class="chapter-item "><a href="../rust/rust-derive-traits-comparison.html">Rust Derive Traits æ¯”è¼ƒï¼šè‡ªå‹•ç”Ÿæˆ vs æ‰‹å‹•å¯¦ä½œ</a></li><li class="chapter-item "><a href="../rust/rust_traits_explained.html">Rust Traits ç™½è©±è§£é‡‹ï¼šèˆ‡ C++ çš„æ¯”è¼ƒ</a></li><li class="chapter-item "><a href="../rust/rust_trait_impl_markdown.html">Rust ä¸­ trait å’Œ impl çš„å·®ç•°</a></li><li class="chapter-item "><a href="../rust/rust_cpp_comparison_md.html">Rust vs C++ è©³ç´°å°æ¯”æŒ‡å—</a></li><li class="chapter-item "><a href="../rust/rust_module_system_markdown.html">Rust æ¨¡çµ„ç³»çµ±å®Œæ•´æŒ‡å—</a></li><li class="chapter-item "><a href="../rust/ownership_vs_borrowing_guide.html">Rust æ“æœ‰æ¬Š vs å€Ÿç”¨ï¼šç”Ÿå‘½é€±æœŸå•é¡ŒæŒ‡å—ğŸ¦€</a></li><li class="chapter-item "><a href="../rust/rust_ownership_guide.html">Rust æ‰€æœ‰æ¬Šç³»çµ± - ç”Ÿæ´»åŒ–è©³è§£</a></li><li class="chapter-item "><a href="../rust/rust_ownership_complete_guide.html">Rust æ‰€æœ‰æ¬Šå®Œæ•´æŒ‡å— - å¾åŸºç¤åˆ°ç²¾é€š</a></li><li class="chapter-item "><a href="../rust/rust_memory_guide.html">Rust è¨˜æ†¶é«”é…ç½®æŒ‡å—ï¼šStack vs Heap</a></li><li class="chapter-item "><a href="../rust/rust_wrappers_guide.html">Rust åŒ…è£é¡å‹ç™½è©±æŒ‡å—ğŸ“¦</a></li></ol></li><li class="chapter-item expanded "><a href="../go/go.html">Go</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../go/note.html">Golang  Note</a></li><li class="chapter-item "><a href="../go/pytago.html">pytago</a></li><li class="chapter-item "><a href="../go/Goç·¨ç¨‹å¯¦æˆ°æ´¾åŸºç¤å…¥é–€.html">Goç·¨ç¨‹å¯¦æˆ°æ´¾åŸºç¤å…¥é–€</a></li><li class="chapter-item "><a href="../go/Goç·¨ç¨‹å¯¦æˆ°æ´¾Webé–‹ç™¼åŸºç¤.html">Goç·¨ç¨‹å¯¦æˆ°æ´¾Webé–‹ç™¼åŸºç¤</a></li><li class="chapter-item "><a href="../go/golang_debugger.html">Golang Deubgger</a></li><li class="chapter-item "><a href="../go/golang-go-module-tutorial.html">å¾ä¸€çŸ¥åŠè§£åˆ°ç•¥æ‡‚ Go modules</a></li><li class="chapter-item "><a href="../go/go_mod.html">Go modules</a></li><li class="chapter-item "><a href="../go/trace.html">Golangå¤§æ®ºå™¨ä¹‹è·Ÿè¹¤å‰–ætrace</a></li><li class="chapter-item "><a href="../go/Coroutine.html">è¡Œç¨‹ã€åŸ·è¡Œç·’ã€å”ç¨‹ï¼Œå‚»å‚»åˆ†å¾—æ¸…æ¥šï¼</a></li><li class="chapter-item "><a href="../go/goroutine-and-channel.html">Goä½µç™¼</a></li><li class="chapter-item "><a href="../go/websocket.html">Websocket</a></li><li class="chapter-item "><a href="../go/returning-pointer-from-a-function-in-go.html">Returning Pointer from a Function in Go</a></li><li class="chapter-item "><a href="../go/golang-memory-management.html">GC å…¨é¢è§£æ</a></li><li class="chapter-item "><a href="../go/golang-goroutine.html">Goroutine èˆ‡ GMP åŸç†å…¨é¢åˆ†æ</a></li><li class="chapter-item "><a href="../go/oo.html">OO</a></li><li class="chapter-item "><a href="../go/mutex-rwmutex.html">sync.Mutex å’Œ sync.RWMutex</a></li><li class="chapter-item "><a href="../go/interface.html">interface</a></li><li class="chapter-item "><a href="../go/example.html">Example</a></li><li class="chapter-item "><a href="../go/LiveKit.html">LiveKit</a></li></ol></li><li class="chapter-item expanded "><a href="../ml/ml.html">ML</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../ml/pytorch.html">Pytorch</a></li><li class="chapter-item "><a href="../ml/pytorch_setup.html">Pytorch å®‰è£</a></li><li class="chapter-item "><a href="../ml/deap.html">Deap</a></li><li class="chapter-item "><a href="../ml/cudf.html">CUDF</a></li><li class="chapter-item "><a href="../ml/åˆæ¢åŸºå› æ¼”ç®—æ³•.html">åˆæ¢åŸºå› æ¼”ç®—æ³•-ç”¨ OneMax å•é¡Œç¤ºç¯„</a></li><li class="chapter-item "><a href="../ml/ç°¡å–®è§£é‡‹æ¢¯åº¦ä¸‹é™æ³•.html">ç°¡å–®è§£é‡‹æ¢¯åº¦ä¸‹é™æ³•</a></li><li class="chapter-item "><a href="../ml/æ¢¯åº¦ä¸‹é™æ³•_gradient_descent.html">æ¢¯åº¦ä¸‹é™æ³• gradient descent</a></li><li class="chapter-item "><a href="../ml/æ¢¯åº¦æœ€ä½³è§£ç›¸é—œç®—æ³•.html">æ¢¯åº¦æœ€ä½³è§£ç›¸é—œç®—æ³•</a></li><li class="chapter-item "><a href="../ml/åŸºæ–¼DEAPåº«çš„Pythoné€²åŒ–æ¼”ç®—æ³•å¾å…¥é–€åˆ°å…¥åœŸ.html">åŸºæ–¼DEAPåº«çš„Pythoné€²åŒ–æ¼”ç®—æ³•å¾å…¥é–€åˆ°å…¥åœŸ</a></li><li class="chapter-item "><a href="../ml/GA.html">GA</a></li><li class="chapter-item "><a href="../ml/XGBoost.html">XGBoost</a></li><li class="chapter-item "><a href="../ml/YOLO.html">YOLO</a></li><li class="chapter-item "><a href="../ml/yolov8æ‰‹å‹¢è­˜åˆ¥.html">YOLOv8æ‰‹å‹¢è­˜åˆ¥</a></li><li class="chapter-item "><a href="../ml/Roboflow.html">Roboflow</a></li></ol></li><li class="chapter-item expanded "><a href="../python/python.html">Python</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../python/Poetryå®Œå…¨å…¥é–€æŒ‡å—.html">Poetryå®Œå…¨å…¥é–€æŒ‡å—</a></li><li class="chapter-item "><a href="../python/æ­å»ºgRPCæœå‹™.html">æ­å»ºgRPCæœå‹™</a></li><li class="chapter-item "><a href="../python/python_debugger.html">Python Debugger</a></li><li class="chapter-item "><a href="../python/decorator.html">Python decorator</a></li><li class="chapter-item "><a href="../python/python-decorator.html">è£é£¾å™¨çœ‹é€™ä¸€ç¯‡å°±å¤ äº†</a></li><li class="chapter-item "><a href="../python/import-concept.html">import-concept</a></li><li class="chapter-item "><a href="../python/process_thread.html">Process/Threadå„ªç¼ºé»</a></li><li class="chapter-item "><a href="../python/processing_communcation.html">Processing é€šè¨Š</a></li><li class="chapter-item "><a href="../python/condition.html">Pythonä¸­çš„waitå’Œnotify</a></li><li class="chapter-item "><a href="../python/ç”Ÿç”¢è€…æ¶ˆè²»è€…æ¨¡å¼.html">ç”Ÿç”¢è€…æ¶ˆè²»è€…æ¨¡å¼</a></li><li class="chapter-item "><a href="../python/Loguru.html">Loguru</a></li><li class="chapter-item "><a href="../python/cython.html">Cython</a></li><li class="chapter-item "><a href="../python/WebSocket_reconnect.html">Python WebSocketé•·é€£æ¥å¿ƒè·³èˆ‡çŸ­é€£æ¥</a></li><li class="chapter-item "><a href="../python/bloomrpc.html">bloomrpc</a></li><li class="chapter-item "><a href="../python/concurrent.futures.html">Concurrent futures</a></li><li class="chapter-item "><a href="../python/schedule.html">ä»»å‹™èª¿åº¦</a></li><li class="chapter-item "><a href="../python/plot/plot.html">Plot</a></li><li class="chapter-item "><a href="../python/plot/dash.html">Dash</a></li><li class="chapter-item "><a href="../python/Rust_bindings_for_Python.html">Rust bindings for Python</a></li><li class="chapter-item expanded "><a href="../python/pandas.html" class="active">Pandas</a></li><li class="chapter-item "><a href="../python/coroutine.html">Coroutine</a></li><li class="chapter-item "><a href="../python/finmind.html">FinMind</a></li><li class="chapter-item "><a href="../python/telegram_bot.html">Telegram Bot</a></li><li class="chapter-item "><a href="../python/python-different-ways-to-kill-a-thread.html">Different ways kill thread</a></li><li class="chapter-item "><a href="../python/websocket_client_server.html">Websocket client/server</a></li><li class="chapter-item "><a href="../python/poetry.html">å¾é›¶é–‹å§‹ä½¿ç”¨ Poetry</a></li><li class="chapter-item "><a href="../python/fil-memory-usage-profiler.html">Fil-memory-usage-profiler</a></li><li class="chapter-item "><a href="../python/plot.html">ç¹ªåœ–</a></li><li class="chapter-item "><a href="../python/shioaji.html">æ°¸è±shioaji</a></li><li class="chapter-item "><a href="../python/other.html">Other</a></li></ol></li><li class="chapter-item expanded "><a href="../mermaid/mermaid.html">Mermaid</a></li><li class="chapter-item expanded "><a href="../linux_system/linux_system.html">Linux System</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../linux_system/1_day_socket.html">Socket</a></li><li class="chapter-item "><a href="../linux_system/cgroup.html">Cgroup</a></li><li class="chapter-item "><a href="../linux_system/perf.html">Perf</a></li><li class="chapter-item "><a href="../linux_system/è‡ªè£½Lib.html">build Lib</a></li><li class="chapter-item "><a href="../linux_system/performance.html">performance</a></li></ol></li><li class="chapter-item expanded "><a href="../strategy/bollmaker.html">Strategy</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../strategy/é€ å¸‚/market_market.html">é€ å¸‚</a></li><li class="chapter-item "><a href="../strategy/tw_futures.html">è‡ºæŒ‡</a></li><li class="chapter-item "><a href="../strategy/arbitrage.html">å¥—åˆ©</a></li><li class="chapter-item "><a href="../strategy/é…å°äº¤æ˜“.html">é…å°äº¤æ˜“</a></li><li class="chapter-item "><a href="../strategy/æµ·é¾œäº¤æ˜“.html">æµ·é¾œäº¤æ˜“</a></li><li class="chapter-item "><a href="../strategy/è‚¡æµ·ç­‹è‚‰äºº.html">è‚¡æµ·ç­‹è‚‰äºº</a></li><li class="chapter-item "><a href="../strategy/å¦‚ä½•é¿å…éæ“¬åˆ.html">å¦‚ä½•é¿å…éæ“¬åˆ</a></li><li class="chapter-item "><a href="../strategy/å¤šç©ºæ“ä½œè¡“.html">å¤šç©ºæ“ä½œè¡“</a></li><li class="chapter-item "><a href="../strategy/è³‡é‡‘æ§ç®¡æ‰æ˜¯ç‹é“.html">è³‡é‡‘æ§ç®¡æ‰æ˜¯ç‹é“</a></li><li class="chapter-item "><a href="../strategy/00713_00675Læ­£äºŒèœˆèš£ç­–ç•¥.html">æ­£äºŒèœˆèš£ç­–ç•¥</a></li><li class="chapter-item "><a href="../strategy/è³ªæŠ¼00713+æ­£äºŒ.html">è³ªæŠ¼00713+æ­£äºŒ</a></li><li class="chapter-item "><a href="../strategy/phcebus/phcebus.html">phcebus</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../strategy/phcebus/è²å¼æ€è€ƒ.html">è²å¼æ€è€ƒ</a></li><li class="chapter-item "><a href="../strategy/phcebus/è²·è‚¡3å¿ƒæ³•.html">è²·è‚¡3å¿ƒæ³•</a></li></ol></li><li class="chapter-item "><a href="../strategy/Option/option.html">é¸æ“‡æ¬Š</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../strategy/Option/option_note.html">Option note</a></li></ol></li><li class="chapter-item "><a href="../strategy/vectorbt.html">VectorBT</a></li><li class="chapter-item "><a href="../strategy/orderbook.html">Orderbook</a></li><li class="chapter-item "><a href="../strategy/é¸è‚¡æ¢ä»¶.html">é¸è‚¡æ¢ä»¶</a></li><li class="chapter-item "><a href="../strategy/å¦‚ä½•é€²å ´.html">å¦‚ä½•é€²å ´</a></li><li class="chapter-item "><a href="../strategy/å¦‚ä½•å‡ºå ´.html">å¦‚ä½•å‡ºå ´</a></li><li class="chapter-item "><a href="../strategy/å»ºå€‰åŠ ç¢¼.html">å»ºå€‰åŠ ç¢¼</a></li><li class="chapter-item "><a href="../strategy/DT.html">ç•¶æ²–</a></li><li class="chapter-item "><a href="../strategy/ç•¶æ²–åšç©º.html">ç•¶æ²–åšç©º</a></li><li class="chapter-item "><a href="../strategy/æŠ„åº•.html">æŠ„åº•</a></li><li class="chapter-item "><a href="../strategy/éº»é“æ˜/éº»é“æ˜.html">éº»é“æ˜</a></li><li class="chapter-item "><a href="../strategy/è³ºè´å¤§ç›¤çš„å‹•èƒ½æŠ•è³‡æ³•.html">è³ºè´å¤§ç›¤çš„å‹•èƒ½æŠ•è³‡æ³•</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../strategy/éº»é“æ˜/å‡çªç ´.html">å‡çªç ´</a></li></ol></li><li class="chapter-item "><a href="../strategy/å¥‡æ­£/å¥‡æ­£.html">å¥‡æ­£</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../strategy/å¥‡æ­£/è³‡é‡‘æ§ç®¡èˆ‡è©¦å–®ç­–ç•¥.html">è³‡é‡‘æ§ç®¡èˆ‡è©¦å–®ç­–ç•¥</a></li><li class="chapter-item "><a href="../strategy/å¥‡æ­£/å¦‚ä½•å‡ºå ´.html">å¦‚ä½•å‡ºå ´</a></li></ol></li><li class="chapter-item "><a href="../strategy/ptt_stock/a0808996.html">PTT Stock</a></li><li class="chapter-item "><a href="../strategy/Book/JG.html">JG</a></li><li class="chapter-item "><a href="../strategy/bnf.html">BNF</a></li><li class="chapter-item "><a href="../strategy/cis.html">CIS</a></li><li class="chapter-item "><a href="../strategy/GA.html">GA</a></li><li class="chapter-item "><a href="../strategy/stock.html">Stock</a></li><li class="chapter-item "><a href="../strategy/note.html">Resource</a></li><li class="chapter-item "><a href="../strategy/nansen.html">Nansen</a></li><li class="chapter-item "><a href="../strategy/example.html">Example</a></li><li class="chapter-item "><a href="../strategy/other.html">Other</a></li><li class="chapter-item "><a href="../strategy/sample.html">Sample</a></li><li class="chapter-item "><a href="../strategy/shioaji.html">shioaji æ¨¡æ“¬</a></li><li class="chapter-item "><a href="../strategy/grid.html">Grid</a></li><li class="chapter-item "><a href="../strategy/pine-script.html">pine-script</a></li><li class="chapter-item "><a href="../strategy/æ‹¾äººç‰™æ…§.html">æ‹¾äººç‰™æ…§</a></li><li class="chapter-item "><a href="../strategy/sharpe_ratio.html">å¤æ™®å€¼</a></li><li class="chapter-item "><a href="../strategy/display_mae_mfe_analysis.html">MAE&MFEåˆ†æ</a></li><li class="chapter-item "><a href="../strategy/æµ·é¾œæŠ•è³‡æ³•å‰‡.html">æµ·é¾œæŠ•è³‡æ³•å‰‡</a></li><li class="chapter-item "><a href="../strategy/edge-ratio-follow-application.html">å½ˆæ€§é€²å‡ºå ´çš„åˆ¤æ–·</a></li><li class="chapter-item "><a href="../strategy/ä¸‰å¿ƒæ³•é †å‹¢æ“ä½œé™³æ—å…ƒ10å¹´è³‡ç”¢ç¿»10å€.html">ä¸‰å¿ƒæ³•é †å‹¢æ“ä½œé™³æ—å…ƒ10å¹´è³‡ç”¢ç¿»10å€</a></li><li class="chapter-item "><a href="../strategy/Jump.html">JUMP</a></li><li class="chapter-item "><a href="../strategy/å¼µæ¾å…æŠ•è³‡å¿ƒæ³•.html">å¼µå…æŠ•è³‡å¿ƒæ³•</a></li><li class="chapter-item "><a href="../strategy/vectorbt_é…å°.html">vectorbt é…å°</a></li><li class="chapter-item "><a href="../strategy/äº¤æ˜“çš„è¡Œç‚ºèˆ‡æ€ç¶­åˆ†äº«.html">äº¤æ˜“çš„è¡Œç‚ºèˆ‡æ€ç¶­åˆ†äº«</a></li><li class="chapter-item "><a href="../strategy/æŠ•è³‡æŠ•æ©Ÿçš„è§€å¿µèˆ‡å¿ƒå¾—åˆ†äº«.html">æŠ•è³‡æŠ•æ©Ÿçš„è§€å¿µèˆ‡å¿ƒå¾—åˆ†äº«</a></li><li class="chapter-item "><a href="../strategy/finlab.html">Finlab</a></li><li class="chapter-item "><a href="../strategy/backtrader/basis.html">Backtrader</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶ä¸€Backtraderä»‹ç´¹.html">Pythonå›æ¸¬æ¡†æ¶ä¸€Backtraderä»‹ç´¹</a></li><li class="chapter-item "><a href="../strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶äºŒå®šæœŸå®šé¡æŠ•è³‡.html">Python å›æ¸¬æ¡†æ¶ï¼ˆäºŒï¼‰å®šæœŸå®šé¡æŠ•è³‡</a></li><li class="chapter-item "><a href="../strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶ä¸‰æŠ€è¡“æŒ‡æ¨™.html">Python å›æ¸¬æ¡†æ¶ï¼ˆä¸‰ï¼‰æŠ€è¡“æŒ‡æ¨™</a></li><li class="chapter-item "><a href="../strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶å››CrossOverå’ŒSignal.html">Python å›æ¸¬æ¡†æ¶ï¼ˆå››ï¼‰CrossOver å’Œ Signal</a></li><li class="chapter-item "><a href="../strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶äº”Sizer.html">Python å›æ¸¬æ¡†æ¶ï¼ˆäº”ï¼‰Sizer</a></li><li class="chapter-item "><a href="../strategy/backtrader/Pythonå›æ¸¬æ¡†æ¶å…­Analyzers.html">Python å›æ¸¬æ¡†æ¶ï¼ˆå…­ï¼‰Analyzers</a></li><li class="chapter-item "><a href="../strategy/backtrader/å¤šè‚¡çµ„åˆæ“ä½œç­–ç•¥.html">å¤šè‚¡çµ„åˆæ“ä½œ</a></li><li class="chapter-item "><a href="../strategy/backtrader/å‡ç·šäº¤å‰ç­–ç•¥.html">å‡ç·šäº¤å‰ç­–ç•¥</a></li><li class="chapter-item "><a href="../strategy/backtrader/å”å¥‡å®‰é€šé“ç­–ç•¥.html">å”å¥‡å®‰é€šé“ç­–ç•¥</a></li><li class="chapter-item "><a href="../strategy/backtrader/Sizersæ¨¡çµ„.html">Sizersæ¨¡çµ„</a></li><li class="chapter-item "><a href="../strategy/backtrader/Observersæ¨¡çµ„.html">Observersæ¨¡çµ„</a></li><li class="chapter-item "><a href="../strategy/backtrader/Pyfolio.html">Pyfolio</a></li><li class="chapter-item "><a href="../strategy/backtrader/Sample.html">Sample</a></li><li class="chapter-item "><a href="../strategy/backtrader/performance.html">Performance</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../mq/kafka.html">MQ</a></li><li class="chapter-item expanded "><a href="../mq/kafka-python.html">Kafkaçš„é€šä¿—ç¸½çµ</a></li><li class="chapter-item expanded "><a href="../database/database.html">Database</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../database/redis.html">Redis</a></li><li class="chapter-item "><a href="../database/hash.html">Redis Hash</a></li><li class="chapter-item "><a href="../database/clickhouse.html">ClickHouse</a></li><li class="chapter-item "><a href="../database/dolphin.html">Dolphin</a></li><li class="chapter-item "><a href="../database/sqlite.html">Sqlite</a></li></ol></li><li class="chapter-item expanded "><a href="../cryptotrade/cryptotrade.html">CryptoTrade</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../cryptotrade/binance/binance.html">Binance</a></li><li class="chapter-item "><a href="../cryptotrade/binance/oco.html">å¦‚ä½•å°‡OCOè¨‚å–®ç™¼é€åˆ°Binance</a></li></ol></li><li class="chapter-item expanded "><a href="../git/git.html">Git</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../git/git-remove-commited-files.html">git-remove-commited-files</a></li><li class="chapter-item "><a href="../git/cheat-sheet.html">Git å¸¸ç”¨</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Jason Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/shihyu/jason_notes" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="dataframe-æˆ-pickle-å¾Œå¯«å…¥-redis-ä¹‹å¾Œå–å‡ºåœ¨-unpickle"><a class="header" href="#dataframe-æˆ-pickle-å¾Œå¯«å…¥-redis-ä¹‹å¾Œå–å‡ºåœ¨-unpickle">dataframe æˆ pickle å¾Œå¯«å…¥ redis, ä¹‹å¾Œå–å‡ºåœ¨ unpickle</a></h2>
<pre><code class="language-python">from finlab import data
import redis
import pickle

# Connect to Redis
r = redis.Redis(host='localhost', port=6379, db=11)

# Get the data and save it to Redis
ç‡Ÿæ¥­åˆ©ç›Šæˆé•·ç‡ = data.get("price:æ”¶ç›¤åƒ¹")
r.set('test', pickle.dumps(ç‡Ÿæ¥­åˆ©ç›Šæˆé•·ç‡))
with open('test.bin', 'wb') as f:
    pickle.dump(ç‡Ÿæ¥­åˆ©ç›Šæˆé•·ç‡, f)


with open('test.bin', 'rb') as f:
    new_dict = pickle.load(f)
    print(new_dict)

# Read the data from Redis and unpickle it
unpickled_df = pickle.loads(r.get('test'))

print(unpickled_df)

with open('gg.bin', 'wb') as f:
    pickle.dump(pickle.loads(r.get('test')) , f)

with open('gg.bin', 'rb') as f:
    new_dict = pickle.load(f)
    print(new_dict)
</code></pre>
<h2 id="å°ä¸€å€‹æ¬„ä½nan-ä½¿ç”¨-bfill"><a class="header" href="#å°ä¸€å€‹æ¬„ä½nan-ä½¿ç”¨-bfill">å°ä¸€å€‹æ¬„ä½nan ä½¿ç”¨ bfill</a></h2>
<pre><code class="language-python">import pandas as pd
import numpy as np

# å»ºç«‹ç¯„ä¾‹ DataFrame
df = pd.DataFrame({'A': [1, 2, 3, np.nan, np.nan, 6, np.nan, 8]})

# é‡å°æ¬„ä½ A ä½¿ç”¨ backfill å¡«å…… NaN å€¼
df['A'] = df['A'].fillna(method='backfill')

# å°å‡ºå¡«å……å¾Œçš„ DataFrame
print(df)
</code></pre>
<h2 id="å…©å€‹ä¸åŒå¤§å°df-ä½¿ç”¨-fillna-æ–¹æ³•ä½¿ç”¨å¾Œå‘å¡«å……æ³•å¡«å……ç¼ºå¤±å€¼"><a class="header" href="#å…©å€‹ä¸åŒå¤§å°df-ä½¿ç”¨-fillna-æ–¹æ³•ä½¿ç”¨å¾Œå‘å¡«å……æ³•å¡«å……ç¼ºå¤±å€¼">å…©å€‹ä¸åŒå¤§å°DF ä½¿ç”¨ fillna() æ–¹æ³•ä½¿ç”¨å¾Œå‘å¡«å……æ³•å¡«å……ç¼ºå¤±å€¼</a></h2>
<pre><code class="language-python">import pandas as pd

# å‰µå»ºç¬¬ä¸€å€‹ dataframe
df1 = pd.DataFrame({'IsTrue': [False]},
                   index=pd.to_datetime(['2023-02-28']))

# å‰µå»ºç¬¬äºŒå€‹ dataframe
df2 = pd.DataFrame({'close': [239.0, 241.0, 247.0, 227.5, 231.0]},
                   index=pd.to_datetime(['2023-02-17', '2023-02-20', '2023-02-21', '2023-02-22', '2023-02-23']))

# å°‡ç¬¬ä¸€å€‹ dataframe è½‰æ›ç‚ºä¸€åˆ— dataframeï¼Œç„¶å¾Œèˆ‡ç¬¬äºŒå€‹ dataframe é€²è¡Œåˆä½µ
df = pd.concat([df2, df1], axis=1)  # ä½¿ç”¨ pd.concat() æ–¹æ³•å°‡å…©å€‹ dataframe åˆä½µ
df.fillna(method='bfill', inplace=True)  # ä½¿ç”¨ bfill æ–¹æ³•å¡«å……ç¼ºå¤±å€¼
df.dropna(how="any", inplace=True)  # ä½¿ç”¨ dropna æ–¹æ³•åˆªé™¤ä»å­˜åœ¨çš„ NaN å€¼

print(df)
</code></pre>
<h2 id="çš„-concat-å‡½æ•¸å°‡å…©å€‹-dataframe-ä»¥-df1-ç‚ºä¸»ç„¶å¾ŒæŒ‡å®š-axis1-å°‡-df2-ä»¥æ¬„ä½çš„æ–¹å¼åˆä½µè‡³-df1"><a class="header" href="#çš„-concat-å‡½æ•¸å°‡å…©å€‹-dataframe-ä»¥-df1-ç‚ºä¸»ç„¶å¾ŒæŒ‡å®š-axis1-å°‡-df2-ä»¥æ¬„ä½çš„æ–¹å¼åˆä½µè‡³-df1">çš„ <code>concat</code> å‡½æ•¸å°‡å…©å€‹ DataFrame ä»¥ df1 ç‚ºä¸»ï¼Œç„¶å¾ŒæŒ‡å®š <code>axis=1</code> å°‡ df2 ä»¥æ¬„ä½çš„æ–¹å¼åˆä½µè‡³ df1</a></h2>
<pre><code class="language-python">import pandas as pd

# å‰µå»º True/False å€¼ DataFrame
df1 = pd.DataFrame({'is_buy': [True, False, True, False]}, 
                   index=pd.to_datetime(['2022-01-01', '2022-01-02', '2022-01-03', '2022-01-04']))

# å‰µå»ºå‡åƒ¹ DataFrameï¼ˆæ—¥æœŸç‚º 2022-01-01 å’Œ 2022-01-03ï¼‰
df2 = pd.DataFrame({'mean_price': [100, 300]}, 
                   index=pd.to_datetime(['2022-01-01', '2022-01-03']))

# å°‡ df1 å’Œ df2 ä»¥æ¬„ä½çš„æ–¹å¼åˆä½µ
df_merged = pd.concat([df1, df2.reindex(df1.index)], axis=1)

# åˆªé™¤å«æœ‰ NaN å€¼çš„åˆ—
df_merged = df_merged.dropna(how='any')

print(df_merged)

</code></pre>
<p><a href="https://ds.apachecn.org/#/">è³‡æ–™ç§‘å­¸èˆ‡åˆ†æè­¯æ–‡é›†</a></p>
<pre><code class="language-python">pd.options.display.float_format = lambda x: "%.2f" % x
</code></pre>
<h2 id="pythoné‡åŒ–äº¤æ˜“å¯¦æˆ°ä¹‹ä½¿ç”¨resampleå‡½æ•¸è½‰æ›æ—¥kæ•¸æ“š"><a class="header" href="#pythoné‡åŒ–äº¤æ˜“å¯¦æˆ°ä¹‹ä½¿ç”¨resampleå‡½æ•¸è½‰æ›æ—¥kæ•¸æ“š">Pythoné‡åŒ–äº¤æ˜“å¯¦æˆ°ä¹‹ä½¿ç”¨Resampleå‡½æ•¸è½‰æ›â€œæ—¥Kâ€æ•¸æ“š</a></h2>
<p>https://walkonnet.com/archives/138620</p>
<p>ä½¿ç”¨Resampleå‡½æ•¸è½‰æ›æ™‚é–“åºåˆ—</p>
<h2 id="ä¸€ä»€éº¼æ˜¯resampleå‡½æ•¸"><a class="header" href="#ä¸€ä»€éº¼æ˜¯resampleå‡½æ•¸">ä¸€ã€ä»€éº¼æ˜¯resampleå‡½æ•¸ï¼Ÿ</a></h2>
<p>å®ƒæ˜¯Pythonæ•¸æ“šåˆ†æåº«Pandasçš„æ–¹æ³•å‡½æ•¸ã€‚</p>
<p>å®ƒä¸»è¦ç”¨æ–¼è½‰æ›æ™‚é–“åºåˆ—çš„é »æ¬¡ã€‚å¯ä»¥åšä¸€äº›çµ±è¨ˆåŒ¯ç¸½çš„å·¥ä½œã€‚</p>
<p>ä»€éº¼å«è½‰æ›æ™‚é–“åºåˆ—çš„é »æ¬¡å‘¢ï¼Ÿ</p>
<p>æ¯”å¦‚èªªè‚¡ç¥¨çš„æ—¥kå’Œå‘¨kï¼Œ</p>
<p>å‡è¨­æˆ‘éš»èƒ½ç²å–åˆ°è‚¡ç¥¨æ—¥Kçš„æ•¸æ“šï¼Œæ¯”å¦‚èªª11æœˆ1è™Ÿåˆ°11æœˆ5è™Ÿï¼Œé‚£æ€éº¼æ¨£å°‡å®ƒè½‰æ›ç‚ºä»¥å‘¨ç‚ºå–®ä½çš„Kç·šå‘¢ï¼Ÿ</p>
<div class="table-wrapper"><table><thead><tr><th>æ—¥æœŸ</th><th>é€±æœŸ</th><th>é–‹ç›¤åƒ¹</th><th>æ”¶ç›¤åƒ¹</th><th>æœ€é«˜åƒ¹</th><th>æœ€ä½åƒ¹</th></tr></thead><tbody>
<tr><td>11æœˆ1è™Ÿ</td><td>é€±ä¸€</td><td>1.11</td><td>1.11</td><td>1.11</td><td>1.12</td></tr>
<tr><td>11æœˆ2è™Ÿ</td><td>é€±äºŒ</td><td>1.12</td><td>1.12</td><td>1.11</td><td>1.12</td></tr>
<tr><td>11æœˆ3è™Ÿ</td><td>é€±ä¸‰</td><td>1.13</td><td>1.13</td><td>1.11</td><td>1.12</td></tr>
<tr><td>11æœˆ4è™Ÿ</td><td>é€±å››</td><td>1.15</td><td>1.14</td><td>1.11</td><td>1.12</td></tr>
<tr><td>11æœˆ5è™Ÿ</td><td>é€±äº”</td><td>1.14</td><td>1.15</td><td>1.11</td><td>1.12</td></tr>
</tbody></table>
</div>
<p>é¦–å…ˆæˆ‘å€‘è¦æ˜ç¢ºï¼Œå‘¨Kçš„é–‹ç›¤ã€æ”¶ç›¤ã€æœ€é«˜ã€æœ€ä½æ˜¯ä»€éº¼ã€‚æ¯é€±çš„é–‹ç›¤åƒ¹æ˜¯ç•¶å‘¨ç¬¬ä¸€å¤©çš„é–‹ç›¤åƒ¹ï¼Œæ”¶ç›¤åƒ¹æ˜¯ç•¶å‘¨æœ€å¾Œä¸€å¤©çš„æ”¶ç›¤åƒ¹ï¼Œå®ƒçš„æœ€é«˜åƒ¹æ˜¯é€™å‘¨æœ€é«˜çš„åƒ¹æ ¼ï¼Œæœ€ä½åƒ¹æ˜¯æœ¬é€±æ‰€æœ‰æœ€ä½åƒ¹ä¸­æœ€ä½çš„åƒ¹æ ¼ã€‚æ‰€ä»¥ä½ å»çœ‹ç‚’è‚¡å¹³è‡ºï¼Œå®ƒçš„å‘¨kéƒ½æ˜¯ä»¥é€±äº”çš„äº¤æ˜“æ—¥ç‚ºè¨˜éŒ„çš„æ™‚é–“é»ä½ç½®ã€‚é–‹ç›¤ã€æ”¶ç›¤ã€æœ€é«˜ã€æœ€ä½æ˜¯æŒ‰ç…§æˆ‘å‰›å‰›è¬›è§£çš„é€™å€‹è¦å‰‡ä¾†è¨ˆç®—çš„ã€‚è‡³æ–¼æœˆKã€å¹´Kçš„é¸å–è¦å‰‡ä¹Ÿæ˜¯ä¸€æ¨£çš„ã€‚æœˆKçš„é€±æœŸæ˜¯ä¸€å€‹æœˆï¼Œå¹´Kçš„é€±æœŸæ˜¯ä¸€å¹´ã€‚</p>
<p>é€™å€‹è¨ˆç®—æº–ç¢ºæ€§ä½ ä¹Ÿå¯ä»¥é€šéç¶²ä¸Šçš„æ•¸æ“šé€²è¡Œé©—è­‰ã€‚é€™å€‹è¨ˆç®—è¦å‰‡ï¼ŒåŒ…æ‹¬é–‹ç›¤ã€æ”¶ç›¤ã€æœ€é«˜ã€æœ€ä½çš„è¨ˆç®—ï¼Œæ”¶æ‹¾resampleå‡½æ•¸å¯ä»¥åšåˆ°çš„äº‹æƒ…ã€‚æ­¤å¤–Resampleé‚„æœ‰å€‹åŠŸèƒ½ï¼Œå°±æ˜¯åšçµ±è¨ˆåŒ¯ç¸½ï¼Œæ¯”å¦‚èªªæˆ‘æƒ³è¨ˆç®—ä¸€æ”¯è‚¡ç¥¨ç¸½çš„å‘¨æˆäº¤é‡ï¼Œå°±å¯ä»¥ä½¿ç”¨Resample.sumå‡½æ•¸å»æŠŠé€±ä¸€åˆ°é€±äº”çš„æˆäº¤é‡åŠ èµ·ä¾†ã€‚</p>
<p>ç‚ºç­æ–¹ä¾¿å¤§å‚¢è¨˜æ†¶ ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠresampleç†è§£ç‚ºExcelè¡¨æ ¼ä¸­çš„é€è¦–è¡¨åŠŸèƒ½ã€‚ä½ å¯ä»¥æŒ‰ç…§æ—¥æœŸåšå„ç¨®ç¯©é¸å’ŒåŒ¯ç¸½çµ±è¨ˆçš„ã€‚æœ€é‡è¦çš„æ˜¯ä»–å¯ä»¥æŒ‰ç…§æ—¥æœŸã€‚</p>
<h2 id="äºŒå¯¦æˆ°resampleå‡½æ•¸"><a class="header" href="#äºŒå¯¦æˆ°resampleå‡½æ•¸">äºŒã€å¯¦æˆ°Resampleå‡½æ•¸</a></h2>
<p>å› ç‚ºé€™2ç¯€èª²é‚„æ˜¯ä¸€äº›æ¯”è¼ƒåŸºç¤çš„éƒ¨åˆ†ï¼Œæ‰€ä»¥é‚„æ²’æœ‰åšæ¨¡å¡ŠåŒ–çš„å…§å®¹ã€‚</p>
<p>æˆ‘å€‘æœƒåœ¨å‰µå»ºè‚¡ç¥¨æ•¸æ“šåº«çš„æ™‚å€™ ä¾†åšçœŸæ­£çš„æ¨¡å¡ŠåŒ–çš„å·¥ä½œã€‚åˆ°é€™è£¡éƒ½æ˜¯åˆç´šçš„è…³æœ¬çš„å½¢å¼ã€‚å…ˆæå‰èªªä¸‹ã€‚</p>
<h3 id="1æ—¥k-è½‰æ›ç‚º-å‘¨k"><a class="header" href="#1æ—¥k-è½‰æ›ç‚º-å‘¨k">1.æ—¥K è½‰æ›ç‚º å‘¨K</a></h3>
<p>1.1å‡½æ•¸æ–‡æª”å­¸ç¿’</p>
<p>è°·æ­Œæœç´¢<code>Pandas Resample</code>ï¼šç¬¬ä¸€å€‹éˆæ¥å°±æ˜¯é€™å€‹å‡½æ•¸çš„å®˜æ–¹æ–‡æª”</p>
<p>https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.resample.html</p>
<p>é€™è£¡æœ‰ä»‹ç´¹ï¼šResampleæ˜¯å±¬æ–¼Pandas DataFrameä¸‹é¢çš„æ–¹æ³•ã€‚é€™è£¡æœ‰é—œæ–¼åƒæ•¸çš„è§£é‡‹ã€‚</p>
<p>é€™è£¡æˆ‘å€‘éš»å°2å€‹å¸¸ç”¨åƒæ•¸è¬›è§£ï¼Œä¸€å€‹æ˜¯ruleï¼Œå¦ä¸€å€‹æ˜¯closedã€‚</p>
<ul>
<li>ruleè¡¨ç¤ºçš„æ˜¯ä½ æ”¾ä¸€å€‹ä»€éº¼æ¨£çš„é€±æœŸæ€§æŒ‡æ¨™åœ¨è£¡é¢ï¼Œç”¨mä»£è¡¨Monthï¼ŒYä»£è¡¨Year,wä»£è¡¨Weekï¼Œ</li>
<li>closedä»£è¡¨ä½ å–å“ªä¸€å€‹åˆ†ç•Œç·šï¼Œèˆ‰ä¾‹ä¾†èªªï¼Œæ¯”å¦‚èªªæˆ‘æŠŠæ—¥kè½‰æ›ç‚ºå‘¨kï¼Œåˆ°åº•æˆ‘æ˜¯å–é€±ä¸€ç‚ºåˆ†ç•Œç·šé‚„æ˜¯é€±äº”ç‚ºåˆ†ç•Œç·šå‘¢ï¼Ÿé€™å°±æ˜¯é€šéclosedä¾†ç¢ºå®šçš„ã€‚</li>
</ul>
<p>é€™è£¡æœ‰å®ƒçš„ä¾‹å­ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt;index = pd.date_range('1/1/2000', periods=9, freq='T')
&gt;&gt;&gt;series = pd.Series(range(9), index=index)
&gt;&gt;&gt;series
2000-01-01 00:00:00    0
2000-01-01 00:01:00    1
2000-01-01 00:02:00    2
2000-01-01 00:03:00    3
2000-01-01 00:04:00    4
2000-01-01 00:05:00    5
2000-01-01 00:06:00    6
2000-01-01 00:07:00    7
2000-01-01 00:08:00    8
Freq: T, dtype: int64
</code></pre>
<p>é€™è£¡é¦–å…ˆå‰µå»ºç­ä¸€å€‹æ™‚é–“åºåˆ—çš„<code>DataFrame</code>ï¼Œå°±æ˜¯é€™å€‹<code>series</code>è®Šé‡ã€‚ä½ å¯ä»¥ç†è§£ç‚ºå®ƒæ˜¯ä¸€å€‹éš»æœ‰ä¸€å€‹å­—æ®µçš„è¡¨æ ¼æ¨£å¼ã€‚æ¥è‘—å¾€ä¸‹çœ‹ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt;series.resample('3T').sum()
2000-01-01 00:00:00     3
2000-01-01 00:03:00    12
2000-01-01 00:06:00    21
Freq: 3T, dtype: int64
</code></pre>
<p>é€™è£¡ä½¿ç”¨ç­<code>Resample</code>æ–¹æ³•ï¼Œ<code>3T</code>å°±æ˜¯3åˆ†é˜ï¼Œ<code>T</code>è¡¨ç¤ºåˆ†é˜ã€‚<code>sum()</code>å°±æ˜¯åŒ¯ç¸½ï¼Œä¹Ÿå°±æ˜¯é‡å°é€™ä¸€åˆ—æ•¸æ“šé€²è¡ŒåŒ¯ç¸½ã€‚</p>
<p>ä¹Ÿå°±æ˜¯èªªï¼Œæ¯3åˆ†é˜çµ±è¨ˆä¾æ¬¡ã€‚è¨»æ„åˆ°ï¼Œé€™å€‹æ™‚é–“åºåˆ—åŒ¯ç¸½çš„æ™‚é–“å–çš„å€¼æ˜¯3åˆ†é˜çš„ç¬¬ä¸€åˆ†é˜ã€‚å¦‚æœæˆ‘æƒ³å–æ™‚é–“é€±æœŸçš„æœ€å¾Œä¸€åˆ†é˜ï¼Œå¯ä»¥å°‡labelçš„å€¼æ”¹ç‚ºâ€œrightâ€ï¼š</p>
<pre><code class="language-python">&gt;&gt;&gt;series.resample('3T', label='right').sum()
2000-01-01 00:03:00     3
2000-01-01 00:06:00    12
2000-01-01 00:09:00    21
Freq: 3T, dtype: int64
</code></pre>
<p>1.2å¯¦æˆ°</p>
<p>ç²å–æ—¥KçœŸå¯¦çš„æ•¸æ“šï¼š</p>
<pre><code class="language-python">#ç²å–æ—¥k
df = get_price("000001.XSHG", end_date='2021-05-30 14:00:00',count=20, frequency='1d', fields=['open','close','high','low','volume','money'])  
print(df)
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ç²å–åˆ°ç­<code>4æœˆ28è™Ÿ</code>åˆ°<code>5æœˆ28è™Ÿ</code>çš„æ‰€æœ‰æ•¸æ“šã€‚ç‚ºç­æ›´æ–¹ä¾¿ç†è§£ æˆ‘å€‘å†æ·»åŠ ä¸€åˆ—æ•¸æ“šï¼Œå°±æ˜¯ç•¶å‰æ—¥æœŸæ˜¯<code>æ˜ŸæœŸå¹¾</code>çš„åˆ—ã€‚</p>
<pre><code class="language-python">#ç²å–æ—¥k
df = get_price("000001.XSHG", end_date='2021-05-30 14:00:00',count=20, frequency='1d', fields=['open','close','high','low','volume','money'])  
df['weekday']=df.index.weekday
print(df)
</code></pre>
<p>é€™è£¡<code>0</code>ä»£è¡¨é€±ä¸€ï¼Œé€™è£¡å¦‚ä½•è½‰æ›ç‚ºæŒ‰â€œ<strong>å‘¨</strong>â€çµ±è¨ˆå‘¢</p>
<pre><code class="language-python">#ç²å–å‘¨k
import pandas as pd
df_week = pd.DataFrame()
df_week = df['open'].resample('W').first()
print(df_week)
</code></pre>
<p>å¯ä»¥çœ‹åˆ°é€™è£¡çš„<code>2021-05-30</code>æ˜¯ä¸€å€‹ç¦®æ‹œçš„æœ€å¾Œä¸€å¤©ã€‚å®ƒå°æ‡‰çš„é–‹ç›¤åƒ¹ç¢ºå¯¦æ˜¯é€™å€‹æ•¸å­—ã€‚èªªæ˜æˆ‘å€‘è¨ˆç®—çš„å‘¨Kæ•¸æ“šæ˜¯æ­£ç¢ºçš„ã€‚</p>
<p><strong>æ”¶ç›¤åƒ¹</strong>å°±æ˜¯<code>æ¯é€±æ”¶ç›¤åƒ¹</code>æœ€å¾Œä¸€å¤©çš„æ•¸æ“šã€‚</p>
<p><strong>æœ€é«˜åƒ¹</strong>å°±æ˜¯<code>æ¯é€±æ”¶ç›¤åƒ¹</code>çš„æœ€å¤§å€¼ã€‚</p>
<p><strong>æœ€ä½åƒ¹</strong>å°±æ˜¯<code>æ¯é€±æ”¶ç›¤åƒ¹</code>çš„æœ€å°å€¼ã€‚</p>
<pre><code class="language-python">#ç²å–å‘¨k
import pandas as pd
df_week = pd.DataFrame()
df_week['open'] = df['open'].resample('W').first()
df_week['close'] = df['close'].resample('W').last()
df_week['high'] = df['high'].resample('W').max()
df_week['low'] = df['low'].resample('W').min()
print(df_week)
</code></pre>
<p>å°æ¯”æ•¸æ“šï¼Œcloseæ˜¯æœ€å¾Œä¸€å¤©çš„æ”¶ç›¤åƒ¹çš„æ•¸æ“šã€‚highæ˜¯ç•¶å‰å‘¨çš„æ¯å¤©çš„æœ€é«˜åƒ¹çš„æœ€é«˜åƒ¹ã€‚lowæ˜¯ç•¶å‰å‘¨çš„æ¯å¤©çš„æœ€ä½åƒ¹çš„æœ€ä½åƒ¹ã€‚</p>
<p>æˆ‘å€‘é€šéä¸åˆ°10è¡Œä»£ç¢¼å°±èƒ½å°‡<code>æ—¥K</code>çš„æ•¸æ“šè½‰æ›ç‚º<code>å‘¨K</code>çš„æ•¸æ“šã€‚</p>
<h3 id="2åŒ¯ç¸½çµ±è¨ˆåŠŸèƒ½çµ±è¨ˆæœˆæˆäº¤é‡æˆäº¤é¡"><a class="header" href="#2åŒ¯ç¸½çµ±è¨ˆåŠŸèƒ½çµ±è¨ˆæœˆæˆäº¤é‡æˆäº¤é¡">2.åŒ¯ç¸½çµ±è¨ˆåŠŸèƒ½ï¼ˆçµ±è¨ˆæœˆæˆäº¤é‡ã€æˆäº¤é¡ï¼‰</a></h3>
<p>åŒ¯ç¸½æˆäº¤é‡å’Œæˆäº¤é¡</p>
<p>æˆ‘æƒ³è¦æŠŠ<code>volume</code>(æˆäº¤é‡)å’Œ<code>money</code>(æˆäº¤é¡)è½‰æ›ç‚º<strong>ç¸½æˆäº¤é‡</strong>å’Œ<strong>ç¸½æˆäº¤é¡</strong></p>
<pre><code class="language-python">#ç²å–å‘¨k
import pandas as pd
df_week = pd.DataFrame()
df_week['open'] = df['open'].resample('W').first()
df_week['close'] = df['close'].resample('W').last()
df_week['high'] = df['high'].resample('W').max()
df_week['low'] = df['low'].resample('W').min()
df_week['volume(sum)'] = df['volume'].resample('W').sum()
df_week['money(sum)'] = df['money'].resample('W').sum()
print(df_week)
</code></pre>
<h3 id="3æ—¥k-è½‰æ›ç‚º-æœˆk"><a class="header" href="#3æ—¥k-è½‰æ›ç‚º-æœˆk">3.æ—¥K è½‰æ›ç‚º æœˆK</a></h3>
<p>å‡è¨­æˆ‘æœ‰ä¸€å¹´çš„æ•¸æ“šï¼Œå¦‚æœæƒ³è½‰æ›ç‚ºæœˆKæ‡‰è©²æ€éº¼è½‰ï¼Ÿ</p>
<p>éš»éœ€è¦æ”¹2å€‹åœ°æ–¹ï¼š</p>
<ul>
<li>æ·»åŠ <code>start_date</code>ç²å–åˆ°ä¸€æ•´å¹´çš„æ•¸æ“š</li>
<li>å°‡<code>resample</code>çš„åƒæ•¸æ”¹ç‚ºMå³å¯ï¼ŒMä»£è¡¨Month</li>
</ul>
<pre><code class="language-python">#ç²å–æ—¥k
df = get_price("000001.XSHG", end_date='2021-05-30 14:00:00', start_date='2020-05-30', frequency='1d', fields=['open','close','high','low','volume','money'])  
df['weekday']=df.index.weekday
print(df)

#ç²å–å‘¨k
import pandas as pd
df_week = pd.DataFrame()
df_week['open'] = df['open'].resample('M').first()
df_week['close'] = df['close'].resample('M').last()
df_week['high'] = df['high'].resample('M').max()
df_week['low'] = df['low'].resample('M').min()
print(df_week)
</code></pre>
<p>ä»¥ä¸Šå°±æ˜¯Pythoné‡åŒ–äº¤æ˜“å¯¦æˆ°ä¹‹ä½¿ç”¨Resampleå‡½æ•¸è½‰æ›â€œæ—¥Kâ€æ•¸æ“šçš„è©³ç´°å…§å®¹ï¼Œæ›´å¤šé—œæ–¼Python Resampleå‡½æ•¸è½‰æ›â€œæ—¥Kâ€æ•¸æ“šçš„è³‡æ–™è«‹é—œè¨»WalkonNetå…¶å®ƒç›¸é—œæ–‡ç« ï¼</p>
<h3 id="æ¨è–¦é–±è®€"><a class="header" href="#æ¨è–¦é–±è®€">æ¨è–¦é–±è®€ï¼š</a></h3>
<ul>
<li><a href="https://walkonnet.com/archives/459801">Python Pandasé«˜ç´šæ•™ç¨‹ä¹‹æ™‚é–“è™•ç†</a></li>
<li><a href="https://walkonnet.com/archives/543015">pythonæ•¸å­¸å»ºæ¨¡ä¹‹ä¸‰å¤§æ¨¡å‹èˆ‡åå¤§å¸¸ç”¨ç®—æ³•è©³æƒ…</a></li>
<li><a href="https://walkonnet.com/archives/541137">Python Pandas ä¸­çš„æ•¸æ“šçµæ§‹è©³è§£</a></li>
<li><a href="https://walkonnet.com/archives/540162">python Pandasæ™‚åºæ•¸æ“šè™•ç†</a></li>
<li><a href="https://walkonnet.com/archives/541225">Python pandasç´¢å¼•çš„è¨­ç½®å’Œä¿®æ”¹æ–¹æ³•</a></li>
</ul>
<hr />
<h1 id="pandas-shift-sum"><a class="header" href="#pandas-shift-sum">pandas shift sum</a></h1>
<pre><code class="language-py">import pandas as pd
import numpy

df = pd.DataFrame(numpy.random.randint(0, 10, (10, 2)), columns=['a','b'])
df['c'] = df.b.rolling(window = 3).sum().shift()
print(df)
</code></pre>
<pre><code class="language-py">import pandas as pd

df = pd.DataFrame(
    {
        "Name": [
            "A",
            "B",
            "C",
            "D",
            "E",
            "F",
            "G",
            "H",
            "I",
            "J",
            "K",
            "L",
            "M",
            "N",
            "O",
        ],
        "Sex": [
            "M",
            "M",
            "M",
            "F",
            "F",
            "M",
            "F",
            "M",
            "F",
            "M",
            "M",
            "M",
            "F",
            "M",
            "M",
        ],
        "Age": [38, 28, 31, 34, 28, 28, 36, 33, 22, 39, 22, 24, 31, 29, 22],
        "Height": [
            1.74,
            1.51,
            1.67,
            1.87,
            1.8,
            1.51,
            1.85,
            1.89,
            1.81,
            1.72,
            1.75,
            1.64,
            1.9,
            1.62,
            1.61,
        ],
        "Weight": [45, 63, 39, 45, 67, 66, 53, 45, 72, 46, 58, 44, 73, 70, 51],
    }
)

df_eg1 = df.copy()
# ç¬¬ 1 å€‹ç”¨æ³•
def BMI_1(r):
    return round(r["Weight"] / (r["Height"] ** 2), ndigits=2)


df_eg1["BMI_apply1"] = df_eg1.apply(BMI_1, axis=1)
# ç¬¬ 2 å€‹ç”¨æ³•
def BMI_2(weight, height):
    return round(weight / (height ** 2), ndigits=2)


df_eg1["BMI_apply2"] = df_eg1.apply(lambda r: BMI_2(r["Weight"], r["Height"]), axis=1)
print(df_eg1)
</code></pre>
<pre><code class="language-py">import pandas as pd

def sum(x, y, z, m, df):
    for index, row in df.iterrows():
        print(row)
    return (x + y + z) * m


df = pd.DataFrame({'A': [1, 2], 'B': [10, 20]})
df1 = df.apply(sum, args=(1, 2), m=10, df=df)
print(df1)

</code></pre>
<pre><code class="language-py">import pandas as pd


def apply_func(tsC, tsD):
    return tsC.mean() + tsD.mean()


dates = pd.date_range("20130101", periods=13, freq="D")
df = pd.DataFrame(
    {
        "C": [1, 9, 2, 4, 5, -1, 6, 9, 3, 5, 10, -3, -5],
        "D": [3, 8, 2, 6, 9, 1, 26, 89, 4, 2, 1, -13, 75],
    },
    index=dates,
)
df.index.name = "datetime"
print(df)

df["rmean"] = (
    df["C"]
    .rolling(window=3)
    .apply(lambda x: apply_func(df.loc[x.index, "C"], df.loc[x.index, "D"]))
)

print(df)
</code></pre>
<pre><code class="language-py">stringList = ["252.007", "546.658", "252.108"]
paramValue = ["252.017", "546.658", "252.008"]

def compareList(l1, l2):
    return [i&gt;j for i, j in zip(l1, l2)]

print(compareList(stringList, paramValue)) 
</code></pre>
<pre><code class="language-py">import pandas as pd
import numpy


def test(data):
    return sum(data)


df = pd.DataFrame(numpy.random.randint(0, 10, (10, 2)), columns=["a", "b"])
# print(df)
c = df.b.rolling(window=3).apply(test).shift()
# df['c'] = df.b.rolling(window = 3).sum().shift(1)
# df['d'] = df.b.rolling(window = 3).sum().shift(2)
print(df, "\n", c)
</code></pre>
<pre><code class="language-py">from numpy_ext import rolling_apply
import pandas as pd
import numpy


def test(a, b):
    return sum(a) + sum(b)


df = pd.DataFrame(numpy.random.randint(0, 10, (10, 2)), columns=["a", "b"])
df["c"] = rolling_apply(test, 3, df.a.values, df.b.values)
df["c"] = df["c"].shift()
print(df, type(df["c"]))
</code></pre>
<h3 id="resample"><a class="header" href="#resample">Resample</a></h3>
<pre><code class="language-python"># https://medium.com/uxai/%E9%87%8F%E5%8C%96%E6%8A%95%E8%B3%87-ai-for-trading-1-%E7%8D%B2%E5%8F%96%E5%B8%82%E5%A0%B4%E8%B3%87%E6%96%99-109791cde0f5
import yfinance as yf
import pandas as pd


def get_info_on_stock(ticker):
    stock = yf.Ticker(ticker)
    # æ‹¿ä¸Šå¸‚è‡³ä»Šçš„æ”¶ç›¤åƒ¹
    hist_all = stock.history(period="max")["Close"]
    # æ‹¿è¿‘ 30 å¤©çš„æ‰€æœ‰è³‡æ–™
    hist_30 = stock.history(period="30d")
    return hist_all


def get_info_on_stocks(track_list):
    df = pd.DataFrame()
    for stock in track_list:
        stock_info = yf.Ticker(stock)
        # æ‹¿è¿‘ 10 å¤©çš„è³‡æ–™
        hist = stock_info.history(period="360d")
        # åšä¸€äº›ç°¡å–®çš„è™•ç†å¾ŒæŠŠ dataframe æ¥èµ·ä¾†
        hist["Stock_id"] = stock
        hist["Date"] = hist.index
        hist = hist[
            [
                "Date",
                "Stock_id",
                "Open",
                "High",
                "Low",
                "Close",
                "Volume",
                "Dividends",
                "Stock Splits",
            ]
        ]
        df = pd.concat([df, hist])
    return df.set_index([pd.Index([i for i in range(len(df))])]).round(1)


if __name__ == "__main__":
    data = get_info_on_stock("2330.TW")
    print(data)

    # é¸å®šæˆ‘å€‘è¦æ¯”è¼ƒçš„å…¬å¸
    track_list = ["2330.TW", "2303.TW"]
    df = get_info_on_stocks(track_list)
    print(df, type(df))

    # æ¥ä¸‹ä¾†æˆ‘å€‘å¯ä»¥åšä¸€äº›ç°¡å–®çš„è¨ˆç®—ï¼Œåˆ©ç”¨ pandas å…§å»ºçš„å‡½æ•¸ä¾†çœ‹å…©è€…è³‡è¨Šçš„å¹³å‡ (mean):
    df_mean = df.groupby("Stock_id").mean()
    print(df_mean)

    # å‰é¢çš„åœ–å¯ä»¥çœ‹åˆ°æˆ‘å€‘æ˜¯å°‡åŒä¸€å€‹æ™‚é–“çš„å…©å€‹å…¬å¸è³‡è¨Šå †ç–Šèµ·ä¾†ï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘å¯ä»¥è©¦è‘—ç”¨å¦ä¸€ç¨®è¡¨ç¤ºæ–¹å¼ä¾†åšæ¯”è¼ƒï¼š
    open_prices = df.pivot(index="Date", columns="Stock_id", values="Open")
    high_prices = df.pivot(index="Date", columns="Stock_id", values="High")
    low_prices = df.pivot(index="Date", columns="Stock_id", values="Low")
    close_prices = df.pivot(index="Date", columns="Stock_id", values="Close")
    volume = df.pivot(index="Date", columns="Stock_id", values="Volume")
    print(close_prices.mean())
    print(close_prices)
    # print(close_prices['2303.TW'])
    df_month_open = open_prices.resample("M").first()
    df_month_high = high_prices.resample("M").max()
    df_month_low = low_prices.resample("M").min()
    df_month_close = close_prices.resample("M").last()
    print(df_month_open)
</code></pre>
<pre><code class="language-python">from finlab import data
import datetime
import numpy as np
import pandas as pd
import finlab
import functools


class MyFinlabDataFrame(pd.DataFrame):
    """å›æ¸¬èªæ³•ç³–
    é™¤äº†ä½¿ç”¨ç†Ÿæ‚‰çš„ Pandas èªæ³•å¤–ï¼Œæˆ‘å€‘ä¹Ÿæä¾›å¾ˆå¤šèªæ³•ç³–ï¼Œè®“å¤§å®¶é–‹ç™¼ç¨‹å¼æ™‚ï¼Œå¯ä»¥ç”¨ç°¡æ˜“çš„èªæ³•å®Œæˆè¤‡é›œçš„åŠŸèƒ½ï¼Œè®“é–‹ç™¼ç­–ç•¥æ›´ç°¡æ½”ï¼
    æˆ‘å€‘å°‡æ‰€æœ‰çš„èªæ³•ç³–åŒ…è£¹åœ¨ `MyFinlabDataFrame` ä¸­ï¼Œç”¨èµ·ä¾†è·Ÿ `pd.DataFrame` ä¸€æ¨£ï¼Œä½†æ˜¯å¤šäº†å¾ˆå¤šåŠŸèƒ½ï¼
    åªè¦ä½¿ç”¨ `finlab.data.get()` æ‰€ç²å¾—çš„è³‡æ–™ï¼Œçš†ç‚º `MyFinlabDataFrame` æ ¼å¼ï¼Œ
    æ¥ä¸‹ä¾†æˆ‘å€‘å°±ä¾†çœ‹çœ‹ï¼Œ `MyFinlabDataFrame` æœ‰å“ªäº›å¥½ç”¨çš„èªæ³•ç³–å§ï¼

    ç•¶è³‡æ–™æ—¥æœŸæ²’æœ‰å°é½Šï¼ˆä¾‹å¦‚: è²¡å ± vs æ”¶ç›¤åƒ¹ vs æœˆå ±ï¼‰æ™‚ï¼Œåœ¨ä½¿ç”¨ä»¥ä¸‹é‹ç®—ç¬¦è™Ÿï¼š`+`, `-`, `*`, `/`, `&gt;`, `&gt;=`, `==`, `&lt;`, `&lt;=`, `&amp;`, `|`, `~`ï¼Œä¸éœ€è¦å…ˆå°‡è³‡æ–™å°é½Šï¼Œå› ç‚º `MyFinlabDataFrame` æœƒè‡ªå‹•å¹«ä½ è™•ç†ï¼Œä»¥ä¸‹æ˜¯ç¤ºæ„åœ–ã€‚

    &lt;img src="https://i.ibb.co/pQr5yx5/Screen-Shot-2021-10-26-at-5-32-44-AM.png" alt="Screen-Shot-2021-10-26-at-5-32-44-AM"&gt;

    ä»¥ä¸‹æ˜¯ç¯„ä¾‹ï¼š`cond1` èˆ‡ `cond2` åˆ†åˆ¥ç‚ºã€Œæ¯å¤©ã€ï¼Œå’Œã€Œæ¯å­£ã€çš„è³‡æ–™ï¼Œå‡å¦‚è¦å–äº¤é›†çš„æ™‚é–“ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹èªæ³•ï¼š

    ```py
    from finlab import data
    # å–å¾— MyFinlabDataFrame
    close = data.get('price:æ”¶ç›¤åƒ¹')
    roa = data.get('fundamental_features:ROAç¨…å¾Œæ¯å‰')

    # é‹ç®—å…©å€‹é¸è‚¡æ¢ä»¶äº¤é›†
    cond1 = close &gt; 37
    cond2 = roa &gt; 0
    cond_1_2 = cond1 &amp; cond2

    æ“·å– 1101 è‡ºæ³¥ çš„è¨Šè™Ÿå¦‚ä¸‹åœ–ï¼Œå¯ä»¥çœ‹åˆ° `cond1` è·Ÿ `cond2` è¨Šè™Ÿçš„é »ç‡é›–ç„¶ä¸ç›¸åŒï¼Œä½†æ˜¯ç”±æ–¼ `cond1` è·Ÿ `cond2` æ˜¯ `MyFinlabDataFrame`ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å–äº¤é›†ï¼Œè€Œä¸ç”¨è™•ç†è³‡æ–™é »ç‡å°é½Šçš„å•é¡Œã€‚
    &lt;br /&gt;
    &lt;img src="https://i.ibb.co/m9chXSQ/imageconds.png" alt="imageconds"&gt;
    
    ç¸½çµä¾†èªªï¼ŒMyFinlabDataFrame èˆ‡ä¸€èˆ¬ dataframe å”¯äºŒä¸åŒä¹‹è™•ï¼š
    1. å¤šäº†ä¸€äº› methodï¼Œå¦‚`df.is_largest()`, `df.sustain()`...ç­‰ã€‚
    2. åœ¨åšå››å‰‡é‹ç®—ã€ä¸ç­‰å¼é‹ç®—å‰ï¼Œæœƒå°‡ df1ã€df2 çš„ index å–è¯é›†ï¼Œcolumn å–äº¤é›†ã€‚
    """
    
    @property
    def _constructor(self):
        return MyFinlabDataFrame
    
    @staticmethod
    def reshape(df1, df2):
    
        isfdf1 = isinstance(df1, MyFinlabDataFrame)
        isfdf2 = isinstance(df2, MyFinlabDataFrame)
        isdf1 = isinstance(df1, pd.DataFrame)
        isdf2 = isinstance(df2, pd.DataFrame)
    
        both_are_dataframe = (isfdf1 + isdf1) * (isfdf2 + isdf2) != 0
    
        d1_index_freq = df1.get_index_str_frequency() if isfdf1 else None
        d2_index_freq = df2.get_index_str_frequency() if isfdf2 else None
    
        if (
            (d1_index_freq or d2_index_freq)
            and (d1_index_freq != d2_index_freq)
            and both_are_dataframe
        ):
    
            df1 = df1.index_str_to_date() if isfdf1 else df1
            df2 = df2.index_str_to_date() if isfdf2 else df2
    
        if isinstance(df2, pd.Series):
            df2 = pd.DataFrame({c: df2 for c in df1.columns})
    
        if both_are_dataframe:
            index = df1.index.union(df2.index)
            columns = df1.columns.intersection(df2.columns)
    
            if len(df1.index) * len(df2.index) != 0:
                index_start = max(df1.index[0], df2.index[0])
                index = [t for t in index if index_start &lt;= t]
    
            return (
                df1.reindex(index=index, method="ffill")[columns],
                df2.reindex(index=index, method="ffill")[columns],
            )
        else:
            return df1, df2
    
    def __lt__(self, other):
        df1, df2 = self.reshape(self, other)
        return pd.DataFrame.__lt__(df1, df2)
    
    def __gt__(self, other):
        df1, df2 = self.reshape(self, other)
        return pd.DataFrame.__gt__(df1, df2)
    
    def __le__(self, other):
        df1, df2 = self.reshape(self, other)
        return pd.DataFrame.__le__(df1, df2)
    
    def __ge__(self, other):
        df1, df2 = self.reshape(self, other)
        return pd.DataFrame.__ge__(df1, df2)
    
    def __eq__(self, other):
        df1, df2 = self.reshape(self, other)
        return pd.DataFrame.__eq__(df1, df2)
    
    def __ne__(self, other):
        df1, df2 = self.reshape(self, other)
        return pd.DataFrame.__ne__(df1, df2)
    
    def __sub__(self, other):
        df1, df2 = self.reshape(self, other)
        return pd.DataFrame.__sub__(df1, df2)
    
    def __add__(self, other):
        df1, df2 = self.reshape(self, other)
        return pd.DataFrame.__add__(df1, df2)
    
    def __mul__(self, other):
        df1, df2 = self.reshape(self, other)
        return pd.DataFrame.__mul__(df1, df2)
    
    def __truediv__(self, other):
        df1, df2 = self.reshape(self, other)
        return pd.DataFrame.__truediv__(df1, df2)
    
    def __rshift__(self, other):
        return self.shift(-other)
    
    def __lshift__(self, other):
        return self.shift(other)
    
    def __and__(self, other):
        df1, df2 = self.reshape(self, other)
        return pd.DataFrame.__and__(df1, df2)
    
    def __or__(self, other):
        df1, df2 = self.reshape(self, other)
        return pd.DataFrame.__or__(df1, df2)
    
    def __getitem__(self, other):
        df1, df2 = self.reshape(self, other)
        return pd.DataFrame.__getitem__(df1, df2)
    
    def index_str_to_date(self):
        """è²¡å‹™æœˆå­£å ±ç´¢å¼•æ ¼å¼è½‰æ›
    
        å°‡ä»¥ä¸‹è³‡æ–™çš„ç´¢å¼•è½‰æ›æˆdatetimeæ ¼å¼:
    
        æœˆç‡Ÿæ”¶ (ex:2022-M1) å¾æ–‡å­—æ ¼å¼è½‰ç‚ºå…¬å‘Šæˆªæ­¢æ—¥ã€‚
    
        è²¡å‹™å­£å ± (ex:2022-Q1) å¾æ–‡å­—æ ¼å¼è½‰ç‚ºè²¡å ±é›»å­æª”è³‡æ–™ä¸Šå‚³æ—¥ã€‚
    
        é€šå¸¸ä½¿ç”¨æƒ…å¢ƒç‚ºå°ä¸åŒé€±æœŸçš„dataframeåšreindexï¼Œå¸¸ç”¨æ–¼ä»¥å…¬å‘Šæˆªæ­¢æ—¥ä½œç‚ºè¨Šè™Ÿç”¢ç”Ÿæ—¥ã€‚
    
        Returns:
          (pd.DataFrame): data
        Examples:
    
            ```py
            data.get('monthly_revenue:ç•¶æœˆç‡Ÿæ”¶').index_str_to_date()
            data.get('financial_statement:ç¾é‡‘åŠç´„ç•¶ç¾é‡‘').index_str_to_date()
</code></pre>
<pre><code>  """
    if len(self.index) == 0 or not isinstance(self.index[0], str):
        return self

    if self.index[0].find("M") != -1:
        return self._index_str_to_date_month()
    elif self.index[0].find("Q") != -1:
        return self._index_str_to_date_season()

    return self

@staticmethod
def to_business_day(date):
    def skip_weekend(d):
        add_days = {5: 2, 6: 1}
        wd = d.weekday()
        if wd in add_days:
            d += datetime.timedelta(days=add_days[wd])
        return d

    close = data.get("price:æ”¶ç›¤åƒ¹")
    return (
        pd.Series(date)
        .apply(
            lambda d: skip_weekend(d)
            if d in close.index or d &lt; close.index[0] or d &gt; close.index[-1]
            else close.loc[d:].index[0]
        )
        .values
    )

def get_index_str_frequency(self):

    if len(self.index) == 0:
        return None

    if not isinstance(self.index[0], str):
        return None

    if (self.index.str.find("M") != -1).all():
        return "month"

    if (self.index.str.find("Q") != -1).all():
        return "season"

    return None

def _index_date_to_str_month(self):

    # index is already str
    if len(self.index) == 0 or not isinstance(self.index[0], pd.Timestamp):
        return self

    index = (self.index - datetime.timedelta(days=30)).strftime("%Y-M%m")
    return MyFinlabDataFrame(self.values, index=index, columns=self.columns)

def _index_str_to_date_month(self):

    # index is already timestamps
    if len(self.index) == 0 or not isinstance(self.index[0], str):
        return self

    if not (self.index.str.find("M") != -1).all():
        logger.warning(
            "MyFinlabDataFrame: invalid index, cannot format index to monthly timestamp."
        )
        return self

    index = (
        pd.to_datetime(self.index, format="%Y-M%m")
        + pd.offsets.MonthBegin()
        + datetime.timedelta(days=9)
    )
    # chinese new year and covid-19 impact monthly revenue deadline
    replacements = {
        datetime.datetime(2020, 2, 10): datetime.datetime(2020, 2, 15),
        datetime.datetime(2021, 2, 10): datetime.datetime(2021, 2, 15),
        datetime.datetime(2022, 2, 10): datetime.datetime(2022, 2, 14),
    }
    replacer = replacements.get
    index = [replacer(n, n) for n in index]

    index = self.to_business_day(index)

    ret = MyFinlabDataFrame(self.values, index=index, columns=self.columns)
    ret.index.name = "date"

    return ret

def _index_date_to_str_season(self):

    # index is already str
    if len(self.index) == 0 or not isinstance(self.index[0], pd.Timestamp):
        return self

    q = (
        self.index.strftime("%m")
        .astype(int)
        .map({5: 1, 8: 2, 9: 2, 10: 3, 11: 3, 3: 4, 4: 4})
    )
    year = self.index.year.copy()
    year -= q == 4
    index = year.astype(str) + "-Q" + q.astype(str)

    return MyFinlabDataFrame(self.values, index=index, columns=self.columns)

def deadline(self):
    """è²¡å‹™å­£å ±ç´¢å¼•è½‰æ›æˆå…¬å‘Šæˆªæ­¢æ—¥

      å°‡è²¡å‹™å­£å ± (ex:2022Q1) å¾æ–‡å­—æ ¼å¼è½‰ç‚ºå…¬å‘Šæˆªæ­¢æ—¥çš„datetimeæ ¼å¼ï¼Œ
      é€šå¸¸ä½¿ç”¨æƒ…å¢ƒç‚ºå°ä¸åŒé€±æœŸçš„dataframeåšreindexï¼Œå¸¸ç”¨æ–¼ä»¥å…¬å‘Šæˆªæ­¢æ—¥ä½œç‚ºè¨Šè™Ÿç”¢ç”Ÿæ—¥ã€‚
      Returns:
        (pd.DataFrame): data
      Examples:
          ```py
          data.get('financial_statement:ç¾é‡‘åŠç´„ç•¶ç¾é‡‘').deadline()
          ```
    """
    return self._index_str_to_date_season(detail=False)

def _index_str_to_date_season(self, detail=True):

    disclosure_dates = calc_disclosure_dates(detail).reindex_like(self).unstack()

    self.columns.name = "stock_id"

    unstacked = self.unstack()

    ret = (
        pd.DataFrame(
            {"value": unstacked.values, "disclosures": disclosure_dates.values,},
            unstacked.index,
        )
        .reset_index()
        .drop_duplicates(["disclosures", "stock_id"])
        .pivot(index="disclosures", columns="stock_id", values="value")
        .ffill()
        .pipe(lambda df: df.loc[df.index.notna()])
        .pipe(lambda df: MyFinlabDataFrame(df))
        .rename_axis("date")
    )

    if not detail:
        ret.index = self.to_business_day(ret.index)

    return ret

def average(self, n):
    """å– n ç­†ç§»å‹•å¹³å‡

    è‹¥è‚¡ç¥¨åœ¨æ™‚é–“çª—æ ¼å…§ï¼Œæœ‰ N/2 ç­† NaNï¼Œå‰‡æœƒç”¢ç”Ÿ NaNã€‚
    Args:
      n (positive-int): è¨­å®šç§»å‹•çª—æ ¼æ•¸ã€‚
    Returns:
      (pd.DataFrame): data
    Examples:
        è‚¡åƒ¹åœ¨å‡ç·šä¹‹ä¸Š
        ```py
        from finlab import data
        close = data.get('price:æ”¶ç›¤åƒ¹')
        sma = close.average(10)
        cond = close &gt; sma
        ```
        åªéœ€è¦ç°¡å–®çš„èªæ³•ï¼Œå°±å¯ä»¥å°‡å…¶ä¸­ä¸€éƒ¨åˆ†çš„è¨Šè™Ÿç¹ªè£½å‡ºä¾†æª¢æŸ¥ï¼š
        ```py
        import matplotlib.pyplot as plt

        close.loc['2021', '2330'].plot()
        sma.loc['2021', '2330'].plot()
        cond.loc['2021', '2330'].mul(20).add(500).plot()

        plt.legend(['close', 'sma', 'cond'])
        ```
        &lt;img src="https://i.ibb.co/Mg1P85y/sma.png" alt="sma"&gt;
    """
    return self.rolling(n, min_periods=int(n / 2)).mean()

def is_largest(self, n):
    """å–æ¯åˆ—å‰ n ç­†å¤§çš„æ•¸å€¼

    è‹¥ç¬¦åˆ `True` ï¼Œåä¹‹ç‚º `False` ã€‚ç”¨ä¾†ç¯©é¸æ¯å¤©æ•¸å€¼æœ€å¤§çš„è‚¡ç¥¨ã€‚

    &lt;img src="https://i.ibb.co/8rh3tbt/is-largest.png" alt="is-largest"&gt;
    Args:
      n (positive-int): è¨­å®šæ¯åˆ—å‰ n ç­†å¤§çš„æ•¸å€¼ã€‚
    Returns:
      (pd.DataFrame): data
    Examples:
        æ¯å­£ ROA å‰ 10 åçš„è‚¡ç¥¨
        ```py
        from finlab import data

        roa = data.get('fundamental_features:ROAç¨…å¾Œæ¯å‰')
        good_stocks = roa.is_largest(10)
        ```
    """
    return (
        self.astype(float)
        .apply(lambda s: s.nlargest(n), axis=1)
        .reindex_like(self)
        .notna()
    )

def is_smallest(self, n):
    """å–æ¯åˆ—å‰ n ç­†å°çš„æ•¸å€¼

    è‹¥ç¬¦åˆ `True` ï¼Œåä¹‹ç‚º `False` ã€‚ç”¨ä¾†ç¯©é¸æ¯å¤©æ•¸å€¼æœ€å°çš„è‚¡ç¥¨ã€‚
    Args:
      n (positive-int): è¨­å®šæ¯åˆ—å‰ n ç­†å°çš„æ•¸å€¼ã€‚
    Returns:
      (pd.DataFrame): data
    Examples:
        è‚¡åƒ¹æ·¨å€¼æ¯”æœ€å°çš„ 10 æª”è‚¡ç¥¨
        ```py
        from finlab import data

        pb = data.get('price_earning_ratio:è‚¡åƒ¹æ·¨å€¼æ¯”')
        cheap_stocks = pb.is_smallest(10)
        ```
    """
    return (
        self.astype(float)
        .apply(lambda s: s.nsmallest(n), axis=1)
        .reindex_like(self)
        .notna()
    )

def is_entry(self):
    """é€²å ´é»

    å–é€²å ´è¨Šè™Ÿé»ï¼Œè‹¥ç¬¦åˆæ¢ä»¶çš„å€¼å‰‡ç‚ºTrueï¼Œåä¹‹ç‚ºFalseã€‚
    Returns:
      (pd.DataFrame): data
    Examples:
      ç­–ç•¥ç‚ºæ¯æ—¥æ”¶ç›¤åƒ¹å‰10é«˜ï¼Œå–é€²å ´é»ã€‚
        ```py
        from finlab import data
        data.get('price:æ”¶ç›¤åƒ¹').is_largest(10).is_entry()
        ```
    """
    return self &amp; ~self.shift(fill_value=False)

def is_exit(self):
    """å‡ºå ´é»

    å–å‡ºå ´è¨Šè™Ÿé»ï¼Œè‹¥ç¬¦åˆæ¢ä»¶çš„å€¼å‰‡ç‚º Trueï¼Œåä¹‹ç‚º Falseã€‚
    Returns:
      (pd.DataFrame): data
    Examples:
      ç­–ç•¥ç‚ºæ¯æ—¥æ”¶ç›¤åƒ¹å‰10é«˜ï¼Œå–å‡ºå ´é»ã€‚
        ```py
        from finlab import data
        data.get('price:æ”¶ç›¤åƒ¹').is_largest(10).is_exit()
        ```
    """
    return ~self &amp; self.shift(fill_value=False)

def rise(self, n=1):
    """æ•¸å€¼ä¸Šå‡ä¸­

    å–æ˜¯å¦æ¯”å‰ç¬¬nç­†é«˜ï¼Œè‹¥ç¬¦åˆæ¢ä»¶çš„å€¼å‰‡ç‚ºTrueï¼Œåä¹‹ç‚ºFalseã€‚
    &lt;img src="https://i.ibb.co/Y72bN5v/Screen-Shot-2021-10-26-at-6-43-41-AM.png" alt="Screen-Shot-2021-10-26-at-6-43-41-AM"&gt;
    Args:
      n (positive-int): è¨­å®šæ¯”è¼ƒå‰ç¬¬nç­†é«˜ã€‚
    Returns:
      (pd.DataFrame): data
    Examples:
        æ”¶ç›¤åƒ¹æ˜¯å¦é«˜æ–¼10æ—¥å‰è‚¡åƒ¹
        ```py
        from finlab import data
        data.get('price:æ”¶ç›¤åƒ¹').rise(10)
        ```
    """
    return self &gt; self.shift(n)

def fall(self, n=1):
    """æ•¸å€¼ä¸‹é™ä¸­

    å–æ˜¯å¦æ¯”å‰ç¬¬nç­†ä½ï¼Œè‹¥ç¬¦åˆæ¢ä»¶çš„å€¼å‰‡ç‚ºTrueï¼Œåä¹‹ç‚ºFalseã€‚
    &lt;img src="https://i.ibb.co/Y72bN5v/Screen-Shot-2021-10-26-at-6-43-41-AM.png" alt="Screen-Shot-2021-10-26-at-6-43-41-AM"&gt;
    Args:
      n (positive-int): è¨­å®šæ¯”è¼ƒå‰ç¬¬nç­†ä½ã€‚
    Returns:
      (pd.DataFrame): data
    Examples:
        æ”¶ç›¤åƒ¹æ˜¯å¦ä½æ–¼10æ—¥å‰è‚¡åƒ¹
        ```py
        from finlab import data
        data.get('price:æ”¶ç›¤åƒ¹').fall(10)
        ```
    """
    return self &lt; self.shift(n)

def groupby_category(self):
    """è³‡æ–™æŒ‰ç”¢æ¥­åˆ†ç¾¤

    é¡ä¼¼ `pd.DataFrame.groupby()`çš„è™•ç†æ•ˆæœã€‚
    Returns:
      (pd.DataFrame): data
    Examples:
      åŠå°é«”å¹³å‡è‚¡åƒ¹æ·¨å€¼æ¯”æ™‚é–“åºåˆ—
        ```py
        from finlab import data
        pe = data.get('price_earning_ratio:è‚¡åƒ¹æ·¨å€¼æ¯”')
        pe.groupby_category().mean()['åŠå°é«”'].plot()
        ```
        &lt;img src="https://i.ibb.co/Tq2fKBp/pbmean.png" alt="pbmean"&gt;

        å…¨çƒ 2020 é‡åŒ–å¯¬é¬†åŠ ä¸Šæ™¶ç‰‡çŸ­ç¼ºï¼Œä½¿å¾—åŠå°é«”è‚¡åƒ¹æ·¨å€¼æ¯”è¡é«˜ã€‚
    """
    categories = data.get("security_categories")
    cat = categories.set_index("stock_id").category.to_dict()
    org_set = set(cat.values())
    set_remove_illegal = set(
        o for o in org_set if isinstance(o, str) and o != "nan"
    )
    set_remove_illegal

    refine_cat = {}
    for s, c in cat.items():
        if c == None or c == "nan":
            refine_cat[s] = "å…¶ä»–"
            continue

        if c == "é›»è…¦åŠé€±é‚Š":
            refine_cat[s] = "é›»è…¦åŠé€±é‚Šè¨­å‚™æ¥­"
            continue

        if c[-1] == "æ¥­" and c[:-1] in set_remove_illegal:
            refine_cat[s] = c[:-1]
        else:
            refine_cat[s] = c

    col_categories = pd.Series(
        self.columns.map(lambda s: refine_cat[s] if s in cat else "å…¶ä»–")
    )

    return self.groupby(col_categories.values, axis=1)

def entry_price(self, trade_at="close"):

    signal = self.is_entry()
    adj = (
        data.get("etl:adj_close")
        if trade_at == "close"
        else data.get("etl:adj_open")
    )
    adj, signal = adj.reshape(adj.loc[signal.index[0] : signal.index[-1]], signal)
    return adj.bfill()[signal.shift(fill_value=False)].ffill()

def sustain(self, nwindow, nsatisfy=None):
    """æŒçºŒ N å¤©æ»¿è¶³æ¢ä»¶

    å–ç§»å‹• nwindow ç­†åŠ ç¸½å¤§æ–¼ç­‰æ–¼nsatisfyï¼Œè‹¥ç¬¦åˆæ¢ä»¶çš„å€¼å‰‡ç‚ºTrueï¼Œåä¹‹ç‚ºFalseã€‚

    Args:
      nwindow (positive-int): è¨­å®šç§»å‹•çª—æ ¼ã€‚
      nsatisfy (positive-int): è¨­å®šç§»å‹•çª—æ ¼è¨ˆç®—å¾Œæœ€ä½æ»¿è¶³æ•¸å€¼ã€‚
    Returns:
      (pd.DataFrame): data
    Examples:
        æ”¶ç›¤åƒ¹æ˜¯å¦é€£å…©æ—¥ä¸Šæ¼²
        ```py
        from finlab import data
        data.get('price:æ”¶ç›¤åƒ¹').rise().sustain(2)
        ```
    """
    nsatisfy = nsatisfy or nwindow
    return self.rolling(nwindow).sum() &gt;= nsatisfy

def industry_rank(self, categories=None):
    """è¨ˆç®—ç”¢æ¥­ ranking æ’åï¼Œ0 ä»£è¡¨ç”¢æ¥­å…§æœ€ä½ï¼Œ1 ä»£è¡¨ç”¢æ¥­å…§æœ€é«˜
    Args:
      categories (list of str): æ¬²è€ƒæ…®çš„ç”¢æ¥­ï¼Œex: ['è²¿æ˜“ç™¾è²¨', 'é›²ç«¯é‹ç®—']ï¼Œé è¨­ç‚ºå…¨ç”¢æ¥­ï¼Œè«‹åƒè€ƒ `data.get('security_industry_themes')` ä¸­çš„ç”¢æ¥­é …ç›®ã€‚
    Examples:
        æœ¬æ„æ¯”ç”¢æ¥­æ’ååˆ†æ•¸
        ```py
        from finlab import data

        pe = data.get('price_earning_ratio:æœ¬ç›Šæ¯”')
        pe_rank = pe.industry_rank()
        print(pe_rank)
        ```
    """

    themes = (
        data.get("security_industry_themes")
        .copy()  # è¤‡è£½
        .assign(
            category=lambda self: self.category.apply(lambda s: eval(s))
        )  # å¾æ–‡å­—æ ¼å¼è½‰æˆé™£åˆ—æ ¼
        .explode("category")  # å±•é–‹è³‡æ–™
    )

    categories = categories or set(
        themes.category[themes.category.str.find(":") == -1]
    )

    def calc_rank(ind):
        stock_ids = themes.stock_id[themes.category == ind]
        return self[stock_ids].pipe(lambda self: self.rank(axis=1, pct=True))

    return (
        pd.concat([calc_rank(ind) for ind in categories], axis=1)
        .groupby(level=0, axis=1)
        .mean()
    )

def quantile_row(self, c):
    """è‚¡ç¥¨ç•¶å¤©æ•¸å€¼åˆ†ä½æ•¸

    å–å¾—æ¯åˆ—cå®šåˆ†ä½æ•¸çš„å€¼ã€‚
    Args:
      c (positive-int): è¨­å®šæ¯åˆ— n å®šåˆ†ä½æ•¸çš„å€¼ã€‚
    Returns:
      (pd.DataFrame): data
    Examples:
        å–æ¯æ—¥è‚¡åƒ¹å‰90ï¼…åˆ†ä½æ•¸
        ```py
        from finlab import data
        data.get('price:æ”¶ç›¤åƒ¹').quantile_row(0.9)
        ```
    """
    s = self.quantile(c, axis=1)
    return s

def exit_when(self, exit):

    df, exit = self.reshape(self, exit)

    df.fillna(False, inplace=True)
    exit.fillna(False, inplace=True)

    entry_signal = df.is_entry()
    exit_signal = df.is_exit()
    exit_signal |= exit

    # build position using entry_signal and exit_signal
    position = pd.DataFrame(np.nan, index=df.index, columns=df.columns)
    position[entry_signal] = 1
    position[exit_signal] = 0

    position.ffill(inplace=True)
    position = position == 1
    position.fillna(False)
    return position

def hold_until(
    self,
    exit,
    nstocks_limit=None,
    stop_loss=-np.inf,
    take_profit=np.inf,
    trade_at="close",
    rank=None,
):
    """è¨Šè™Ÿé€²å‡ºå ´

    é€™å¤§æ¦‚æ˜¯æ‰€æœ‰ç­–ç•¥æ’°å¯«ä¸­ï¼Œæœ€é‡è¦çš„èªæ³•ç³–ï¼Œä¸Šè¿°èªæ³•ä¸­ `entries` ç‚ºé€²å ´è¨Šè™Ÿï¼Œè€Œ `exits` æ˜¯å‡ºå ´è¨Šè™Ÿã€‚æ‰€ä»¥ `entries.hold_until(exits)` ï¼Œå°±æ˜¯é€²å ´è¨Šè™Ÿç‚º `True` æ™‚ï¼Œè²·å…¥ä¸¦æŒæœ‰è©²æª”è‚¡ç¥¨ï¼Œç›´åˆ°å‡ºå ´è¨Šè™Ÿç‚º `True ` å‰‡è³£å‡ºã€‚
    &lt;img src="https://i.ibb.co/PCt4hPd/Screen-Shot-2021-10-26-at-6-35-05-AM.png" alt="Screen-Shot-2021-10-26-at-6-35-05-AM"&gt;
    æ­¤å‡½å¼æœ‰å¾ˆå¤šç´°éƒ¨è¨­å®šï¼Œå¯ä»¥è®“ä½ æœ€å¤šé¸æ“‡ N æª”è‚¡ç¥¨åšè¼ªå‹•ã€‚å¦å¤–ï¼Œç•¶è¶…é N æª”é€²å ´è¨Šè™Ÿç™¼ç”Ÿï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§å®¢è£½åŒ–çš„æ’åºï¼Œé¸æ“‡å„ªå…ˆé¸å…¥çš„è‚¡ç¥¨ã€‚æœ€å¾Œï¼Œå¯ä»¥è¨­å®šåƒ¹æ ¼æ³¢å‹•ç•¶è¼ªå‹•è¨Šè™Ÿï¼Œä¾†å¢åŠ å‡ºå ´çš„æ™‚æ©Ÿé»ã€‚

    Args:
      exit (pd.Dataframe): å‡ºå ´è¨Šè™Ÿã€‚
      nstocks_limit (int)`: è¼ªå‹•æª”æ•¸ä¸Šé™ï¼Œé è¨­ç‚ºNoneã€‚
      stop_loss (float): åƒ¹æ ¼æ³¢å‹•è¼ªå‹•è¨Šè™Ÿï¼Œé è¨­ç‚ºNoneï¼Œä¸ç”Ÿæˆè¼ªå‹•è¨Šè™Ÿã€‚ç¯„ä¾‹ï¼š0.1ï¼Œä»£è¡¨æˆæœ¬åƒ¹ä¸‹è·Œ 10% æ™‚ç”¢ç”Ÿå‡ºå ´è¨Šè™Ÿã€‚
      take_profit (float): åƒ¹æ ¼æ³¢å‹•è¼ªå‹•è¨Šè™Ÿï¼Œé è¨­ç‚ºNoneï¼Œä¸ç”Ÿæˆè¼ªå‹•è¨Šè™Ÿã€‚ç¯„ä¾‹ï¼š0.1ï¼Œä»£è¡¨æˆæœ¬åƒ¹ä¸Šæ¼² 10% æ™‚ç”¢ç”Ÿå‡ºå ´è¨Šè™Ÿã€‚
      trade_at (str): åƒ¹æ ¼æ³¢å‹•è¼ªå‹•è¨Šè™Ÿåƒè€ƒåƒ¹ï¼Œé è¨­ç‚º'close'ã€‚å¯é¸ `close` æˆ– `open`ã€‚
      rank (pd.Dataframe): ç•¶å¤©é€²å ´è¨Šè™Ÿæ•¸é‡è¶…é nstocks_limit æ™‚ï¼Œä»¥ rank æ•¸å€¼è¶Šå¤§çš„è‚¡ç¥¨å„ªå…ˆé€²å ´ã€‚
    Returns:
      (pd.DataFrame): data
    Examples:
        åƒ¹æ ¼ &gt; 20 æ—¥å‡ç·šå…¥å ´, åƒ¹æ ¼ &lt; 60 æ—¥å‡ç·šå‡ºå ´ï¼Œæœ€å¤šæŒæœ‰10æª”ï¼Œè¶…é 10 å€‹é€²å ´è¨Šè™Ÿï¼Œå‰‡ä»¥è‚¡åƒ¹æ·¨å€¼æ¯”å°çš„è‚¡ç¥¨å„ªå…ˆé¸å…¥ã€‚

        ```python
        from finlab import data
        from finlab.backtest import sim

        close = data.get('price:æ”¶ç›¤åƒ¹')
        pb = data.get('price_earning_ratio:è‚¡åƒ¹æ·¨å€¼æ¯”')

        sma20 = close.average(20)
        sma60 = close.average(60)

        entries = close &gt; sma20
        exits = close &lt; sma60

        ï¼ƒpbå‰10å°çš„æ¨™çš„åšè¼ªå‹•
        position = entries.hold_until(exits, nstocks_limit=10, rank=-pb)
        sim(position)
        ```
    """
    if nstocks_limit is None:
        nstocks_limit = len(self.columns)

    union_index = self.index.union(exit.index)
    intersect_col = self.columns.intersection(exit.columns)

    if stop_loss != -np.inf or take_profit != np.inf:
        price = data.get(f"etl:adj_{trade_at}")
        union_index = union_index.union(
            price.loc[union_index[0] : union_index[-1]].index
        )
        intersect_col = intersect_col.intersection(price.columns)
    else:
        price = pd.DataFrame()

    if rank is not None:
        union_index = union_index.union(rank.index)
        intersect_col = intersect_col.intersection(rank.columns)

    entry = (
        self.reindex(union_index, columns=intersect_col, method="ffill")
        .ffill()
        .fillna(False)
    )
    exit = (
        exit.reindex(union_index, columns=intersect_col, method="ffill")
        .ffill()
        .fillna(False)
    )

    if price is not None:
        price = price.reindex(union_index, columns=intersect_col, method="ffill")

    if rank is not None:
        rank = rank.reindex(union_index, columns=intersect_col, method="ffill")
    else:
        rank = pd.DataFrame(1, index=union_index, columns=intersect_col)

    max_rank = rank.max().max()
    min_rank = rank.min().min()
    rank = (rank - min_rank) / (max_rank - min_rank)
    rank.fillna(0, inplace=True)

    def rotate_stocks(
        ret,
        entry,
        exit,
        nstocks_limit,
        stop_loss=-np.inf,
        take_profit=np.inf,
        price=None,
        ranking=None,
    ):

        nstocks = 0

        ret[0][np.argsort(entry[0])[-nstocks_limit:]] = 1
        ret[0][exit[0] == 1] = 0
        ret[0][entry[0] == 0] = 0

        entry_price = np.empty(entry.shape[1])
        entry_price[:] = np.nan

        for i in range(1, entry.shape[0]):

            # regitser entry price
            if stop_loss != -np.inf or take_profit != np.inf:
                is_entry = (ret[i - 2] == 0) if i &gt; 1 else (ret[i - 1] == 1)

                is_waiting_for_entry = np.isnan(entry_price) &amp; (ret[i - 1] == 1)

                is_entry |= is_waiting_for_entry

                entry_price[is_entry == 1] = price[i][is_entry == 1]

                # check stop_loss and take_profit
                returns = price[i] / entry_price
                stop = (returns &gt; 1 + abs(take_profit)) | (
                    returns &lt; 1 - abs(stop_loss)
                )
                exit[i] |= stop

            # run signal
            rank = entry[i] * ranking[i] + ret[i - 1] * 3
            rank[exit[i] == 1] = -1
            rank[(entry[i] == 0) &amp; (ret[i - 1] == 0)] = -1

            ret[i][np.argsort(rank)[-nstocks_limit:]] = 1
            ret[i][rank == -1] = 0

        return ret

    ret = pd.DataFrame(0, index=entry.index, columns=entry.columns)
    ret = rotate_stocks(
        ret.values,
        entry.astype(int).values,
        exit.astype(int).values,
        nstocks_limit,
        stop_loss,
        take_profit,
        price=price.values,
        ranking=rank.values,
    )

    return pd.DataFrame(ret, index=entry.index, columns=entry.columns)
</code></pre>
<p>@functools.lru_cache
def calc_disclosure_dates(detail=True):</p>
<pre><code>cinfo = data.get("company_basic_info").copy()
cinfo["id"] = cinfo.stock_id.str.split(" ").str[0]
cinfo = cinfo.set_index("id")
cinfo = cinfo[~cinfo.index.duplicated(keep="last")]

def calc_default_disclosure_dates(s):
    sid = s.name
    cat = cinfo.loc[sid].ç”¢æ¥­é¡åˆ¥ if sid in cinfo.index else "etf"
    short_name = cinfo.loc[sid].å…¬å¸ç°¡ç¨± if sid in cinfo.index else "etf"

    if cat == "é‡‘èæ¥­":
        calendar = {
            "1": "-05-15",
            "2": "-08-31",
            "3": "-11-14",
            "4": "-03-31",
        }
    elif cat == "é‡‘èä¿éšªæ¥­":
        calendar = {
            "1": "-04-30",
            "2": "-08-31",
            "3": "-10-31",
            "4": "-03-31",
        }
    elif "KY" in short_name:
        calendar = {
            "old": {"1": "-05-15", "2": "-08-14", "3": "-11-14", "4": "-03-31",},
            "new": {"1": "-05-15", "2": "-08-31", "3": "-11-14", "4": "-03-31",},
        }
    else:
        calendar = {
            "1": "-05-15",
            "2": "-08-14",
            "3": "-11-14",
            "4": "-03-31",
        }
    get_year = (
        lambda year, season: str(year) if int(season) != 4 else str(int(year) + 1)
    )
    ky_policy_check = lambda year: "new" if year &gt;= "2021" else "old"
    return pd.to_datetime(
        s.index.map(
            lambda d: get_year(d[:4], d[-1])
            + calendar[ky_policy_check(d[:4])][d[-1]]
        )
        if "KY" in short_name
        else s.index.map(lambda d: get_year(d[:4], d[-1]) + calendar[d[-1]])
    )

def season_end(s):

    calendar = {
        "1": "-3-31",
        "2": "-6-30",
        "3": "-9-30",
        "4": "-12-31",
    }
    return pd.to_datetime(s.index.map(lambda d: d[:4] + calendar[d[-1]]))

disclosure_dates = data.get("financial_statements_upload_detail:upload_date")
disclosure_dates = disclosure_dates.apply(pd.to_datetime)

financial_season_end = disclosure_dates.apply(season_end)
default_disclosure_dates = disclosure_dates.apply(calc_default_disclosure_dates)

disclosure_dates[
    (disclosure_dates &gt; default_disclosure_dates)
    | (disclosure_dates &lt; financial_season_end)
] = pd.NaT
disclosure_dates[(disclosure_dates.diff() &lt;= datetime.timedelta(days=0))] = pd.NaT
disclosure_dates.loc["2019-Q1", "3167"] = pd.NaT
disclosure_dates.loc["2015-Q1", "5536"] = pd.NaT
disclosure_dates.loc["2018-Q1", "5876"] = pd.NaT

disclosure_dates = disclosure_dates.fillna(default_disclosure_dates)
disclosure_dates.columns.name = "stock_id"

if detail:
    return disclosure_dates
return default_disclosure_dates
</code></pre>
<p>if <strong>name</strong> == "<strong>main</strong>":
# finlab.login("")
# close = data.get("price:æ”¶ç›¤åƒ¹")
# close = MyFinlabDataFrame(close)
# rev = data.get("monthly_revenue:ç•¶æœˆç‡Ÿæ”¶")
# rev = MyFinlabDataFrame(rev)</p>
<pre><code>## è‚¡åƒ¹å‰µå¹´æ–°é«˜
# cond1 = close == close.rolling(250).max()

## ç¢ºèªç‡Ÿæ”¶åº•éƒ¨ï¼Œè¿‘æœˆç‡Ÿæ”¶è„«é›¢è¿‘å¹´ç©€åº•(é€£çºŒ3æœˆçš„"å–®æœˆç‡Ÿæ”¶è¿‘12æœˆæœ€å°å€¼/è¿‘æœˆç‡Ÿæ”¶" &lt; 0.8)
# cond4 = ((rev.rolling(12).min()) / (rev) &lt; 0.8).sustain(3)
# print(cond1)
# print(cond4)
# print(cond1 &amp; cond4)

df = MyFinlabDataFrame(
    np.random.randint(0, 100, size=(10, 5)), columns=list("BCDEH")
)
df1 = MyFinlabDataFrame(
    np.random.randint(0, 100, size=(5, 4)), columns=list("ABCD")
)
df = df &gt; 50
df1 = df1 &gt; 50
print(df)
print(df1)
print(df &amp; df1)
</code></pre>
<pre><code>

## pandas æ‰¾å‡ºé‡è¤‡çš„åˆ—
```python
import pandas as pd

# Example dataframes
df1 = pd.DataFrame({
    'date': ['2002-02-01', '2002-02-01', '2002-03-01', '2002-03-01', '2002-04-01'],
    'stock_id': [1101, 1101, 1101, 1101, 1101],
    'country': ['Taiwan', 'Taiwan', 'Taiwan', 'Taiwan', 'Taiwan'],
    'revenue': [2200067000, 2200067000, 1404336000, 1404336000, 2028782000],
    'revenue_month': [1, 1, 2, 2, 3],
    'revenue_year': [2002, 2002, 2002, 2002, 2002]
})

df2 = pd.DataFrame({
    'date': ['2023-02-01', '2023-03-01', '2023-03-01', '2023-04-01', '2023-04-01'],
    'stock_id': [1101, 1101, 1101, 1101, 1101],
    'country': ['Taiwan', 'Taiwan', 'Taiwan', 'Taiwan', 'Taiwan'],
    'revenue': [7325221000, 7306069000, 7306069000, 11730367000, 11730367000],
    'revenue_month': [1, 2, 2, 3, 3],
    'revenue_year': [2023, 2023, 2023, 2023, 2023]
})


print(df1, df2)
concatenated = pd.concat([df1, df2], ignore_index=True)
differences = concatenated.drop_duplicates(keep=False)
print(differences)
</code></pre>
<h2 id="å…©çµ„-dataframe-æ‰¾å‡ºå¤šé¤˜-row-çµ„æˆ-dataframe"><a class="header" href="#å…©çµ„-dataframe-æ‰¾å‡ºå¤šé¤˜-row-çµ„æˆ-dataframe">å…©çµ„ dataframe æ‰¾å‡ºå¤šé¤˜ row çµ„æˆ dataframe</a></h2>
<pre><code class="language-python">import pandas as pd

# create the DataFrame
import pandas as pd

df1 = pd.DataFrame({'A': [1, 2, 3], 'B': [1, 5, 6]})
df2 = pd.DataFrame({'A': [1, 2], 'B': [1, 5]})
df = df1 - df2
print(df1.to_markdown())
print("\n")
print(df2.to_markdown())


result = df1 - df2

indexs = []

for index, row in df.iterrows():
    if row.A != 0 or row.B != 0:
        indexs.append(index)
        

print("\n")
result_df = df1.loc[indexs]
print(result_df.to_markdown())
</code></pre>

                        <script src="https://utteranc.es/client.js"
                            repo="imxood/imxood.github.io"
                            issue-term="pathname"
                            theme="boxy-light"
                            crossorigin="anonymous"
                            async>
                        </script>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../python/Rust_bindings_for_Python.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../python/coroutine.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../python/Rust_bindings_for_Python.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../python/coroutine.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script type="text/javascript">
            window.playground_line_numbers = true;
        </script>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>

        <script src="../ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="../editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>

        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../theme/custom/mermaid.min.js"></script>
        <script type="text/javascript" src="../theme/custom/mermaid-init.js"></script>


    </body>
</html>
